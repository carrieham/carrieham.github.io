# ENVIRO

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#quanteda_options(tokens_block_size = 50000)

options(repos = list(CRAN="http://cran.rstudio.com/"))
install.packages("pacman")
library(pacman)

p_load(bookdown,
       data.table,
       # DataTables,
       dplyr, 
       DT,
       forcats,
       ggrepel,
       htmlwidgets,
       lubridate,
       plotly,
       quanteda,
       stopwords,
       tictoc,
       tidyverse, 
       tidytext,
       tokenizers,
       vroom,
       widyr,
       ggraph,
       igraph,
       stringi,
       topicmodels,
       reticulate)

```

### DATA
```{r input data, include=FALSE, cache=TRUE, cache.lazy=FALSE}

# #### DATA
load(verbose=TRUE,"data/enviroLaborSpeeches.Rda")
enviroSpeeches <- enviroLaborSpeeches %>%
  select(speech_id,
         chamber,
         speaker,
         congress,
         date,
         year,
         total_annual_speeches,
         environment,
         labor,
         word_count,
         speech) %>%
  filter(environment=="Yes") %>% 
  filter(year>=1905) %>%
  mutate(period20 = case_when(year >= 1905 & year < 1925 ~ 1905,
                              year >= 1925 & year < 1945 ~ 1925,
                              year >= 1945 & year < 1965 ~ 1945,
                              year >= 1965 & year < 1985 ~ 1965,
                              year >= 1985 & year < 2005 ~ 1985,
                              year >= 2005 & year < 2025 ~ 2005),
         period10 = case_when(year >= 1905 & year < 1915 ~ 1905,
                              year >= 1915 & year < 1925 ~ 1915,
                              year >= 1925 & year < 1935 ~ 1925,
                              year >= 1935 & year < 1945 ~ 1935,
                              year >= 1945 & year < 1955 ~ 1945,
                              year >= 1955 & year < 1965 ~ 1955,
                              year >= 1965 & year < 1975 ~ 1965,
                              year >= 1975 & year < 1985 ~ 1975,
                              year >= 1985 & year < 1995 ~ 1985,
                              year >= 1995 & year < 2005 ~ 1995,
                              year >= 2005 & year < 2015 ~ 2005,
                              year >= 2015 & year < 2025 ~ 2015),
         period5 = as.numeric(year) - as.numeric(year) %% 5,
         period2 = as.numeric(year) - 1 + as.numeric(year) %% 2) %>%
  select(speech_id:year,period20:period2,total_annual_speeches:last_col())

stopwords_iso <- stopwords("en", source = "stopwords-iso") 
stopwords_manual <- c("absent","adjourn", "ask", "can", "chairman",
                       "committee","con","democrat","etc","gentleladies",
                       "gentlelady", "gentleman", "gentlemen", "gentlewoman",
                       "gentlewomen","hereabout","hereafter","hereat", "hereby",
                       "herein", "hereinafter", "hereinbefore", "hereinto", "hereof",
                       "hereon", "hereto", "heretofore", "hereunder", "hereunto",
                       "hereupon", "herewith", "month", "mr", "mrs", "nai", "nay",
                       "none", "now", "part", "per", "pro", "republican",
                       "say", "senator", "shall", "sir", "speak", "speaker",
                       "tell", "thank", "thereabout", "thereafter", "thereagainst",
                       "thereat", "therebefore", "therebeforn", "thereby", "therefor",
                       "therefore", "therefrom", "therein", "thereinafter", "thereof",
                       "thereon", "thereto", "theretofore", "thereunder", "thereunto",
                       "thereupon", "therewith", "therewithal", "today", "whereabouts",
                       "whereafter", "whereas", "whereat", "whereby","wherefore",
                       "wherefrom", "wherein", "whereinto", "whereof", "whereon","whereto",
                       "whereunder", "whereupon", "wherever", "wherewith", 
                       "wherewithal", "will", "yea", "yes", "yield")

stopwords_manual2 <- c("white house","white houses",
                       "avenue","street","nw","northwest","suite",
                       "number","numeric","sequence","sequences",
                       "add","addition","additions","adding","added",
                       "amend","amended","amendment","amendments","amending","amends",
                       "america","american","americas",
                       "bill","bills",
                       "chapter","chapters",
                       "code","codes",
                       "country","countrys", 
                       "congress","congressional",
                       "district of columbia","district","districts",
                       "enact","enacted","enacting","enacts",
                       "federal", 
                       "senate","senates", 
                       "house of representatives","representative","representatives","the house",
                       "insert","inserting","inserted","inserts",
                       "law","laws",
                       "legislation","legislative","legislator",
                       "paragraph","paragraphs","sentence","sentences",
                       "percent","percentage","percentages",
                       "president","presidents","presidential", 
                       "print","printing","printed","prints",
                       "record","recording","recorded","records",
                       "section","sections",
                       "united states",
                       "state","states",
                       "subchapter","subchapters",
                       "subsection","subsections",
                       "supreme court","supreme courts","court","courts",
                       "title","titles",
                       "unanimous consent","consent","consenting",
                       "united","u.s.","us",
                       "urge","urging","urged","urges",
                       "colleague","colleagues",
                       "washington", "d.c.")

stopwords <- c(stopwords_manual2,stopwords_manual,stopwords_iso)


bad_syntax_hein <- vroom("data/vocabulary/master_list.txt",delim="|") %>%
  rename("classify" = "_classify") %>%
  filter(classify != "vocab") %>%
  mutate(phrase=str_replace_all(phrase," ","_"))

bad_syntax_manual <- c("llc_york",
                       "york_trump",
                       "remain_expend",
                       "corp_york",
                       "dt_mark",
                       "llc_trump",
                       "subparagraph_strike",
                       "unoblig_balanc",
                       "include_transfer",
                       "fiscal_fiscal",
                       "pre_submiss",
                       "preced_divis",
                       "preced_proviso",
                       "corp_trump",
                       "york_dt",
                       "dt_mark",
                       "manag_corp",
                       "hous_dc",
                       "dc_hon") %>%
  as_tibble()

bad_syntax <- c(bad_syntax_hein$phrase,
                bad_syntax_manual$value) %>%
  as_tibble()
colnames(bad_syntax) <- c("phrase")

```

```{r input tokens data, include=FALSE, cache=TRUE, cache.lazy=FALSE}
#### INPUT TOKENS

load(verbose=TRUE,"data/R/enviroTokens.Rda")

load(verbose=TRUE,"data/R/enviroBigrams.Rda")

```

```{r enviro bigrams, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

# ##### BIGRAMS #####
tic()
enviroBigrams <- enviroSpeeches %>%
  filter(environment=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  # tokens_remove(stopwords, #REMOVE STOP WORDS BEFORE TRIPLES CREATED
  #               padding=FALSE,
  #               verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  filter(!(term %in% bad_syntax_manual)) %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroSpeeches %>% select(year,date,speech_id,environment,labor,period20,period10,period5,period2,total_annual_speeches),by=join_by(speech_id==speech_id)) %>%
  as_tibble()

toc()
#
# ##### SAVE FILE
save(enviroBigrams,file="data/R/enviroBigrams.Rda")

```

```{r enviro tokens, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

##### TOKENS #####
tic()
enviroTokens <- enviroSpeeches %>%
  filter(environment=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=TRUE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroSpeeches %>% select(year,date,speech_id,environment,labor,period20,period10,period5,period2,total_annual_speeches),by=join_by(speech_id==speech_id)) %>%
  as_tibble()
toc()

##### SAVE FILE
save(enviroTokens,file="data/R/enviroTokens.Rda")

```



## BIGRAM COUNTS 

##### 20-yr period 
```{r top enviro bigrams by year 20-yr period20, message=FALSE, cache=TRUE}

enviroBigrams_by_year_20yr <- enviroBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  group_by(period20) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
# save(enviroBigrams_by_year_20yr,file="data/R/tables/enviroBigrams_by_20yrs.Rda")


#### 1905
top_enviroBigrams_20yr_1905 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_20yr,period20==1905),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1905, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_20yr_1905.html",selfcontained = F, libdir = "lib")


#### 1925
top_enviroBigrams_20yr_1925 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_20yr,period20==1925),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1925, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_20yr_1925.html",selfcontained = F, libdir = "lib")


#### 1945
top_enviroBigrams_20yr_1945 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_20yr,period20==1945),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1945, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_20yr_1945.html",selfcontained = F, libdir = "lib")


#### 1965
top_enviroBigrams_20yr_1965 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_20yr,period20==1965),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1965, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_20yr_1965.html",selfcontained = F, libdir = "lib")


#### 1985
top_enviroBigrams_20yr_1985 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_20yr,period20==1985),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1985, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_20yr_1985.html",selfcontained = F, libdir = "lib")


#### 2005
top_enviroBigrams_20yr_2005 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_20yr,period20==2005),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_2005, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_20yr_2005.html",selfcontained = F, libdir = "lib")


```

##### 10-yr period 
```{r top enviro bigrams by year 10-yr period, message=FALSE, cache=TRUE}

enviroBigrams_by_year_10yr <- enviroBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  group_by(period10) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviroBigrams_by_year_10yr,file="data/R/tables/enviroBigrams_by_10yrs.Rda")
  


#### 1905 & 1915
top_enviroBigrams_10yr_1905_1915 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_10yr,period10==1905 | period10==1915),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1905_1915, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_10yr_1905_1915.html",selfcontained = F, libdir = "lib")




#### 1925 & 1935
top_enviroBigrams_10yr_1925_1935 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_10yr,period10==1925 | period10==1935),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1925_1935, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_10yr_1925_1935.html",selfcontained = F, libdir = "lib")



#### 1945 & 1955
top_enviroBigrams_10yr_1945_1955 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_10yr,period10==1945 | period10==1955),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1945_1955, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_10yr_1945_1955.html",selfcontained = F, libdir = "lib")


#### 1965 & 1975
top_enviroBigrams_10yr_1965_1975 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_10yr,period10==1965 | period10==1975),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1965_1975, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_10yr_1965_1975.html",selfcontained = F, libdir = "lib")


#### 1985 & 1995
top_enviroBigrams_10yr_1985_1995 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_10yr,period10==1985 | period10==1995),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1985_1995, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_10yr_1985_1995.html",selfcontained = F, libdir = "lib")

#### 2005 & 2015
top_enviroBigrams_10yr_2005_2015 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_10yr,period10==2005 | period10==2015),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_2005_2015, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_10yr_2005_2015.html",selfcontained = F, libdir = "lib")

```

##### 5-yr period
```{r top enviro bigrams by year 5-yr period, message=FALSE, cache=TRUE}

##### ENVIRO #####
enviroBigrams_by_year_5yr <- enviroBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  group_by(period5) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviroBigrams_by_year_5yr,file="data/R/tables/enviroBigrams_by_5yrs.Rda")
  

#### 1905 & 1910 ####
top_enviroBigrams_5yr_1905_1910 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1905 | period5==1910),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1905_1910, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1905_1910.html",selfcontained = F, libdir = "lib")


#### 1915 & 1920 ####
top_enviroBigrams_5yr_1915_1920 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1915 | period5==1920),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1915_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1915_1920.html",selfcontained = F, libdir = "lib")



#### 1925 & 1930 ####
top_enviroBigrams_5yr_1925_1930 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1925 | period5==1930),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1925_1930, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1925_1930.html",selfcontained = F, libdir = "lib")


#### 1935 & 1940 ####
top_enviroBigrams_5yr_1935_1940 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1935 | period5==1940),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1935_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1935_1940.html",selfcontained = F, libdir = "lib")


#### 1945 & 1950 ####
top_enviroBigrams_5yr_1945_1950 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1945 | period5==1950),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1945_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1945_1950.html",selfcontained = F, libdir = "lib")


#### 1955 & 1960 ####
top_enviroBigrams_5yr_1955_1960 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1955 | period5==1960),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1955_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1955_1960.html",selfcontained = F, libdir = "lib")


#### 1965 & 1970 ####
top_enviroBigrams_5yr_1965_1970 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1965 | period5==1970),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1965_1970, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1965_1970.html",selfcontained = F, libdir = "lib")


#### 1975 & 1980 ####
top_enviroBigrams_5yr_1975_1980 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1975 | period5==1980),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1975_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1975_1980.html",selfcontained = F, libdir = "lib")


#### 1985 & 1990 ####
top_enviroBigrams_5yr_1985_1990 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1985 | period5==1990),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1985_1990, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1985_1990.html",selfcontained = F, libdir = "lib")


#### 1995 & 2000 ####
top_enviroBigrams_5yr_1995_2000 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==1995 | period5==2000),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_1995_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_1995_2000.html",selfcontained = F, libdir = "lib")




#### 2005 & 2010 ####
top_enviroBigrams_5yr_2005_2010 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==2005 | period5==2010),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_2005_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_2005_2010.html",selfcontained = F, libdir = "lib")


#### 2015 & 2020 ####
top_enviroBigrams_5yr_2015_2020 <- ggplot() +
  geom_col(data=filter(enviroBigrams_by_year_5yr,period5==2015 | period5==2020),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="seagreen2") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_5yr_2015_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/top_enviroBigrams_5yr_2015_2020.html",selfcontained = F, libdir = "lib")


```


## TF-IPF

```{r SETUP enviro tf-ipf}

enviroBigrams_count <- enviroBigrams %>%
  group_by(year,term) %>%
  count(term,wt=count) %>%
  filter(n>25) %>%
  mutate(period20 = case_when(year >= 1905 & year < 1925 ~ 1905,
                              year >= 1925 & year < 1945 ~ 1925,
                              year >= 1945 & year < 1965 ~ 1945,
                              year >= 1965 & year < 1985 ~ 1965,
                              year >= 1985 & year < 2005 ~ 1985,
                              year >= 2005 & year < 2025 ~ 2005),
         period10 = case_when(year >= 1905 & year < 1915 ~ 1905,
                              year >= 1915 & year < 1925 ~ 1915,
                              year >= 1925 & year < 1935 ~ 1925,
                              year >= 1935 & year < 1945 ~ 1935,
                              year >= 1945 & year < 1955 ~ 1945,
                              year >= 1955 & year < 1965 ~ 1955,
                              year >= 1965 & year < 1975 ~ 1965,
                              year >= 1975 & year < 1985 ~ 1975,
                              year >= 1985 & year < 1995 ~ 1985,
                              year >= 1995 & year < 2005 ~ 1995,
                              year >= 2005 & year < 2015 ~ 2005,
                              year >= 2015 & year < 2025 ~ 2015),
         period5 = as.numeric(year) - as.numeric(year) %% 5,
         period2 = as.numeric(year) - 1 + as.numeric(year) %% 2) 

```

##### 20-yr period
```{r enviro bigrams tf-ipf per 20-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_20yr <- enviroBigrams_count %>%
  group_by(period20, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period20) %>%
  filter(!is.na(period20)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_20yr <- enviro_oneRowPerDocument_20yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period20) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1905 ####
tfipf_enviroBigrams_20yr_1905 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1905),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_20yr_1905, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_20yr_1905.html",selfcontained = F, libdir = "lib")


#### 1925 ####
tfipf_enviroBigrams_20yr_1925 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1925),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_20yr_1925, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_20yr_1925.html",selfcontained = F, libdir = "lib")


#### 1945 ####
tfipf_enviroBigrams_20yr_1945 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1945),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_20yr_1945, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_20yr_1945.html",selfcontained = F, libdir = "lib")


#### 1965 ####
tfipf_enviroBigrams_20yr_1965 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1965),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_20yr_1965, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_20yr_1965.html",selfcontained = F, libdir = "lib")

#### 1985 ####
tfipf_enviroBigrams_20yr_1985 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1985),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_20yr_1985, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_20yr_1985.html",selfcontained = F, libdir = "lib")

#### 2005 ####
tfipf_enviroBigrams_20yr_2005 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==2005),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_20yr_2005, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_20yr_2005.html",selfcontained = F, libdir = "lib")

```

##### 10-yr period
```{r enviro bigrams tf-ipf per 10-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_10yr <- enviroBigrams_count %>%
  group_by(period10, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period10) %>%
  filter(!is.na(period10)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_10yr <- enviro_oneRowPerDocument_10yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period10) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1905 & 1915 ####
tfipf_enviroBigrams_10yr_1905_1915 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1905 | period10==1915),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_10yr_1905_1915, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_10yr_1905_1915.html",selfcontained = F, libdir = "lib")



#### 1925 & 1935 ####
tfipf_enviroBigrams_10yr_1925_1935 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1925 | period10==1935),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_10yr_1925_1935, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_10yr_1925_1935.html",selfcontained = F, libdir = "lib")



#### 1945 & 1955 ####
tfipf_enviroBigrams_10yr_1945_1955 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1945 | period10==1955),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_10yr_1945_1955, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_10yr_1945_1955.html",selfcontained = F, libdir = "lib")



#### 1965 & 1975 ####
tfipf_enviroBigrams_10yr_1965_1975 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1965 | period10==1975),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_10yr_1965_1975, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_10yr_1965_1975.html",selfcontained = F, libdir = "lib")



#### 1985 & 1995 ####
tfipf_enviroBigrams_10yr_1985_1995 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1985 | period10==1995),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_10yr_1985_1995, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_10yr_1985_1995.html",selfcontained = F, libdir = "lib")



#### 2005 & 2015 ####
tfipf_enviroBigrams_10yr_2005_2015 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==2005 | period10==2015),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_10yr_2005_2015, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_10yr_2005_2015.html",selfcontained = F, libdir = "lib")


```

##### 5-yr period
```{r enviro bigrams tf-ipf per 5-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_5yr <- enviroBigrams_count %>%
  group_by(period5, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period5) %>%
  filter(!is.na(period5)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_5yr <- enviro_oneRowPerDocument_5yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period5) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 

#### 1905 & 1910 ####
tfipf_enviroBigrams_5yr_1905_1910 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1905 | period5==1910),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1905_1910, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1905_1910.html",selfcontained = F, libdir = "lib")


#### 1915 & 1920 ####
tfipf_enviroBigrams_5yr_1915_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1915 | period5==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1915_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1915_1920.html",selfcontained = F, libdir = "lib")



#### 1925 & 1930 ####
tfipf_enviroBigrams_5yr_1925_1930 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1925 | period5==1930),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1925_1930, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1925_1930.html",selfcontained = F, libdir = "lib")


#### 1935 & 1940 ####
tfipf_enviroBigrams_5yr_1935_1940 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1935 | period5==1940),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1935_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1935_1940.html",selfcontained = F, libdir = "lib")


#### 1945 & 1950 ####
tfipf_enviroBigrams_5yr_1945_1950 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1945 | period5==1950),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1945_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1945_1950.html",selfcontained = F, libdir = "lib")


#### 1955 & 1960 ####
tfipf_enviroBigrams_5yr_1955_1960 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1955 | period5==1960),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1955_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1955_1960.html",selfcontained = F, libdir = "lib")


#### 1965 & 1970 ####
tfipf_enviroBigrams_5yr_1965_1970 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1965 | period5==1970),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1965_1970, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1965_1970.html",selfcontained = F, libdir = "lib")


#### 1975 & 1980 ####
tfipf_enviroBigrams_5yr_1975_1980 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1975 | period5==1980),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1975_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1975_1980.html",selfcontained = F, libdir = "lib")


#### 1985 & 1990 ####
tfipf_enviroBigrams_5yr_1985_1990 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1985 | period5==1990),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1985_1990, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1985_1990.html",selfcontained = F, libdir = "lib")


#### 1995 & 2000 ####
tfipf_enviroBigrams_5yr_1995_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1995 | period5==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_1995_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_1995_2000.html",selfcontained = F, libdir = "lib")


#### 2005 & 2010 ####
tfipf_enviroBigrams_5yr_2005_2010 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==2005 | period5==2010),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_2005_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_2005_2010.html",selfcontained = F, libdir = "lib")


#### 2015 & 2020 ####
tfipf_enviroBigrams_5yr_2015_2020 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==2015 | period5==2020),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="seagreen2") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroBigrams_5yr_2015_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/enviro/tfipf_enviroBigrams_5yr_2015_2020.html",selfcontained = F, libdir = "lib")


```



## CO-OCCURRENCE NETWORKS

#### keywords
```{r SET-UP enviro co-occurence}

#### ENVIRO ####
# enviroVocab_simple <- c("^environ",
#                         # "^natur",
#                         "^ecolog",
#                         "^ecosyst",
#                         "^outdoor",
#                         "^conserv",
#                         "forest$",
#                         "^reclam",
#                         "^pollut","^smog$",
#                         # "^land$",
#                         "^soil$",
#                         # "^air$ (forc|plane|navi|craft|defens|aviat|militari|defens|armi|aircraft|arm|airplan|war)",
#                         "^water$",
#                         # "^resourc",
#                         # "^fish$",
#                         "^wast$","^sewag",
#                         "^wildlif",
#                         "^wilder")

enviroVocab_simple <- c("^environ",
                        "^ecolog",
                        "^ecosyst",
                        "^outdoor",
                        # "^natur",
                        "^conserv",
                        "^reclam",
                        "^pollut",
                        "^wildlif",
                        "^wilder")

enviroVocabString_simple <- enviroVocab_simple %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")


#### LABOR ####
laborVocab_simple <- c("^labor$",
                       "^worker$",
                       "^job$",
                       "^wage$")
                       # "^class$")

laborVocabString_simple <- laborVocab_simple %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")


#### ENVIRO-LABOR ####
enviroLaborVocabString_simple <- c(enviroVocab_simple,laborVocab_simple) %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")


#### URBAN ####
# urbanVocab_simple <- c("urban$","^citi$","metropol",
#                        "rural","^town$","villag") #town, village, countryside, citi, metropolitan, 
# 
# urbanVocabString_simple <- urbanVocab_simple %>%
#   paste(collapse = "|") %>%
#   str_replace_all(" ","[:blank:]")


#### ECON ####
# econVocab_simple <- c("^capit$","^capital","^profit","worker","^job","^labor$","^consum",
#                       "material","^raw$","^mine$","^miner$","^mineral","^mining$",
#                       "factori", "^manufactur","^econom",
#                       "^rich$","^poor$","^wealth","^work","boss","elite","^class$","^wage$") 
# # "agricult",""extract","^shipp","^logist","^transport"
# # industri, exploit, infrastruct, produc
# # manager,employer,employee,
# 
# econVocabString_simple <- econVocab_simple %>%
#   paste(collapse = "|") %>%
#   str_replace_all(" ","[:blank:]")

```


#### 20-yr period:

##### 1905
```{r enviro token co-occurence per 20-yr period - 1905}

#### 1905
enviroTokens_wordPairs_corr_20yr_1905 <- enviroTokens %>%
  filter(period20==1905) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_20yr_1905_enviro_top <- enviroTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1905_enviro <- enviroTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1905_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1905_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1905_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1905_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1905_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)
  
set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1905_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1905_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1905_labor_top <- enviroTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1905_labor <- enviroTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1905_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1905_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1905_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1905_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1905_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)
  
set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1905_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1905_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1905_enviroLabor_top <- enviroTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1905_enviroLabor <- enviroTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1905_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)
  

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1905_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1905_enviroLabor.jpg") #h=11,


```

##### 1925
```{r enviro token co-occurence per 20-yr period - 1925}

#### 1925
enviroTokens_wordPairs_corr_20yr_1925 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1925) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_20yr_1925_enviro_top <- enviroTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1925_enviro <- enviroTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1925_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1925_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1925_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1925_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1925_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1925_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1925_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1925_labor_top <- enviroTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1925_labor <- enviroTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1925_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1925_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1925_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1925_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1925_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1925_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1925_enviroLabor_top <- enviroTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1925_enviroLabor <- enviroTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1925_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1925_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1925_enviroLabor.jpg") #h=11,

```

##### 1945
```{r enviro token co-occurence per 20-yr period - 1945}

#### 1945
enviroTokens_wordPairs_corr_20yr_1945 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1945) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_20yr_1945_enviro_top <- enviroTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1945_enviro <- enviroTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1945_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1945_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1945_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1945_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1945_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1945_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1945_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1945_labor_top <- enviroTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1945_labor <- enviroTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1945_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1945_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1945_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1945_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1945_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1945_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1945_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1945_enviroLabor_top <- enviroTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1945_enviroLabor <- enviroTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1945_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1945_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) + 
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1945_enviroLabor.jpg") #h=11,


```

##### 1965
```{r enviro token co-occurence per 20-yr period - 1965}

#### 1965
enviroTokens_wordPairs_corr_20yr_1965 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1965) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_20yr_1965_enviro_top <- enviroTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1965_enviro <- enviroTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1965_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1965_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1965_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1965_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1965_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1965_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1965_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1965_labor_top <- enviroTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1965_labor <- enviroTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1965_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1965_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1965_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1965_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1965_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1965_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1965_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1965_enviroLabor_top <- enviroTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1965_enviroLabor <- enviroTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1965_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1965_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1965_enviroLabor.jpg") #h=11,



```

##### 1985
```{r enviro token co-occurence per 20-yr period - 1985}

#### 1985
enviroTokens_wordPairs_corr_20yr_1985 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1985) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_20yr_1985_enviro_top <- enviroTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1985_enviro <- enviroTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1985_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1985_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1985_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_1985_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1985_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1985_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1985_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1985_labor_top <- enviroTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1985_labor <- enviroTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1985_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1985_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1985_labor_top$item1,enviroTokens_wordPairs_corr_20yr_1985_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1985_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1985_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1985_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_1985_enviroLabor_top <- enviroTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_1985_enviroLabor <- enviroTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_1985_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_1985_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_1985_enviroLabor.jpg") #h=11,


```

##### 2005
```{r enviro token co-occurence per 20-yr period - 2005}

#### 2005
enviroTokens_wordPairs_corr_20yr_2005 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==2005) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_20yr_2005_enviro_top <- enviroTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_2005_enviro <- enviroTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_2005_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_2005_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_2005_enviro_top$item1,enviroTokens_wordPairs_corr_20yr_2005_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_2005_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_2005_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_2005_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_2005_labor_top <- enviroTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_2005_labor <- enviroTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_2005_labor_top$item1,enviroTokens_wordPairs_corr_20yr_2005_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_2005_labor_top$item1,enviroTokens_wordPairs_corr_20yr_2005_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_2005_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_2005_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_2005_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_20yr_2005_enviroLabor_top <- enviroTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_20yr_2005_enviroLabor <- enviroTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item1,enviroTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_20yr_2005_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_20yr_2005_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_20yr_2005_enviroLabor.jpg") #h=11,

```


#### 10-yr period:

##### 1905
```{r enviro token co-occurence per 10-yr period - 1905}

#### 1905
enviroTokens_wordPairs_corr_10yr_1905 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1905) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1905_enviro_top <- enviroTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1905_enviro <- enviroTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1905_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1905_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1905_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1905_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1905_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1905_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1905_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1905_labor_top <- enviroTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1905_labor <- enviroTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1905_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1905_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1905_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1905_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1905_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1905_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1905_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1905_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1905_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1905_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1905_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1905_enviroLabor.jpg") #h=11,



```

##### 1915
```{r enviro token co-occurence per 10-yr period - 1915}

#### 1915
enviroTokens_wordPairs_corr_10yr_1915 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1915) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1915_enviro_top <- enviroTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1915_enviro <- enviroTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1915_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1915_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1915_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1915_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1915_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1915_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1915_enviro.jpg") #h=11,




#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1915_labor_top <- enviroTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1915_labor <- enviroTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1915_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1915_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1915_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1915_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1915_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1915_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1915_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1915_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1915_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1915_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1915_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1915_enviroLabor.jpg") #h=11,



```

##### 1925
```{r enviro token co-occurence per 10-yr period - 1925}

#### 1925
enviroTokens_wordPairs_corr_10yr_1925 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1925) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1925_enviro_top <- enviroTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1925_enviro <- enviroTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1925_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1925_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1925_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1925_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1925_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1925_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1925_enviro.jpg") #h=11,


#### LABOR KEYWORDS
#### 1925
# enviroTokens_wordPairs_corr_10yr_1925 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1925) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1925_labor_top <- enviroTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1925_labor <- enviroTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1925_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1925_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1925_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1925_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1925_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1925_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1925_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1925_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1925_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1925_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1925_enviroLabor.jpg") #h=11,



```

##### 1935
```{r enviro token co-occurence per 10-yr period - 1935}

#### 1935
enviroTokens_wordPairs_corr_10yr_1935 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1935) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1935_enviro_top <- enviroTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1935_enviro <- enviroTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1935_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1935_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1935_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1935_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1935_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1935_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1935_enviro.jpg") #h=11,





#### LABOR KEYWORDS

#### 1935
# enviroTokens_wordPairs_corr_10yr_1935 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1935) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1935_labor_top <- enviroTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1935_labor <- enviroTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1935_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1935_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1935_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1935_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1935_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1935_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1935_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1935_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1935_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1935_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1935_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1935_enviroLabor.jpg") #h=11,




```

##### 1945
```{r enviro token co-occurence per 10-yr period - 1945}

#### 1945
enviroTokens_wordPairs_corr_10yr_1945 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1945) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1945_enviro_top <- enviroTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1945_enviro <- enviroTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1945_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1945_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1945_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1945_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1945_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1945_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1945_enviro.jpg") #h=11,




#### LABOR KEYWORDS
#### 1945
# enviroTokens_wordPairs_corr_10yr_1945 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1945) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1945_labor_top <- enviroTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1945_labor <- enviroTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1945_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1945_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1945_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1945_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1945_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1945_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1945_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1945_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1945_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1945_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1945_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1945_enviroLabor.jpg") #h=11,



```

##### 1955
```{r enviro token co-occurence per 10-yr period - 1955}

#### 1955
enviroTokens_wordPairs_corr_10yr_1955 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1955) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1955_enviro_top <- enviroTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1955_enviro <- enviroTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1955_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1955_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1955_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1955_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1955_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1955_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1955_enviro.jpg") #h=11,



#### LABOR KEYWORDS

#### 1955
# enviroTokens_wordPairs_corr_10yr_1955 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1955) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1955_labor_top <- enviroTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1955_labor <- enviroTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1955_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1955_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1955_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1955_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1955_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1955_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1955_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1955_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1955_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1955_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1955_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1955_enviroLabor.jpg") #h=11,




```

##### 1965
```{r enviro token co-occurence per 10-yr period - 1965}

#### 1965
enviroTokens_wordPairs_corr_10yr_1965 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1965_enviro_top <- enviroTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1965_enviro <- enviroTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1965_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1965_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1965_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1965_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1965_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1965_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1965_enviro.jpg") #h=11,



#### LABOR KEYWORDS
#### 1965
# enviroTokens_wordPairs_corr_10yr_1965 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1965) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1965_labor_top <- enviroTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1965_labor <- enviroTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1965_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1965_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1965_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1965_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1965_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1965_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1965_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1965_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1965_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1965_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1965_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1965_enviroLabor.jpg") #h=11,




```

##### 1975
```{r enviro token co-occurence per 10-yr period - 1975}

#### 1975
enviroTokens_wordPairs_corr_10yr_1975 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1975) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1975_enviro_top <- enviroTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1975_enviro <- enviroTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1975_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1975_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1975_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1975_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1975_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1975_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1975_enviro.jpg") #h=11,



#### LABOR KEYWORDS

#### 1975
# enviroTokens_wordPairs_corr_10yr_1975 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period==1975) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1975_labor_top <- enviroTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1975_labor <- enviroTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1975_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1975_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1975_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1975_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1975_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1975_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1975_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1975_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1975_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1975_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1975_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1975_enviroLabor.jpg") #h=11,



```

##### 1985
```{r enviro token co-occurence per 10-yr period - 1985}

#### 1985
enviroTokens_wordPairs_corr_10yr_1985 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1985) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1985_enviro_top <- enviroTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1985_enviro <- enviroTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1985_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1985_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1985_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1985_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1985_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1985_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1985_enviro.jpg") #h=11,




#### LABOR KEYWORDS
#### 1985
# enviroTokens_wordPairs_corr_10yr_1985 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period==1985) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1985_labor_top <- enviroTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1985_labor <- enviroTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1985_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1985_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1985_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1985_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1985_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1985_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1985_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1985_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1985_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1985_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1985_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1985_enviroLabor.jpg") #h=11,



```

##### 1995
```{r enviro token co-occurence per 10-yr period - 1995}

#### 1995
enviroTokens_wordPairs_corr_10yr_1995 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1995) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_1995_enviro_top <- enviroTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_1995_enviro <- enviroTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1995_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1995_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1995_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_1995_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1995_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1995_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1995_enviro.jpg") #h=11,




#### LABOR KEYWORDS
#### 1995
# enviroTokens_wordPairs_corr_10yr_1995 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period==1995) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1995_labor_top <- enviroTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1995_labor <- enviroTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1995_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1995_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1995_labor_top$item1,enviroTokens_wordPairs_corr_10yr_1995_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1995_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1995_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1995_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_1995_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_1995_enviroLabor <- enviroTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_1995_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1995_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_1995_enviroLabor.jpg") #h=11,


```

##### 2005
```{r enviro token co-occurence per 10-yr period - 2005}

#### 2005
enviroTokens_wordPairs_corr_10yr_2005 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==2005) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_2005_enviro_top <- enviroTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_2005_enviro <- enviroTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_2005_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_2005_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_2005_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_2005_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_2005_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2005_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_2005_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_2005_labor_top <- enviroTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_2005_labor <- enviroTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_2005_labor_top$item1,enviroTokens_wordPairs_corr_10yr_2005_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_2005_labor_top$item1,enviroTokens_wordPairs_corr_10yr_2005_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_2005_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2005_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_2005_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_2005_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_2005_enviroLabor <- enviroTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_2005_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2005_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_2005_enviroLabor.jpg") #h=11,


```

##### 2015
```{r enviro token co-occurence per 10-yr period - 2015}

#### 2015
enviroTokens_wordPairs_corr_10yr_2015 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==2015) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_10yr_2015_enviro_top <- enviroTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_10yr_2015_enviro <- enviroTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_2015_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_2015_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_2015_enviro_top$item1,enviroTokens_wordPairs_corr_10yr_2015_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_2015_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2015_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_2015_enviro.jpg") #h=11,





#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_2015_labor_top <- enviroTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_2015_labor <- enviroTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_2015_labor_top$item1,enviroTokens_wordPairs_corr_10yr_2015_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_2015_labor_top$item1,enviroTokens_wordPairs_corr_10yr_2015_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_2015_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2015_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_2015_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_10yr_2015_enviroLabor_top <- enviroTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_10yr_2015_enviroLabor <- enviroTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item1,enviroTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_10yr_2015_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2015_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_10yr_2015_enviroLabor.jpg") #h=11,


```


#### 5-yr period:

##### 1905
```{r enviro token co-occurence per 5-yr period - 1905}

#### 1905
enviroTokens_wordPairs_corr_5yr_1905 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1905) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1905_enviro_top <- enviroTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1905_enviro <- enviroTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1905_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1905_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1905_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1905_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1905_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1905_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1905_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1905_labor_top <- enviroTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1905_labor <- enviroTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1905_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1905_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1905_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1905_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1905_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1905_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1905_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1905_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1905_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1905_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1905_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1905_enviroLabor.jpg") #h=11,



```

##### 1910
```{r enviro token co-occurence per 5-yr period - 1910}

#### 1910
enviroTokens_wordPairs_corr_5yr_1910 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1910) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1910_enviro_top <- enviroTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1910_enviro <- enviroTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1910_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1910_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1910_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1910_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1910_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1910_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1910_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1910_labor_top <- enviroTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1910_labor <- enviroTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1910_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1910_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1910_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1910_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1910_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1910_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1910_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1910_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1910_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1910_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1910_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1910_enviroLabor.jpg") #h=11,



```

##### 1915
```{r enviro token co-occurence per 5-yr period - 1915}

#### 1915
enviroTokens_wordPairs_corr_5yr_1915 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1915) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1915_enviro_top <- enviroTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1915_enviro <- enviroTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1915_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1915_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1915_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1915_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1915_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1915_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1915_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1915_labor_top <- enviroTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1915_labor <- enviroTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1915_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1915_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1915_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1915_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1915_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1915_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1915_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1915_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1915_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1915_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1915_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1915_enviroLabor.jpg") #h=11,



```

##### 1920
```{r enviro token co-occurence per 5-yr period - 1920}

#### 1920
enviroTokens_wordPairs_corr_5yr_1920 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1920) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1920_enviro_top <- enviroTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1920_enviro <- enviroTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1920_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1920_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1920_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1920_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1920_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1920_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1920_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1920_labor_top <- enviroTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1920_labor <- enviroTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1920_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1920_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1920_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1920_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1920_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1920_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1920_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1920_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1920_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1920_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1920_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1920_enviroLabor.jpg") #h=11,



```

##### 1925
```{r enviro token co-occurence per 5-yr period - 1925}

#### 1925
enviroTokens_wordPairs_corr_5yr_1925 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1925) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1925_enviro_top <- enviroTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1925_enviro <- enviroTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1925_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1925_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1925_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1925_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1925_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1925_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1925_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1925_labor_top <- enviroTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1925_labor <- enviroTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1925_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1925_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1925_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1925_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1925_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1925_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1925_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1925_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1925_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1925_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1925_enviroLabor.jpg") #h=11,



```

##### 1930
```{r enviro token co-occurence per 5-yr period - 1930}

#### 1930
enviroTokens_wordPairs_corr_5yr_1930 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1930) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1930_enviro_top <- enviroTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1930_enviro <- enviroTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1930_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1930_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1930_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1930_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1930_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1930_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1930_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1930_labor_top <- enviroTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1930_labor <- enviroTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1930_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1930_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1930_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1930_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1930_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1930_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1930_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1930_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1930_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1930_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1930_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1930_enviroLabor.jpg") #h=11,



```

##### 1935
```{r enviro token co-occurence per 5-yr period - 1935}

#### 1935
enviroTokens_wordPairs_corr_5yr_1935 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1935) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1935_enviro_top <- enviroTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1935_enviro <- enviroTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1935_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1935_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1935_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1935_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1935_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1935_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1935_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1935_labor_top <- enviroTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1935_labor <- enviroTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1935_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1935_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1935_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1935_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1935_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1935_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1935_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1935_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1935_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1935_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1935_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1935_enviroLabor.jpg") #h=11,



```

##### 1940
```{r enviro token co-occurence per 5-yr period - 1940}

#### 1940
enviroTokens_wordPairs_corr_5yr_1940 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1940) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1940_enviro_top <- enviroTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1940_enviro <- enviroTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1940_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1940_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1940_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1940_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1940_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1940_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1940_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1940_labor_top <- enviroTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1940_labor <- enviroTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1940_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1940_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1940_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1940_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1940_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1940_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1940_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1940_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1940_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1940_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1940_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1940_enviroLabor.jpg") #h=11,



```

##### 1945
```{r enviro token co-occurence per 5-yr period - 1945}

#### 1945
enviroTokens_wordPairs_corr_5yr_1945 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1945) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1945_enviro_top <- enviroTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1945_enviro <- enviroTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1945_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1945_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1945_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1945_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1945_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1945_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1945_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1945_labor_top <- enviroTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1945_labor <- enviroTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1945_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1945_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1945_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1945_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1945_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1945_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1945_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1945_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1945_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1945_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1945_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1945_enviroLabor.jpg") #h=11,



```

##### 1950
```{r enviro token co-occurence per 5-yr period - 1950}

#### 1950
enviroTokens_wordPairs_corr_5yr_1950 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1950) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1950_enviro_top <- enviroTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1950_enviro <- enviroTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1950_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1950_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1950_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1950_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1950_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1950_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1950_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1950_labor_top <- enviroTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1950_labor <- enviroTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1950_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1950_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1950_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1950_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1950_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1950_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1950_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1950_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1950_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1950_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1950_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1950_enviroLabor.jpg") #h=11,



```

##### 1955
```{r enviro token co-occurence per 5-yr period - 1955}

#### 1955
enviroTokens_wordPairs_corr_5yr_1955 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1955) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1955_enviro_top <- enviroTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1955_enviro <- enviroTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1955_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1955_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1955_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1955_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1955_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1955_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1955_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1955_labor_top <- enviroTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1955_labor <- enviroTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1955_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1955_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1955_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1955_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1955_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1955_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1955_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1955_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1955_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1955_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1955_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1955_enviroLabor.jpg") #h=11,



```

##### 1960
```{r enviro token co-occurence per 5-yr period - 1960}

#### 1960
enviroTokens_wordPairs_corr_5yr_1960 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1960) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1960_enviro_top <- enviroTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1960_enviro <- enviroTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1960_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1960_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1960_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1960_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1960_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1960_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1960_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1960_labor_top <- enviroTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1960_labor <- enviroTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1960_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1960_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1960_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1960_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1960_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1960_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1960_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1960_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1960_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1960_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1960_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1960_enviroLabor.jpg") #h=11,



```

##### 1965
```{r enviro token co-occurence per 5-yr period - 1965}

#### 1965
enviroTokens_wordPairs_corr_5yr_1965 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1965_enviro_top <- enviroTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1965_enviro <- enviroTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1965_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1965_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1965_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1965_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1965_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1965_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1965_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1965_labor_top <- enviroTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1965_labor <- enviroTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1965_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1965_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1965_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1965_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1965_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1965_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1965_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1965_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1965_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1965_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1965_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1965_enviroLabor.jpg") #h=11,



```

##### 1970
```{r enviro token co-occurence per 5-yr period - 1970}

#### 1970
enviroTokens_wordPairs_corr_5yr_1970 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1970) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1970_enviro_top <- enviroTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1970_enviro <- enviroTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1970_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1970_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1970_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1970_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1970_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1970_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1970_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1970_labor_top <- enviroTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1970_labor <- enviroTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1970_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1970_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1970_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1970_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1970_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1970_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1970_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1970_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1970_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1970_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1970_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1970_enviroLabor.jpg") #h=11,



```

##### 1975
```{r enviro token co-occurence per 5-yr period - 1975}

#### 1975
enviroTokens_wordPairs_corr_5yr_1975 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1975) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1975_enviro_top <- enviroTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1975_enviro <- enviroTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1975_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1975_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1975_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1975_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1975_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1975_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1975_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1975_labor_top <- enviroTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1975_labor <- enviroTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1975_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1975_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1975_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1975_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1975_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1975_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1975_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1975_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1975_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1975_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1975_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1975_enviroLabor.jpg") #h=11,



```

##### 1980
```{r enviro token co-occurence per 5-yr period - 1980}

#### 1980
enviroTokens_wordPairs_corr_5yr_1980 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1980) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1980_enviro_top <- enviroTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1980_enviro <- enviroTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1980_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1980_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1980_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1980_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1980_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1980_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1980_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1980_labor_top <- enviroTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1980_labor <- enviroTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1980_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1980_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1980_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1980_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1980_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1980_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1980_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1980_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1980_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1980_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1980_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1980_enviroLabor.jpg") #h=11,



```

##### 1985
```{r enviro token co-occurence per 5-yr period - 1985}

#### 1985
enviroTokens_wordPairs_corr_5yr_1985 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1985) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1985_enviro_top <- enviroTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1985_enviro <- enviroTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1985_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1985_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1985_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1985_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1985_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1985_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1985_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1985_labor_top <- enviroTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1985_labor <- enviroTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1985_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1985_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1985_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1985_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1985_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1985_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1985_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1985_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1985_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1985_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1985_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1985_enviroLabor.jpg") #h=11,



```

##### 1990
```{r enviro token co-occurence per 5-yr period - 1990}

#### 1990
enviroTokens_wordPairs_corr_5yr_1990 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1990) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1990_enviro_top <- enviroTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1990_enviro <- enviroTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1990_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1990_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1990_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1990_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1990_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1990_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1990_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1990_labor_top <- enviroTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1990_labor <- enviroTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1990_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1990_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1990_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1990_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1990_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1990_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1990_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1990_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1990_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1990_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1990_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1990_enviroLabor.jpg") #h=11,



```

##### 1995
```{r enviro token co-occurence per 5-yr period - 1995}

#### 1995
enviroTokens_wordPairs_corr_5yr_1995 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1995) %>%
  group_by(term) %>%
  filter(n() >= 40) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_1995_enviro_top <- enviroTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_1995_enviro <- enviroTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1995_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1995_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1995_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_1995_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1995_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1995_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1995_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1995_labor_top <- enviroTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1995_labor <- enviroTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1995_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1995_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1995_labor_top$item1,enviroTokens_wordPairs_corr_5yr_1995_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1995_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1995_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1995_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_1995_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_1995_enviroLabor <- enviroTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_1995_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1995_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_1995_enviroLabor.jpg") #h=11,



```

##### 2000
```{r enviro token co-occurence per 5-yr period - 2000}

#### 2000
enviroTokens_wordPairs_corr_5yr_2000 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2000) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_2000_enviro_top <- enviroTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_2000_enviro <- enviroTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2000_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2000_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2000_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2000_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2000_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2000_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2000_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2000_labor_top <- enviroTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2000_labor <- enviroTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2000_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2000_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2000_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2000_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2000_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2000_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2000_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2000_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2000_enviroLabor <- enviroTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2000_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2000_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2000_enviroLabor.jpg") #h=11,



```

##### 2005
```{r enviro token co-occurence per 5-yr period - 2005}

#### 2005
enviroTokens_wordPairs_corr_5yr_2005 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2005) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_2005_enviro_top <- enviroTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_2005_enviro <- enviroTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2005_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2005_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2005_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2005_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2005_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2005_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2005_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2005_labor_top <- enviroTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2005_labor <- enviroTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2005_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2005_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2005_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2005_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2005_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2005_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2005_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2005_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2005_enviroLabor <- enviroTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2005_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2005_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2005_enviroLabor.jpg") #h=11,



```

##### 2010
```{r enviro token co-occurence per 5-yr period - 2010}

#### 2010
enviroTokens_wordPairs_corr_5yr_2010 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2010) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_2010_enviro_top <- enviroTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_2010_enviro <- enviroTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2010_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2010_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2010_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2010_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2010_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2010_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2010_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2010_labor_top <- enviroTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2010_labor <- enviroTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2010_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2010_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2010_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2010_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2010_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2010_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2010_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2010_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2010_enviroLabor <- enviroTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2010_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2010_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2010_enviroLabor.jpg") #h=11,



```

##### 2015
```{r enviro token co-occurence per 5-yr period - 2015}

#### 2015
enviroTokens_wordPairs_corr_5yr_2015 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2015) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_2015_enviro_top <- enviroTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_2015_enviro <- enviroTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2015_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2015_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2015_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2015_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2015_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2015_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2015_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2015_labor_top <- enviroTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2015_labor <- enviroTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2015_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2015_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2015_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2015_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2015_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2015_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2015_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2015_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2015_enviroLabor <- enviroTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2015_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2015_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2015_enviroLabor.jpg") #h=11,



```

##### 2020
```{r enviro token co-occurence per 5-yr period - 2020}

#### 2020
enviroTokens_wordPairs_corr_5yr_2020 <- enviroTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2020) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroTokens_wordPairs_corr_5yr_2020_enviro_top <- enviroTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroTokens_wordPairs_corr_5yr_2020_enviro <- enviroTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2020_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2020_enviro_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2020_enviro_top$item1,enviroTokens_wordPairs_corr_5yr_2020_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2020_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2020_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2020_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2020_labor_top <- enviroTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2020_labor <- enviroTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2020_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2020_labor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2020_labor_top$item1,enviroTokens_wordPairs_corr_5yr_2020_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2020_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2020_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2020_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroTokens_wordPairs_corr_5yr_2020_enviroLabor_top <- enviroTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroTokens_wordPairs_corr_5yr_2020_enviroLabor <- enviroTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %in% c(enviroTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item2) &
           item2 %in% c(enviroTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item1,enviroTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroTokens_wordPairs_corr_5yr_2020_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2020_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviro/enviroTokens_wordPairs_corr_5yr_2020_enviroLabor.jpg") #h=11,



```



## TOPIC MODELING

```{r}

# virtualenv_create("r-reticulate", python="3.12")
use_virtualenv("r-reticulate")

# py_install(c("openai","bertopic"), #"sentence_transformers"), #"spacy", "posextract","lark", "pyreadr", "nltk" "pandas",
#            envname="r-reticulate",
#            method="virtualenv",
#            pip_ignore_installed = TRUE,
#            # pip_ignore_installed = FALSE,
#            pip = TRUE)

enviroSpeeches_dtm <- enviroSpeeches %>%
  mutate(period2 = as.numeric(year) - as.numeric(year) %% 2)
  # filter(environment=="Yes" & labor=="Yes") %>%
  # filter(year==2024)

# enviroSpeeches_dtm <- enviroSpeeches %>%
#   unnest_sentences(output=sentence,
#                    input=speech,
#                    strip_punct=TRUE,
#                    format="text",
#                    to_lower=TRUE,
#                    drop=TRUE) %>%
#   mutate(word_count = map(sentence, \(sentence) stri_stats_latex(sentence)[4]),
#          word_count = as.numeric(str_extract(word_count,"[:digit:]+"))) %>%
#   filter(word_count>6)

# enviroSpeeches_dtm <- chunk_text(enviroSpeeches_dtm$speech, doc_id = enviroSpeeches_dtm$speech_id, chunk_size = 50) %>%
#   enframe(name = "group", value = "text") %>%
#   mutate(speech_id=as.numeric(str_remove(group,"-.*"))) %>%
#   left_join(enviroSpeeches) %>%
#     select(-group,speech) %>%
#   as_tibble()
  
# pip install --force-reinstall bertopic
# pip install --force-reinstall -v "numpy==1.26.0"

```

```{python set-up, include=FALSE}
# brew reinstall --build-from-source python@3.12
# brew link --overwrite python@3.12 --dry-run
# brew link --overwrite python@3.12

import re
import pandas as pd
# import numpy as np
# import pyreadr

from sentence_transformers import SentenceTransformer
from umap import UMAP
from hdbscan import HDBSCAN
from sklearn.feature_extraction.text import CountVectorizer
import openai

from bertopic import BERTopic
from bertopic.representation import KeyBERTInspired, MaximalMarginalRelevance, OpenAI, PartOfSpeech
from bertopic.vectorizers import ClassTfidfTransformer

```

```{python prepare data}

#### prepare data

## documents
speeches = r.enviroSpeeches_dtm.speech.to_list()

## timestamps
timestamps20 = r.enviroSpeeches_dtm.period20.to_list()
timestamps10 = r.enviroSpeeches_dtm.period10.to_list()
timestamps5 = r.enviroSpeeches_dtm.period5.to_list()
timestamps2 = r.enviroSpeeches_dtm.period2.to_list()

```

```{python full model steps}

###### sent tokenizer (BEST PRACTICE) ###### 
# from nltk.tokenize import sent_tokenize, word_tokenize
# sentences = [sent_tokenize(speech) for speech in speeches]
# sentences = [sentence for doc in sentences for sentence in doc]


###### STEP 1 - Extract embeddings ###### 
# embedding_model = SentenceTransformer("all-MiniLM-L6-v2")
### pre-calculate embeddings (BEST PRACTICE)
embedding_model = SentenceTransformer("all-MiniLM-L6-v2")
embeddings = embedding_model.encode(speeches, show_progress_bar=True)
# We reduce our embeddings to 2D as it will allows us to quickly iterate later on
reduced_embeddings = UMAP(n_neighbors=10, n_components=2, min_dist=0.0, metric='cosine').fit_transform(embeddings)


###### STEP 2 - Reduce dimensionality ###### 
# umap_model = UMAP(n_neighbors=15, n_components=5, min_dist=0.0, metric='cosine')
### preventing stochastic behavior (BEST PRACTICE)
umap_model = UMAP(n_neighbors=15, n_components=5, min_dist=0.0, metric='cosine', random_state=42)


###### STEP 3 - Cluster reduced embeddings ###### 
# hdbscan_model = HDBSCAN(min_cluster_size=15, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
### controlling number of topics (BEST PRACTICE)
# hdbscan_model = HDBSCAN(min_cluster_size=300, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
hdbscan_model = HDBSCAN(min_cluster_size=150, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
# hdbscan_model = HDBSCAN(min_cluster_size=150, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
# hdbscan_model = HDBSCAN(min_cluster_size=100, metric='euclidean', cluster_selection_method='eom', prediction_data=True)

###### STEP 4 - Tokenize topics ###### 
# vectorizer_model = CountVectorizer(stop_words="english")
### improving default representation
# vectorizer_model = CountVectorizer(stop_words="english", min_df=2, ngram_range=(1, 2))
vectorizer_model = CountVectorizer(min_df=10)

###### STEP 5 - Create topic representation ###### 
ctfidf_model = ClassTfidfTransformer()


###### STEP 6 - (Optional) Fine-tune topic representations with ###### 
# representation_model = KeyBERTInspired()
### Fine-tune topic representations with GPT

## KeyBERT
keybert_model = KeyBERTInspired()

## Part-of-Speech
# pos_model = PartOfSpeech("en_core_web_sm")

## MMR
mmr_model = MaximalMarginalRelevance(diversity=0.3)

# ## GPT-3.5
# client = openai.OpenAI(api_key="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")
# prompt = """
# I have a topic that contains the following documents:
# [DOCUMENTS]
# The topic is described by the following keywords: [KEYWORDS]
# 
# Based on the information above, extract a short but highly descriptive topic label of at most 5 words. Make sure it is in the following format:
# topic: <topic label>
# """
# openai_model = OpenAI(client, model="gpt-3.5-turbo", chat=True, prompt=prompt)

### All representation models
representation_model = {
    "KeyBERT": keybert_model,
    # "OpenAI": openai_model,  # Uncomment if you will use OpenAI
    "MMR": mmr_model
    # "POS": pos_model
}


```

```{python global model}

# global model (all best practice steps together)
# topic_model = BERTopic(min_topic_size=100,verbose=True)
topic_model = BERTopic(
  top_n_words=10,
  min_topic_size=150, #if it nears a million documents, then it is advised to set it much higher than the default of 10, for example, 100 or even 500.
  verbose=True,
  # calculate_probabilities = False,
  embedding_model=embedding_model,          # Step 1 - Extract embeddings
  umap_model=umap_model,                    # Step 2 - Reduce dimensionality
  hdbscan_model=hdbscan_model,              # Step 3 - Cluster reduced embeddings
  vectorizer_model=vectorizer_model,        # Step 4 - Tokenize topics
  ctfidf_model=ctfidf_model,                # Step 5 - Extract topic words
  representation_model=representation_model # Step 6 - (Optional) Fine-tune topic representations
)

# Train model
# topics, probs = topic_model.fit_transform(speeches)
topics, probs = topic_model.fit_transform(speeches, embeddings)

# frequent topics
topic_info = topic_model.get_topic_info() #includes outliers (-1)
# topics0 = topic_model.get_topic(0) 
# topic_model.get_topic_info()[1:]

# doc-level info
topic_docs = topic_model.get_document_info(speeches)

# hierarchical topics
hierarchical_topics = topic_model.hierarchical_topics(speeches)

```

```{python reduce outliers}

#Visualize
plot_topics_original = topic_model.visualize_documents(speeches, reduced_embeddings=reduced_embeddings, hide_annotations=True, hide_document_hover=True) 
plot_topics_original.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_150_original.html")  
                                
# Reduce outliers
# new_topics = topic_model.reduce_outliers(speeches, topics)
new_topics = topic_model.reduce_outliers(speeches, topics, strategy="c-tf-idf")
# new_topics = topic_model.reduce_outliers(speeches, new_topics, strategy="distributions")
new_topics = topic_model.reduce_outliers(speeches, new_topics, strategy="embeddings")

#Update topics
# topic_model.update_topics(docs, topics=new_topics)
documents = pd.DataFrame({"Document": speeches, "Topic": new_topics})
topic_model._update_topic_size(documents)

#Visualize
plot_topics_outlierReduction = topic_model.visualize_documents(speeches, reduced_embeddings=reduced_embeddings, hide_document_hover=True, hide_annotations=True)
plot_topics_outlierReduction.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_150_outlierReduction.html") 
```


```{python update topic model}

### Fine-tune topic representations after training BERTopic
vectorizer_model = CountVectorizer(stop_words="english", ngram_range=(1, 3), min_df=10)

###### RE-RUN
# topic_model.update_topics(speeches, vectorizer_model=vectorizer_model, representation_model=representation_model)
topic_model.update_topics(speeches, vectorizer_model=vectorizer_model) #representation_model=representation_model)

```

```{python update}
# frequent topics
topic_info = topic_model.get_topic_info() #includes outliers (-1)
topic_docs = topic_model.get_document_info(speeches)

# hierarchical topics
hierarchical_topics = topic_model.hierarchical_topics(speeches)

```


```{r save files}

topic_info_r <- py_to_r(py$topic_info)

write_csv(py$topic_info,file="congress_bookdown/data/topic_info_150.csv")
# save(py$topic_docs,file="congress_bookdown/data/topic_docs_150_reduceOutliers.Rda")

```

```{python visualize topics}

##### visualize global model
plot_topics = topic_model.visualize_topics()
plot_topics.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_150.html")

##### visualize global model hierarchy
# plot_topics_hierarchy = topic_model.visualize_hierarchy()
plot_topics_hierarchy = topic_model.visualize_hierarchy(hierarchical_topics=hierarchical_topics)
plot_topics_hierarchy.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_hierarchy_150.html")


##### KeyBERTInspired labels
keybert_topic_labels = {topic: " | ".join(list(zip(*values))[0][:3]) for topic, values in topic_model.topic_aspects_["KeyBERT"].items()}
keybert_topic_labels[-1] = "Outlier Topic"
topic_model.set_topic_labels(keybert_topic_labels)

plot_topics_key = topic_model.visualize_topics(custom_labels=True)
plot_topics_key.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_150_key.html")

plot_topics_hierarchy_key = topic_model.visualize_hierarchy(hierarchical_topics=hierarchical_topics,custom_labels=True)
plot_topics_hierarchy_key.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_hierarchy_150_key.html")


##### MMR labels
mmr_topic_labels = {topic: " | ".join(list(zip(*values))[0][:3]) for topic, values in topic_model.topic_aspects_["MMR"].items()}
topic_model.set_topic_labels(mmr_topic_labels)

plot_topics_mmr = topic_model.visualize_topics(custom_labels=True)
plot_topics_mmr.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_150_mmr.html")

plot_topics_hierarchy_mmr = topic_model.visualize_hierarchy(hierarchical_topics=hierarchical_topics,custom_labels=True)
plot_topics_hierarchy_mmr.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_hierarchy_150_mmr.html")


##### ChatGBT labels
# chatgpt_topic_labels = {topic: " | ".join(list(zip(*values))[0]) for topic, values in topic_model.topic_aspects_["OpenAI"].items()}
# chatgpt_topic_labels[-1] = "Outlier Topic"
# topic_model.set_topic_labels(chatgpt_topic_labels)

# # visualize keywords per topic
# topic_model.visualize_barchart()
# 
# # term score decline
# topic_model.visualize_term_rank()
# topic_model.visualize_term_rank(log_scale=True)

```

```{python visualize topics over time}

# topic representations at each time stamp
topics_over_time_10 = topic_model.topics_over_time(speeches, timestamps10, global_tuning=False, evolution_tuning=True)  #nr_bins=20
topics_over_time_5 = topic_model.topics_over_time(speeches, timestamps5, global_tuning=False, evolution_tuning=True)  #nr_bins=20
topics_over_time_2 = topic_model.topics_over_time(speeches, timestamps2, global_tuning=False, evolution_tuning=True)  #nr_bins=20

# plotly topics over time
topic_model.set_topic_labels(keybert_topic_labels)
plot_topics_over_time_key = topic_model.visualize_topics_over_time(topics_over_time10, top_n_topics=25, custom_labels=True)
plot_topics_over_time_key.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_over_time_150_10_key.html")
plot_topics_over_time_key = topic_model.visualize_topics_over_time(topics_over_time5, top_n_topics=25, custom_labels=True)
plot_topics_over_time_key.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_over_time_150_5_key.html")
plot_topics_over_time_key = topic_model.visualize_topics_over_time(topics_over_time2, top_n_topics=25, custom_labels=True)
plot_topics_over_time_key.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_over_time_150_2_key.html")

topic_model.set_topic_labels(mmr_topic_labels)
plot_topics_over_time_mmr = topic_model.visualize_topics_over_time(topics_over_time10, top_n_topics=25, custom_labels=True)
plot_topics_over_time_mmr.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_over_time_150_10_mmr.html")
plot_topics_over_time_mmr = topic_model.visualize_topics_over_time(topics_over_time5, top_n_topics=25, custom_labels=True)
plot_topics_over_time_mmr.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_over_time_150_5_mmr.html")
plot_topics_over_time_mmr = topic_model.visualize_topics_over_time(topics_over_time2, top_n_topics=25, custom_labels=True)
plot_topics_over_time_mmr.write_html("congress_bookdown/figures/enviro/plot_enviro_topics_over_time_150_2_mmr.html")

# # plotly specific topics over time
# topic_model.visualize_topics_over_time(topics_over_time, topics=[9, 10, 72, 83, 87, 91])

```


