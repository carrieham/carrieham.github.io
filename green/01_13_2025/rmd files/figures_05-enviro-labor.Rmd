# ENVIRO-LABOR

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

options(repos = list(CRAN="http://cran.rstudio.com/"))
install.packages("pacman")
library(pacman)

install.packages("reticulate",force=TRUE)
library(reticulate)

p_load(bookdown,
       data.table,
       # DataTables,
       dplyr, 
       DT,
       forcats,
       ggrepel,
       htmlwidgets,
       lubridate,
       plotly,
       quanteda,
       stopwords,
       tictoc,
       tidyverse, 
       tidytext,
       tokenizers,
       vroom,
       widyr,
       ggraph,
       igraph,
       stringi,
       topicmodels)
       # reticulate)

```

### DATA
```{r input data, include=FALSE, cache=TRUE, cache.lazy=FALSE}

# #### DATA
load(verbose=TRUE,"data/enviroLaborSpeeches.Rda")
enviroLaborSpeeches <- enviroLaborSpeeches %>%
  select(speech_id,
         chamber,
         speaker,
         congress,
         date,
         year,
         total_annual_speeches,
         environment,
         labor,
         word_count,
         speech) %>%
  filter(environment=="Yes" & labor=="Yes") %>% 
  filter(year>=1905) %>%
  mutate(period20 = case_when(year >= 1905 & year < 1925 ~ 1905,
                              year >= 1925 & year < 1945 ~ 1925,
                              year >= 1945 & year < 1965 ~ 1945,
                              year >= 1965 & year < 1985 ~ 1965,
                              year >= 1985 & year < 2005 ~ 1985,
                              year >= 2005 & year < 2025 ~ 2005),
         period10 = case_when(year >= 1905 & year < 1915 ~ 1905,
                              year >= 1915 & year < 1925 ~ 1915,
                              year >= 1925 & year < 1935 ~ 1925,
                              year >= 1935 & year < 1945 ~ 1935,
                              year >= 1945 & year < 1955 ~ 1945,
                              year >= 1955 & year < 1965 ~ 1955,
                              year >= 1965 & year < 1975 ~ 1965,
                              year >= 1975 & year < 1985 ~ 1975,
                              year >= 1985 & year < 1995 ~ 1985,
                              year >= 1995 & year < 2005 ~ 1995,
                              year >= 2005 & year < 2015 ~ 2005,
                              year >= 2015 & year < 2025 ~ 2015),
         period5 = as.numeric(year) - as.numeric(year) %% 5,
         period2 = as.numeric(year) - 1 + as.numeric(year) %% 2) %>%
  select(speech_id:year,period20:period2,total_annual_speeches:last_col())

stopwords_iso <- stopwords("en", source = "stopwords-iso") 
stopwords_manual <- c("absent","adjourn", "ask", "can", "chairman",
                       "committee","con","democrat","etc","gentleladies",
                       "gentlelady", "gentleman", "gentlemen", "gentlewoman",
                       "gentlewomen","hereabout","hereafter","hereat", "hereby",
                       "herein", "hereinafter", "hereinbefore", "hereinto", "hereof",
                       "hereon", "hereto", "heretofore", "hereunder", "hereunto",
                       "hereupon", "herewith", "month", "mr", "mrs", "nai", "nay",
                       "none", "now", "part", "per", "pro", "republican",
                       "say", "senator", "shall", "sir", "speak", "speaker",
                       "tell", "thank", "thereabout", "thereafter", "thereagainst",
                       "thereat", "therebefore", "therebeforn", "thereby", "therefor",
                       "therefore", "therefrom", "therein", "thereinafter", "thereof",
                       "thereon", "thereto", "theretofore", "thereunder", "thereunto",
                       "thereupon", "therewith", "therewithal", "today", "whereabouts",
                       "whereafter", "whereas", "whereat", "whereby","wherefore",
                       "wherefrom", "wherein", "whereinto", "whereof", "whereon","whereto",
                       "whereunder", "whereupon", "wherever", "wherewith", 
                       "wherewithal", "will", "yea", "yes", "yield")

stopwords_manual2 <- c("white house","white houses",
                       "avenue","street","nw","northwest","suite",
                       "number","numeric","sequence","sequences",
                       "add","addition","additions","adding","added",
                       "amend","amended","amendment","amendments","amending","amends",
                       "america","american","americas",
                       "bill","bills",
                       "chapter","chapters",
                       "code","codes",
                       "country","countrys", 
                       "congress","congressional",
                       "district of columbia","district","districts",
                       "enact","enacted","enacting","enacts",
                       "federal", 
                       "senate","senates", 
                       "house of representatives","representative","representatives","the house",
                       "insert","inserting","inserted","inserts",
                       "law","laws",
                       "legislation","legislative","legislator",
                       "paragraph","paragraphs","sentence","sentences",
                       "percent","percentage","percentages",
                       "president","presidents","presidential", 
                       "print","printing","printed","prints",
                       "record","recording","recorded","records",
                       "section","sections",
                       "united states",
                       "state","states",
                       "subchapter","subchapters",
                       "subsection","subsections",
                       "supreme court","supreme courts","court","courts",
                       "title","titles",
                       "unanimous consent","consent","consenting",
                       "united","u.s.","us",
                       "urge","urging","urged","urges",
                       "colleague","colleagues",
                       "washington", "d.c.")

stopwords <- c(stopwords_manual2,stopwords_manual,stopwords_iso)


bad_syntax_hein <- vroom("data/vocabulary/master_list.txt",delim="|") %>%
  rename("classify" = "_classify") %>%
  filter(classify != "vocab") %>%
  mutate(phrase=str_replace_all(phrase," ","_"))

bad_syntax_manual <- c("llc_york",
                       "york_trump",
                       "remain_expend",
                       "corp_york",
                       "dt_mark",
                       "llc_trump",
                       "subparagraph_strike",
                       "unoblig_balanc",
                       "include_transfer",
                       "fiscal_fiscal",
                       "pre_submiss",
                       "preced_divis",
                       "preced_proviso",
                       "corp_trump",
                       "york_dt",
                       "dt_mark",
                       "manag_corp",
                       "hous_dc",
                       "dc_hon") %>%
  as_tibble()

bad_syntax <- c(bad_syntax_hein$phrase,
                bad_syntax_manual$value) %>%
  as_tibble()
colnames(bad_syntax) <- c("phrase")

```

```{r input tokens data, include=FALSE, cache=TRUE, cache.lazy=FALSE}
#### INPUT TOKENS

load(verbose=TRUE,"data/R/enviroLaborTokens.Rda")

load(verbose=TRUE,"data/R/enviroLaborBigrams.Rda")

```

```{r enviroLabor bigrams, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

# ##### BIGRAMS #####
tic()
enviroLaborBigrams <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  # tokens_remove(stopwords, #REMOVE STOP WORDS BEFORE TRIPLES CREATED
  #               padding=FALSE,
  #               verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  filter(!(term %in% bad_syntax_manual)) %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor,period20,period10,period5,period2,total_annual_speeches),by=join_by(speech_id==speech_id)) %>%
  as_tibble()

toc()
#
# ##### SAVE FILE
save(enviroLaborBigrams,file="data/R/enviroLaborBigrams.Rda")

```

```{r enviroLabor tokens, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

##### TOKENS #####
tic()
enviroLaborTokens <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=TRUE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor,period20,period10,period5,period2,total_annual_speeches),by=join_by(speech_id==speech_id)) %>%
  as_tibble()
toc()

##### SAVE FILE
save(enviroLaborTokens,file="data/R/enviroLaborTokens.Rda")

```



## BIGRAM COUNTS 

##### 20-yr period 
```{r top enviroLabor bigrams by year 20-yr period20, message=FALSE, cache=TRUE}

enviroLaborBigrams_by_year_20yr <- enviroLaborBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  group_by(period20) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
# save(enviroLaborBigrams_by_year_20yr,file="data/R/tables/enviroLaborBigrams_by_20yrs.Rda")


#### 1905
top_enviroLaborBigrams_20yr_1905 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_20yr,period20==1905),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1905, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_20yr_1905.html",selfcontained = F, libdir = "lib")


#### 1925
top_enviroLaborBigrams_20yr_1925 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_20yr,period20==1925),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1925, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_20yr_1925.html",selfcontained = F, libdir = "lib")


#### 1945
top_enviroLaborBigrams_20yr_1945 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_20yr,period20==1945),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1945, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_20yr_1945.html",selfcontained = F, libdir = "lib")


#### 1965
top_enviroLaborBigrams_20yr_1965 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_20yr,period20==1965),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1965, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_20yr_1965.html",selfcontained = F, libdir = "lib")


#### 1985
top_enviroLaborBigrams_20yr_1985 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_20yr,period20==1985),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1985, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_20yr_1985.html",selfcontained = F, libdir = "lib")


#### 2005
top_enviroLaborBigrams_20yr_2005 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_20yr,period20==2005),
           aes(x=reorder_within(term,n,period20),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  # facet_wrap(~period20, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_2005, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_20yr_2005.html",selfcontained = F, libdir = "lib")


```

##### 10-yr period 
```{r top enviroLabor bigrams by year 10-yr period, message=FALSE, cache=TRUE}

enviroLaborBigrams_by_year_10yr <- enviroLaborBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  group_by(period10) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
# save(enviroLaborBigrams_by_year_10yr,file="data/R/tables/enviroLaborBigrams_by_10yrs.Rda")
  


#### 1905 & 1915
top_enviroLaborBigrams_10yr_1905_1915 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_10yr,period10==1905 | period10==1915),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1905_1915, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_10yr_1905_1915.html",selfcontained = F, libdir = "lib")




#### 1925 & 1935
top_enviroLaborBigrams_10yr_1925_1935 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_10yr,period10==1925 | period10==1935),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1925_1935, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_10yr_1925_1935.html",selfcontained = F, libdir = "lib")



#### 1945 & 1955
top_enviroLaborBigrams_10yr_1945_1955 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_10yr,period10==1945 | period10==1955),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1945_1955, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_10yr_1945_1955.html",selfcontained = F, libdir = "lib")


#### 1965 & 1975
top_enviroLaborBigrams_10yr_1965_1975 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_10yr,period10==1965 | period10==1975),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1965_1975, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_10yr_1965_1975.html",selfcontained = F, libdir = "lib")


#### 1985 & 1995
top_enviroLaborBigrams_10yr_1985_1995 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_10yr,period10==1985 | period10==1995),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1985_1995, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_10yr_1985_1995.html",selfcontained = F, libdir = "lib")

#### 2005 & 2015
top_enviroLaborBigrams_10yr_2005_2015 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_10yr,period10==2005 | period10==2015),
           aes(x=reorder_within(term,n,period10),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period10, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_2005_2015, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_10yr_2005_2015.html",selfcontained = F, libdir = "lib")

```

##### 5-yr period
```{r top enviroLabor bigrams by year 5-yr period, message=FALSE, cache=TRUE}

##### ENVIRO #####
enviroLaborBigrams_by_year_5yr <- enviroLaborBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  group_by(period5) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
# save(enviroLaborBigrams_by_year_5yr,file="data/R/tables/enviroLaborBigrams_by_5yrs.Rda")
  

#### 1905 & 1910 ####
top_enviroLaborBigrams_5yr_1905_1910 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1905 | period5==1910),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1905_1910, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1905_1910.html",selfcontained = F, libdir = "lib")


#### 1915 & 1920 ####
top_enviroLaborBigrams_5yr_1915_1920 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1915 | period5==1920),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1915_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1915_1920.html",selfcontained = F, libdir = "lib")



#### 1925 & 1930 ####
top_enviroLaborBigrams_5yr_1925_1930 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1925 | period5==1930),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1925_1930, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1925_1930.html",selfcontained = F, libdir = "lib")


#### 1935 & 1940 ####
top_enviroLaborBigrams_5yr_1935_1940 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1935 | period5==1940),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1935_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1935_1940.html",selfcontained = F, libdir = "lib")


#### 1945 & 1950 ####
top_enviroLaborBigrams_5yr_1945_1950 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1945 | period5==1950),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1945_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1945_1950.html",selfcontained = F, libdir = "lib")


#### 1955 & 1960 ####
top_enviroLaborBigrams_5yr_1955_1960 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1955 | period5==1960),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1955_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1955_1960.html",selfcontained = F, libdir = "lib")


#### 1965 & 1970 ####
top_enviroLaborBigrams_5yr_1965_1970 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1965 | period5==1970),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1965_1970, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1965_1970.html",selfcontained = F, libdir = "lib")


#### 1975 & 1980 ####
top_enviroLaborBigrams_5yr_1975_1980 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1975 | period5==1980),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1975_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1975_1980.html",selfcontained = F, libdir = "lib")


#### 1985 & 1990 ####
top_enviroLaborBigrams_5yr_1985_1990 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1985 | period5==1990),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1985_1990, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1985_1990.html",selfcontained = F, libdir = "lib")


#### 1995 & 2000 ####
top_enviroLaborBigrams_5yr_1995_2000 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==1995 | period5==2000),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_1995_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_1995_2000.html",selfcontained = F, libdir = "lib")




#### 2005 & 2010 ####
top_enviroLaborBigrams_5yr_2005_2010 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==2005 | period5==2010),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_2005_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_2005_2010.html",selfcontained = F, libdir = "lib")


#### 2015 & 2020 ####
top_enviroLaborBigrams_5yr_2015_2020 <- ggplot() +
  geom_col(data=filter(enviroLaborBigrams_by_year_5yr,period5==2015 | period5==2020),
           aes(x=reorder_within(term,n,period5),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period5, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_5yr_2015_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/top_enviroLaborBigrams_5yr_2015_2020.html",selfcontained = F, libdir = "lib")


```


## TF-IPF

```{r SETUP enviro tf-ipf}

enviroLaborBigrams_count <- enviroLaborBigrams %>%
  group_by(year,term) %>%
  count(term,wt=count) %>%
  filter(n>25) %>%
  mutate(period20 = case_when(year >= 1905 & year < 1925 ~ 1905,
                              year >= 1925 & year < 1945 ~ 1925,
                              year >= 1945 & year < 1965 ~ 1945,
                              year >= 1965 & year < 1985 ~ 1965,
                              year >= 1985 & year < 2005 ~ 1985,
                              year >= 2005 & year < 2025 ~ 2005),
         period10 = case_when(year >= 1905 & year < 1915 ~ 1905,
                              year >= 1915 & year < 1925 ~ 1915,
                              year >= 1925 & year < 1935 ~ 1925,
                              year >= 1935 & year < 1945 ~ 1935,
                              year >= 1945 & year < 1955 ~ 1945,
                              year >= 1955 & year < 1965 ~ 1955,
                              year >= 1965 & year < 1975 ~ 1965,
                              year >= 1975 & year < 1985 ~ 1975,
                              year >= 1985 & year < 1995 ~ 1985,
                              year >= 1995 & year < 2005 ~ 1995,
                              year >= 2005 & year < 2015 ~ 2005,
                              year >= 2015 & year < 2025 ~ 2015),
         period5 = as.numeric(year) - as.numeric(year) %% 5,
         period2 = as.numeric(year) - 1 + as.numeric(year) %% 2) 


```

##### 20-yr period
```{r enviroLabor bigrams tf-ipf per 20-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_20yr <- enviroLaborBigrams_count %>%
  group_by(period20, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period20) %>%
  filter(!is.na(period20)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_20yr <- enviro_oneRowPerDocument_20yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period20) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1905 ####
tfipf_enviroLaborBigrams_20yr_1905 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1905),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_20yr_1905, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_20yr_1905.html",selfcontained = F, libdir = "lib")


#### 1925 ####
tfipf_enviroLaborBigrams_20yr_1925 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1925),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_20yr_1925, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_20yr_1925.html",selfcontained = F, libdir = "lib")

#### 1945 ####
tfipf_enviroLaborBigrams_20yr_1945 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1945),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_20yr_1945, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_20yr_1945.html",selfcontained = F, libdir = "lib")


#### 1965 ####
tfipf_enviroLaborBigrams_20yr_1965 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1965),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_20yr_1965, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_20yr_1965.html",selfcontained = F, libdir = "lib")


#### 1985 ####
tfipf_enviroLaborBigrams_20yr_1985 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==1985),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_20yr_1985, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_20yr_1985.html",selfcontained = F, libdir = "lib")

#### 2005 ####
tfipf_enviroLaborBigrams_20yr_2005 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period20==2005),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period20, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  # facet_wrap(~period20, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_20yr_2005, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_20yr_2005.html",selfcontained = F, libdir = "lib")


```

##### 10-yr period
```{r enviroLabor bigrams tf-ipf per 10-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_10yr <- enviroLaborBigrams_count %>%
  group_by(period10, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period10) %>%
  filter(!is.na(period10)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_10yr <- enviro_oneRowPerDocument_10yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period10) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1905 & 1915 ####
tfipf_enviroLaborBigrams_10yr_1905_1915 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1905 | period10==1915),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_10yr_1905_1915, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_10yr_1905_1915.html",selfcontained = F, libdir = "lib")



#### 1925 & 1935 ####
tfipf_enviroLaborBigrams_10yr_1925_1935 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1925 | period10==1935),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_10yr_1925_1935, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_10yr_1925_1935.html",selfcontained = F, libdir = "lib")



#### 1945 & 1955 ####
tfipf_enviroLaborBigrams_10yr_1945_1955 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1945 | period10==1955),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_10yr_1945_1955, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_10yr_1945_1955.html",selfcontained = F, libdir = "lib")



#### 1965 & 1975 ####
tfipf_enviroLaborBigrams_10yr_1965_1975 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1965 | period10==1975),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_10yr_1965_1975, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_10yr_1965_1975.html",selfcontained = F, libdir = "lib")



#### 1985 & 1995 ####
tfipf_enviroLaborBigrams_10yr_1985_1995 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==1985 | period10==1995),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_10yr_1985_1995, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_10yr_1985_1995.html",selfcontained = F, libdir = "lib")



#### 2005 & 2015 ####
tfipf_enviroLaborBigrams_10yr_2005_2015 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period10==2005 | period10==2015),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period10, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period10, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_10yr_2005_2015, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_10yr_2005_2015.html",selfcontained = F, libdir = "lib")

```

##### 5-yr period
```{r enviroLabor bigrams tf-ipf per 5-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_5yr <- enviroLaborBigrams_count %>%
  group_by(period5, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period5) %>%
  filter(!is.na(period5)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_5yr <- enviro_oneRowPerDocument_5yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period5) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 

#### 1905 & 1910 ####
tfipf_enviroLaborBigrams_5yr_1905_1910 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1905 | period5==1910),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1905_1910, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1905_1910.html",selfcontained = F, libdir = "lib")


#### 1915 & 1920 ####
tfipf_enviroLaborBigrams_5yr_1915_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1915 | period5==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1915_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1915_1920.html",selfcontained = F, libdir = "lib")



#### 1925 & 1930 ####
tfipf_enviroLaborBigrams_5yr_1925_1930 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1925 | period5==1930),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1925_1930, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1925_1930.html",selfcontained = F, libdir = "lib")


#### 1935 & 1940 ####
tfipf_enviroLaborBigrams_5yr_1935_1940 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1935 | period5==1940),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1935_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1935_1940.html",selfcontained = F, libdir = "lib")


#### 1945 & 1950 ####
tfipf_enviroLaborBigrams_5yr_1945_1950 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1945 | period5==1950),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1945_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1945_1950.html",selfcontained = F, libdir = "lib")


#### 1955 & 1960 ####
tfipf_enviroLaborBigrams_5yr_1955_1960 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1955 | period5==1960),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1955_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1955_1960.html",selfcontained = F, libdir = "lib")


#### 1965 & 1970 ####
tfipf_enviroLaborBigrams_5yr_1965_1970 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1965 | period5==1970),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1965_1970, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1965_1970.html",selfcontained = F, libdir = "lib")


#### 1975 & 1980 ####
tfipf_enviroLaborBigrams_5yr_1975_1980 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1975 | period5==1980),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1975_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1975_1980.html",selfcontained = F, libdir = "lib")


#### 1985 & 1990 ####
tfipf_enviroLaborBigrams_5yr_1985_1990 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1985 | period5==1990),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1985_1990, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1985_1990.html",selfcontained = F, libdir = "lib")


#### 1995 & 2000 ####
tfipf_enviroLaborBigrams_5yr_1995_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==1995 | period5==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_1995_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_1995_2000.html",selfcontained = F, libdir = "lib")


#### 2005 & 2010 ####
tfipf_enviroLaborBigrams_5yr_2005_2010 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==2005 | period5==2010),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_2005_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_2005_2010.html",selfcontained = F, libdir = "lib")


#### 2015 & 2020 ####
tfipf_enviroLaborBigrams_5yr_2015_2020 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_5yr,period5==2015 | period5==2020),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period5, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="blueviolet") +
  facet_wrap(~period5, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(tfipf_enviroLaborBigrams_5yr_2015_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("congress_bookdown/figures/tfipf_enviroLaborBigrams_5yr_2015_2020.html",selfcontained = F, libdir = "lib")


```



## CO-OCCURRENCE NETWORKS

#### keywords
```{r SET-UP enviroLabor co-occurrence}

#### ENVIRO ####
# enviroVocab_simple <- c("^environ",
#                         # "^natur",
#                         "^ecolog",
#                         "^ecosyst",
#                         "^outdoor",
#                         "^conserv",
#                         "forest$",
#                         "^reclam",
#                         "^pollut","^smog$",
#                         # "^land$",
#                         "^soil$",
#                         # "^air$ (forc|plane|navi|craft|defens|aviat|militari|defens|armi|aircraft|arm|airplan|war)",
#                         "^water$",
#                         # "^resourc",
#                         # "^fish$",
#                         "^wast$","^sewag",
#                         "^wildlif",
#                         "^wilder")

enviroVocab_simple <- c("^environ",
                        "^ecolog",
                        "^ecosyst",
                        "^outdoor",
                        # "^natur",
                        "^conserv",
                        "^reclam",
                        "^pollut",
                        "^wildlif",
                        "^wilder")

enviroVocabString_simple <- enviroVocab_simple %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")


#### LABOR ####
laborVocab_simple <- c("^labor$",
                       "^worker$",
                       "^job$",
                       "^wage$")
                       # "^class$")

laborVocabString_simple <- laborVocab_simple %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")


#### ENVIRO-LABOR ####
enviroLaborVocabString_simple <- c(enviroVocab_simple,laborVocab_simple) %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")


#### URBAN ####
# urbanVocab_simple <- c("urban$","^citi$","metropol",
#                        "rural","^town$","villag") #town, village, countryside, citi, metropolitan, 
# 
# urbanVocabString_simple <- urbanVocab_simple %>%
#   paste(collapse = "|") %>%
#   str_replace_all(" ","[:blank:]")


#### ECON ####
# econVocab_simple <- c("^capit$","^capital","^profit","worker","^job","^labor$","^consum",
#                       "material","^raw$","^mine$","^miner$","^mineral","^mining$",
#                       "factori", "^manufactur","^econom",
#                       "^rich$","^poor$","^wealth","^work","boss","elite","^class$","^wage$") 
# # "agricult",""extract","^shipp","^logist","^transport"
# # industri, exploit, infrastruct, produc
# # manager,employer,employee,
# 
# econVocabString_simple <- econVocab_simple %>%
#   paste(collapse = "|") %>%
#   str_replace_all(" ","[:blank:]")

```


#### 20-yr period:

##### 1905
```{r enviroLabor token co-occurrence per 20-yr period - 1905}

#### 1905
enviroLaborTokens_wordPairs_corr_20yr_1905 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1905) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1905_enviro_top <- enviroLaborTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1905_enviro <- enviroLaborTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1905_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1905_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1905_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1905_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1905_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)
  
set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1905_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1905_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1905_labor_top <- enviroLaborTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1905_labor <- enviroLaborTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1905_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1905_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1905_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1905_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1905_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)
  
set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1905_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1905_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor <- enviroLaborTokens_wordPairs_corr_20yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)
  

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1905_enviroLabor.jpg") #h=11,


```

##### 1925
```{r enviroLabor token co-occurrence per 20-yr period - 1925}

#### 1925
enviroLaborTokens_wordPairs_corr_20yr_1925 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1925) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1925_enviro_top <- enviroLaborTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1925_enviro <- enviroLaborTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1925_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1925_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1925_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1925_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1925_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1925_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1925_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1925_labor_top <- enviroLaborTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1925_labor <- enviroLaborTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1925_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1925_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1925_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1925_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1925_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1925_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor <- enviroLaborTokens_wordPairs_corr_20yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1925_enviroLabor.jpg") #h=11,

```

##### 1945
```{r enviroLabor token co-occurrence per 20-yr period - 1945}

#### 1945
enviroLaborTokens_wordPairs_corr_20yr_1945 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1945) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1945_enviro_top <- enviroLaborTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1945_enviro <- enviroLaborTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1945_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1945_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1945_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1945_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1945_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1945_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1945_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1945_labor_top <- enviroLaborTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1945_labor <- enviroLaborTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1945_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1945_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1945_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1945_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1945_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1945_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1945_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor <- enviroLaborTokens_wordPairs_corr_20yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) + 
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1945_enviroLabor.jpg") #h=11,


```

##### 1965
```{r enviroLabor token co-occurrence per 20-yr period - 1965}

#### 1965
enviroLaborTokens_wordPairs_corr_20yr_1965 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1965) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1965_enviro_top <- enviroLaborTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1965_enviro <- enviroLaborTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1965_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1965_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1965_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1965_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1965_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1965_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1965_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1965_labor_top <- enviroLaborTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1965_labor <- enviroLaborTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1965_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1965_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1965_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1965_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1965_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1965_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1965_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor <- enviroLaborTokens_wordPairs_corr_20yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1965_enviroLabor.jpg") #h=11,



```

##### 1985
```{r enviroLabor token co-occurrence per 20-yr period - 1985}

#### 1985
enviroLaborTokens_wordPairs_corr_20yr_1985 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==1985) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1985_enviro_top <- enviroLaborTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1985_enviro <- enviroLaborTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1985_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1985_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1985_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1985_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1985_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1985_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1985_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1985_labor_top <- enviroLaborTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1985_labor <- enviroLaborTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1985_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1985_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1985_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1985_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1985_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1985_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1985_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor <- enviroLaborTokens_wordPairs_corr_20yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_1985_enviroLabor.jpg") #h=11,


```

##### 2005
```{r enviroLabor token co-occurrence per 20-yr period - 2005}

#### 2005
enviroLaborTokens_wordPairs_corr_20yr_2005 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period20==2005) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_2005_enviro_top <- enviroLaborTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_2005_enviro <- enviroLaborTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_2005_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_2005_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_2005_enviro_top$item1,enviroLaborTokens_wordPairs_corr_20yr_2005_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_2005_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_2005_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_2005_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_2005_labor_top <- enviroLaborTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_2005_labor <- enviroLaborTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_2005_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_2005_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_2005_labor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_2005_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_2005_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_2005_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_2005_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor <- enviroLaborTokens_wordPairs_corr_20yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_20yr_2005_enviroLabor.jpg") #h=11,

```


#### 10-yr period:

##### 1900
```{r enviroLabor token co-occurrence per 10-yr period - 1900}

#### 1900
enviroLaborTokens_wordPairs_corr_10yr_1900 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1900) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1900_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1900 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1900_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1900 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1900_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1900_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1900_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1900_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1900_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1900_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1900_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1900_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1900 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1900_labor <- enviroLaborTokens_wordPairs_corr_10yr_1900 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1900_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1900_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1900_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1900_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1900_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1900_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1900_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1900 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1900 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1900_enviroLabor.jpg") #h=11,



```

##### 1905
```{r enviroLabor token co-occurrence per 10-yr period - 1905}

#### 1905
enviroLaborTokens_wordPairs_corr_10yr_1905 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1905) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1905_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1905_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1905_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1905_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1905_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1905_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1905_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1905_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1905_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1905_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1905_labor <- enviroLaborTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1905_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1905_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1905_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1905_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1905_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1905_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1905_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1905_enviroLabor.jpg") #h=11,



```

##### 1915
```{r enviroLabor token co-occurrence per 10-yr period - 1915}

#### 1915
enviroLaborTokens_wordPairs_corr_10yr_1915 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1915) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1915_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1915_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1915_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1915_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1915_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1915_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1915_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1915_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1915_enviro.jpg") #h=11,




#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1915_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1915_labor <- enviroLaborTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1915_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1915_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1915_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1915_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1915_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1915_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1915_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1915 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1915_enviroLabor.jpg") #h=11,



```

##### 1925
```{r enviroLabor token co-occurrence per 10-yr period - 1925}

#### 1925
enviroLaborTokens_wordPairs_corr_10yr_1925 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1925) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1925_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1925_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1925_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1925_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1925_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1925_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1925_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1925_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1925_enviro.jpg") #h=11,


#### LABOR KEYWORDS
#### 1925
# enviroLaborTokens_wordPairs_corr_10yr_1925 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1925) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1925_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1925_labor <- enviroLaborTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1925_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1925_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1925_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1925_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1925_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1925_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1925_enviroLabor.jpg") #h=11,



```

##### 1935
```{r enviroLabor token co-occurrence per 10-yr period - 1935}

#### 1935
enviroLaborTokens_wordPairs_corr_10yr_1935 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1935) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1935_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1935_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1935_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1935_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1935_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1935_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1935_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1935_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1935_enviro.jpg") #h=11,





#### LABOR KEYWORDS

#### 1935
# enviroLaborTokens_wordPairs_corr_10yr_1935 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1935) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1935_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1935_labor <- enviroLaborTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1935_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1935_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1935_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1935_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1935_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1935_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1935_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1935 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1935_enviroLabor.jpg") #h=11,




```

##### 1945
```{r enviroLabor token co-occurrence per 10-yr period - 1945}

#### 1945
enviroLaborTokens_wordPairs_corr_10yr_1945 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1945) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1945_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1945_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1945_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1945_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1945_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1945_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1945_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1945_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1945_enviro.jpg") #h=11,




#### LABOR KEYWORDS
#### 1945
# enviroLaborTokens_wordPairs_corr_10yr_1945 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1945) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1945_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1945_labor <- enviroLaborTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1945_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1945_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1945_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1945_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1945_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1945_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1945_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1945_enviroLabor.jpg") #h=11,



```

##### 1955
```{r enviroLabor token co-occurrence per 10-yr period - 1955}

#### 1955
enviroLaborTokens_wordPairs_corr_10yr_1955 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1955) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1955_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1955_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1955_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1955_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1955_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1955_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1955_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1955_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1955_enviro.jpg") #h=11,



#### LABOR KEYWORDS

#### 1955
# enviroLaborTokens_wordPairs_corr_10yr_1955 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1955) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1955_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1955_labor <- enviroLaborTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1955_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1955_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1955_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1955_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1955_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1955_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1955_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1955 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1955_enviroLabor.jpg") #h=11,




```

##### 1965
```{r enviroLabor token co-occurrence per 10-yr period - 1965}

#### 1965
enviroLaborTokens_wordPairs_corr_10yr_1965 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1965_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1965_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1965_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1965_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1965_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1965_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1965_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1965_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1965_enviro.jpg") #h=11,



#### LABOR KEYWORDS
#### 1965
# enviroLaborTokens_wordPairs_corr_10yr_1965 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period10==1965) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1965_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1965_labor <- enviroLaborTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1965_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1965_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1965_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1965_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1965_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1965_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1965_labor.jpg") #h=11,




#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1965_enviroLabor.jpg") #h=11,




```

##### 1975
```{r enviroLabor token co-occurrence per 10-yr period - 1975}

#### 1975
enviroLaborTokens_wordPairs_corr_10yr_1975 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1975) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1975_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1975_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1975_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1975_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1975_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1975_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1975_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1975_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1975_enviro.jpg") #h=11,



#### LABOR KEYWORDS

#### 1975
# enviroLaborTokens_wordPairs_corr_10yr_1975 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period==1975) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1975_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1975_labor <- enviroLaborTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1975_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1975_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1975_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1975_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1975_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1975_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1975_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1975 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1975_enviroLabor.jpg") #h=11,



```

##### 1985
```{r enviroLabor token co-occurrence per 10-yr period - 1985}

#### 1985
enviroLaborTokens_wordPairs_corr_10yr_1985 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1985) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1985_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1985_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1985_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1985_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1985_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1985_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1985_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1985_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1985_enviro.jpg") #h=11,




#### LABOR KEYWORDS
#### 1985
# enviroLaborTokens_wordPairs_corr_10yr_1985 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period==1985) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1985_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1985_labor <- enviroLaborTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1985_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1985_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1985_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1985_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1985_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1985_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1985_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1985_enviroLabor.jpg") #h=11,



```

##### 1995
```{r enviroLabor token co-occurrence per 10-yr period - 1995}

#### 1995
enviroLaborTokens_wordPairs_corr_10yr_1995 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==1995) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1995_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_1995_enviro <- enviroLaborTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1995_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1995_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1995_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1995_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1995_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1995_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1995_enviro.jpg") #h=11,




#### LABOR KEYWORDS
#### 1995
# enviroLaborTokens_wordPairs_corr_10yr_1995 <- enviroLaborTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
#   filter(period==1995) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)

enviroLaborTokens_wordPairs_corr_10yr_1995_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1995_labor <- enviroLaborTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1995_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1995_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1995_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1995_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1995_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1995_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1995_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_1995 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_1995_enviroLabor.jpg") #h=11,


```

##### 2005
```{r enviroLabor token co-occurrence per 10-yr period - 2005}

#### 2005
enviroLaborTokens_wordPairs_corr_10yr_2005 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==2005) %>%
  group_by(term) %>%
  filter(n() >= 10) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_2005_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_2005_enviro <- enviroLaborTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2005_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2005_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2005_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2005_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_2005_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_2005_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_2005_enviro.jpg") #h=11,


#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_2005_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_2005_labor <- enviroLaborTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2005_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2005_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2005_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2005_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_2005_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_2005_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_2005_labor.jpg") #h=11,


#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_2005_enviroLabor.jpg") #h=11,


```

##### 2015
```{r enviroLabor token co-occurrence per 10-yr period - 2015}

#### 2015
enviroLaborTokens_wordPairs_corr_10yr_2015 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period10==2015) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_2015_enviro_top <- enviroLaborTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_10yr_2015_enviro <- enviroLaborTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2015_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2015_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2015_enviro_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2015_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_2015_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_2015_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_2015_enviro.jpg") #h=11,





#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_2015_labor_top <- enviroLaborTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_2015_labor <- enviroLaborTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2015_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2015_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2015_labor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2015_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_2015_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_2015_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_2015_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor <- enviroLaborTokens_wordPairs_corr_10yr_2015 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_10yr_2015_enviroLabor.jpg") #h=11,


```


#### 5-yr period:

##### 1905
```{r enviroLabor token co-occurrence per 5-yr period - 1905}

#### 1905
enviroLaborTokens_wordPairs_corr_5yr_1905 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1905) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1905_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1905_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1905_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1905_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1905_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1905_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1905_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1905_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1905_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1905_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1905_labor <- enviroLaborTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1905_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1905_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1905_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1905_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1905_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1905_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1905_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1905 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1905_enviroLabor.jpg") #h=11,



```

##### 1910
```{r enviroLabor token co-occurrence per 5-yr period - 1910}

#### 1910
enviroLaborTokens_wordPairs_corr_5yr_1910 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1910) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1910_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1910_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1910_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1910_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1910_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1910_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1910_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1910_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1910_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1910_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1910_labor <- enviroLaborTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1910_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1910_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1910_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1910_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1910_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1910_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1910_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1910 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1910_enviroLabor.jpg") #h=11,



```

##### 1915
```{r enviroLabor token co-occurrence per 5-yr period - 1915}

#### 1915
enviroLaborTokens_wordPairs_corr_5yr_1915 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1915) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1915_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1915_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1915_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1915_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1915_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1915_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1915_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1915_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1915_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1915_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1915_labor <- enviroLaborTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1915_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1915_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1915_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1915_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1915_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1915_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1915_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1915 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1915_enviroLabor.jpg") #h=11,



```

##### 1920
```{r enviroLabor token co-occurrence per 5-yr period - 1920}

#### 1920
enviroLaborTokens_wordPairs_corr_5yr_1920 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1920) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1920_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1920_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1920_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1920_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1920_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1920_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1920_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1920_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1920_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1920_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1920_labor <- enviroLaborTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1920_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1920_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1920_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1920_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1920_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1920_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1920_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1920 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1920_enviroLabor.jpg") #h=11,



```

##### 1925
```{r enviroLabor token co-occurrence per 5-yr period - 1925}

#### 1925
enviroLaborTokens_wordPairs_corr_5yr_1925 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1925) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1925_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1925_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1925_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1925_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1925_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1925_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1925_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1925_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1925_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1925_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1925_labor <- enviroLaborTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1925_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1925_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1925_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1925_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1925_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1925_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1925 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1925_enviroLabor.jpg") #h=11,



```

##### 1930
```{r enviroLabor token co-occurrence per 5-yr period - 1930}

#### 1930
enviroLaborTokens_wordPairs_corr_5yr_1930 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1930) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1930_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1930_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1930_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1930_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1930_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1930_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1930_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1930_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1930_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1930_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1930_labor <- enviroLaborTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1930_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1930_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1930_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1930_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1930_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1930_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1930_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1930 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1930_enviroLabor.jpg") #h=11,



```

##### 1935
```{r enviroLabor token co-occurrence per 5-yr period - 1935}

#### 1935
enviroLaborTokens_wordPairs_corr_5yr_1935 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1935) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1935_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1935_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1935_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1935_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1935_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1935_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1935_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1935_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1935_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1935_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1935_labor <- enviroLaborTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1935_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1935_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1935_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1935_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1935_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1935_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1935_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1935 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1935_enviroLabor.jpg") #h=11,



```

##### 1940
```{r enviroLabor token co-occurrence per 5-yr period - 1940}

#### 1940
enviroLaborTokens_wordPairs_corr_5yr_1940 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1940) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1940_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1940_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1940_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1940_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1940_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1940_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1940_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1940_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1940_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1940_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1940_labor <- enviroLaborTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1940_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1940_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1940_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1940_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1940_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1940_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1940_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1940 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1940_enviroLabor.jpg") #h=11,



```

##### 1945
```{r enviroLabor token co-occurrence per 5-yr period - 1945}

#### 1945
enviroLaborTokens_wordPairs_corr_5yr_1945 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1945) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1945_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1945_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1945_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1945_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1945_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1945_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1945_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1945_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1945_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1945_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1945_labor <- enviroLaborTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1945_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1945_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1945_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1945_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1945_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1945_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1945_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1945 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1945_enviroLabor.jpg") #h=11,



```

##### 1950
```{r enviroLabor token co-occurrence per 5-yr period - 1950}

#### 1950
enviroLaborTokens_wordPairs_corr_5yr_1950 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1950) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1950_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1950_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1950_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1950_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1950_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1950_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1950_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1950_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1950_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1950_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1950_labor <- enviroLaborTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1950_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1950_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1950_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1950_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1950_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1950_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1950_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1950 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1950_enviroLabor.jpg") #h=11,



```

##### 1955
```{r enviroLabor token co-occurrence per 5-yr period - 1955}

#### 1955
enviroLaborTokens_wordPairs_corr_5yr_1955 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1955) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1955_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1955_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1955_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1955_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1955_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1955_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1955_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1955_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1955_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1955_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1955_labor <- enviroLaborTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1955_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1955_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1955_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1955_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1955_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1955_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1955_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1955 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1955_enviroLabor.jpg") #h=11,



```

##### 1960
```{r enviroLabor token co-occurrence per 5-yr period - 1960}

#### 1960
enviroLaborTokens_wordPairs_corr_5yr_1960 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1960) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1960_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1960_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1960_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1960_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1960_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1960_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1960_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1960_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1960_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1960_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1960_labor <- enviroLaborTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1960_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1960_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1960_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1960_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1960_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1960_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1960_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1960 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1960_enviroLabor.jpg") #h=11,



```

##### 1965
```{r enviroLabor token co-occurrence per 5-yr period - 1965}

#### 1965
enviroLaborTokens_wordPairs_corr_5yr_1965 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1965_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1965_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1965_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1965_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1965_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1965_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1965_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1965_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1965_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1965_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1965_labor <- enviroLaborTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1965_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1965_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1965_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1965_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1965_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1965_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1965_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1965 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1965_enviroLabor.jpg") #h=11,



```

##### 1970
```{r enviroLabor token co-occurrence per 5-yr period - 1970}

#### 1970
enviroLaborTokens_wordPairs_corr_5yr_1970 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1970) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1970_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1970_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1970_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1970_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1970_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1970_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1970_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1970_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1970_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1970_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1970_labor <- enviroLaborTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1970_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1970_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1970_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1970_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1970_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1970_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1970_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1970 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1970_enviroLabor.jpg") #h=11,



```

##### 1975
```{r enviroLabor token co-occurrence per 5-yr period - 1975}

#### 1975
enviroLaborTokens_wordPairs_corr_5yr_1975 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1975) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1975_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1975_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1975_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1975_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1975_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1975_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1975_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1975_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1975_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1975_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1975_labor <- enviroLaborTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1975_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1975_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1975_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1975_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1975_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1975_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1975_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1975 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1975_enviroLabor.jpg") #h=11,



```

##### 1980
```{r enviroLabor token co-occurrence per 5-yr period - 1980}

#### 1980
enviroLaborTokens_wordPairs_corr_5yr_1980 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1980) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1980_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1980_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1980_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1980_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1980_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1980_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1980_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1980_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1980_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1980_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1980_labor <- enviroLaborTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1980_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1980_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1980_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1980_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1980_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1980_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1980_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1980 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1980_enviroLabor.jpg") #h=11,



```

##### 1985
```{r enviroLabor token co-occurrence per 5-yr period - 1985}

#### 1985
enviroLaborTokens_wordPairs_corr_5yr_1985 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1985) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1985_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1985_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1985_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1985_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1985_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1985_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1985_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1985_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1985_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1985_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1985_labor <- enviroLaborTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1985_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1985_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1985_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1985_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1985_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1985_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1985_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1985 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1985_enviroLabor.jpg") #h=11,



```

##### 1990
```{r enviroLabor token co-occurrence per 5-yr period - 1990}

#### 1990
enviroLaborTokens_wordPairs_corr_5yr_1990 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1990) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1990_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1990_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1990_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1990_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1990_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1990_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1990_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1990_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1990_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1990_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1990_labor <- enviroLaborTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1990_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1990_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1990_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1990_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1990_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1990_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1990_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1990 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1990_enviroLabor.jpg") #h=11,



```

##### 1995
```{r enviroLabor token co-occurrence per 5-yr period - 1995}

#### 1995
enviroLaborTokens_wordPairs_corr_5yr_1995 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==1995) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1995_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_1995_enviro <- enviroLaborTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1995_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1995_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1995_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1995_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1995_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1995_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1995_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1995_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1995_labor <- enviroLaborTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1995_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1995_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1995_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1995_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1995_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1995_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1995_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_1995 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_1995_enviroLabor.jpg") #h=11,



```

##### 2000
```{r enviroLabor token co-occurrence per 5-yr period - 2000}

#### 2000
enviroLaborTokens_wordPairs_corr_5yr_2000 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2000) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2000_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_2000_enviro <- enviroLaborTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2000_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2000_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2000_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2000_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2000_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2000_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2000_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2000_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2000_labor <- enviroLaborTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2000_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2000_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2000_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2000_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2000_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2000_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2000_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_2000 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2000_enviroLabor.jpg") #h=11,



```

##### 2005
```{r enviroLabor token co-occurrence per 5-yr period - 2005}

#### 2005
enviroLaborTokens_wordPairs_corr_5yr_2005 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2005) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2005_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_2005_enviro <- enviroLaborTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2005_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2005_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2005_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2005_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2005_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2005_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2005_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2005_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2005_labor <- enviroLaborTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2005_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2005_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2005_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2005_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2005_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2005_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2005_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_2005 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2005_enviroLabor.jpg") #h=11,



```

##### 2010
```{r enviroLabor token co-occurrence per 5-yr period - 2010}

#### 2010
enviroLaborTokens_wordPairs_corr_5yr_2010 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2010) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2010_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_2010_enviro <- enviroLaborTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2010_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2010_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2010_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2010_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2010_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2010_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2010_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2010_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2010_labor <- enviroLaborTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2010_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2010_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2010_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2010_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2010_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2010_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2010_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_2010 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2010_enviroLabor.jpg") #h=11,



```

##### 2015
```{r enviroLabor token co-occurrence per 5-yr period - 2015}

#### 2015
enviroLaborTokens_wordPairs_corr_5yr_2015 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2015) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2015_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_2015_enviro <- enviroLaborTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2015_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2015_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2015_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2015_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2015_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2015_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2015_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2015_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2015_labor <- enviroLaborTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2015_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2015_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2015_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2015_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2015_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2015_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2015_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_2015 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2015_enviroLabor.jpg") #h=11,



```

##### 2020
```{r enviroLabor token co-occurrence per 5-yr period - 2020}

#### 2020
enviroLaborTokens_wordPairs_corr_5yr_2020 <- enviroLaborTokens %>%
  # select(speech_id,term,count,year) %>%
  filter(period5==2020) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)


#### ENVIRO KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2020_enviro_top <- enviroLaborTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %ilike% enviroVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 

enviroLaborTokens_wordPairs_corr_5yr_2020_enviro <- enviroLaborTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2020_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2020_enviro_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2020_enviro_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2020_enviro_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2020_enviro_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2020_enviro %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="seagreen2", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2020_enviro.jpg") #h=11,



#### LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2020_labor_top <- enviroLaborTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2020_labor <- enviroLaborTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2020_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2020_labor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2020_labor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2020_labor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2020_labor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2020_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blue", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2020_labor.jpg") #h=11,



#### ENVIRO-LABOR KEYWORDS
enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor_top <- enviroLaborTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %ilike% enviroLaborVocabString_simple) %>%
  arrange(-correlation) %>%
  slice_max(correlation,n=100) 
  # group_by(item1) %>%
  # slice_max(correlation,n=30) %>%
  # ungroup() %>%

enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor <- enviroLaborTokens_wordPairs_corr_5yr_2020 %>%
  filter(item1 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item2) &
           item2 %in% c(enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item1,enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor_top$item2)) %>%
  slice_max(correlation,n=200) %>%
  rbind(enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor_top) %>%
  distinct()
  # filter(correlation>=0.25)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="blueviolet", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroLaborTokens_wordPairs_corr_5yr_2020_enviroLabor.jpg") #h=11,



```



## TOPIC MODELING

```{python set-up, include=FALSE}

import re
import pandas as pd

from umap import UMAP
from hdbscan import HDBSCAN
from sentence_transformers import SentenceTransformer
from sklearn.feature_extraction.text import CountVectorizer
import openai

from bertopic import BERTopic
from bertopic.representation import KeyBERTInspired, MaximalMarginalRelevance, OpenAI, PartOfSpeech
from bertopic.vectorizers import ClassTfidfTransformer

```

```{r prepare data}

enviroLaborSpeeches_dtm <- enviroLaborSpeeches 
# mutate(period2 = as.numeric(year) - as.numeric(year) %% 2)
save(enviroLaborSpeeches_dtm,file="greenPy/data/enviroLaborSpeeches_dtm.Rdata")

enviroLaborSentences_dtm <- enviroLaborSpeeches %>%
  unnest_sentences(output=sentence,
                   input=speech,
                   strip_punct=TRUE,
                   format="text",
                   to_lower=TRUE,
                   drop=TRUE) %>%
  mutate(word_count = map(sentence, \(sentence) stri_stats_latex(sentence)[4]),
         word_count = as.numeric(str_extract(word_count,"[:digit:]+"))) %>%
  filter(word_count>5)
save(enviroLaborSentences_dtm,file="greenPy/data/enviroLaborSentences_dtm.Rdata")

# enviroLaborSpeeches_dtm <- chunk_text(enviroLaborSpeeches_dtm$speech, doc_id = enviroLaborSpeeches_dtm$speech_id, chunk_size = 50) %>%
#   enframe(name = "group", value = "text") %>%
#   mutate(speech_id=as.numeric(str_remove(group,"-.*"))) %>%
#   left_join(enviroLaborSpeeches) %>%
#     select(-group,speech) %>%
#   as_tibble()

```

```{python prepare data}

#### prepare data

## documents
# speeches = r.enviroLaborSpeeches_dtm.speech.to_list()
speeches = r.enviroLaborSpeeches_dtm.sentence.to_list()

## timestamps
timestamps20 = r.enviroLaborSpeeches_dtm.period20.to_list()
timestamps10 = r.enviroLaborSpeeches_dtm.period10.to_list()
timestamps5 = r.enviroLaborSpeeches_dtm.period5.to_list()
timestamps2 = r.enviroLaborSpeeches_dtm.period2.to_list()

```

```{python full model steps}

###### sent tokenizer (BEST PRACTICE) ###### 
# from nltk.tokenize import sent_tokenize, word_tokenize
# sentences = [sent_tokenize(speech) for speech in speeches]
# sentences = [sentence for doc in sentences for sentence in doc]


###### STEP 1 - Extract embeddings ###### 
# embedding_model = SentenceTransformer("all-MiniLM-L6-v2")
### pre-calculate embeddings (BEST PRACTICE)
embedding_model = SentenceTransformer("all-MiniLM-L6-v2")
embeddings = embedding_model.encode(speeches, show_progress_bar=True)
# We reduce our embeddings to 2D as it will allows us to quickly iterate later on
reduced_embeddings = UMAP(n_neighbors=10, n_components=2, min_dist=0.0, metric='cosine').fit_transform(embeddings)


###### STEP 2 - Reduce dimensionality ###### 
# umap_model = UMAP(n_neighbors=15, n_components=5, min_dist=0.0, metric='cosine')
### preventing stochastic behavior (BEST PRACTICE)
umap_model = UMAP(n_neighbors=15, n_components=5, min_dist=0.0, metric='cosine', random_state=42)


###### STEP 3 - Cluster reduced embeddings ###### 
# hdbscan_model = HDBSCAN(min_cluster_size=15, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
### controlling number of topics (BEST PRACTICE)
# hdbscan_model = HDBSCAN(min_cluster_size=300, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
hdbscan_model = HDBSCAN(min_cluster_size=300, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
# hdbscan_model = HDBSCAN(min_cluster_size=150, metric='euclidean', cluster_selection_method='eom', prediction_data=True)
# hdbscan_model = HDBSCAN(min_cluster_size=100, metric='euclidean', cluster_selection_method='eom', prediction_data=True)

###### STEP 4 - Tokenize topics ###### 
# vectorizer_model = CountVectorizer(stop_words="english")
### improving default representation
# vectorizer_model = CountVectorizer(stop_words="english", min_df=2, ngram_range=(1, 2))
vectorizer_model = CountVectorizer(min_df=10)

###### STEP 5 - Create topic representation ###### 
ctfidf_model = ClassTfidfTransformer()


###### STEP 6 - (Optional) Fine-tune topic representations with ###### 
# representation_model = KeyBERTInspired()
### Fine-tune topic representations with GPT

## KeyBERT
keybert_model = KeyBERTInspired()

## Part-of-Speech
# pos_model = PartOfSpeech("en_core_web_sm")

## MMR
mmr_model = MaximalMarginalRelevance(diversity=0.3)

# ## GPT-3.5
# client = openai.OpenAI(api_key="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")
# prompt = """
# I have a topic that contains the following documents:
# [DOCUMENTS]
# The topic is described by the following keywords: [KEYWORDS]
# 
# Based on the information above, extract a short but highly descriptive topic label of at most 5 words. Make sure it is in the following format:
# topic: <topic label>
# """
# openai_model = OpenAI(client, model="gpt-3.5-turbo", chat=True, prompt=prompt)




```

```{python global model}

# global model (all best practice steps together)
# topic_model = BERTopic(min_topic_size=100,verbose=True)
topic_model = BERTopic(
  top_n_words=10,
  min_topic_size=300, #if it nears a million documents, then it is advised to set it much higher than the default of 10, for example, 100 or even 500.
  verbose=True,
  # calculate_probabilities = False,
  embedding_model=embedding_model,          # Step 1 - Extract embeddings
  umap_model=umap_model,                    # Step 2 - Reduce dimensionality
  hdbscan_model=hdbscan_model,              # Step 3 - Cluster reduced embeddings
  vectorizer_model=vectorizer_model,        # Step 4 - Tokenize topics
  ctfidf_model=ctfidf_model,                # Step 5 - Extract topic words
  # representation_model=representation_model # Step 6 - (Optional) Fine-tune topic representations
)

# Train model
# topics, probs = topic_model.fit_transform(speeches)
topics, probs = topic_model.fit_transform(speeches, embeddings)

```

```{python update topic model}

### Fine-tune topic representations after training BERTopic
vectorizer_model = CountVectorizer(stop_words="english", ngram_range=(1, 3), min_df=10)

### All representation models
representation_model = {
    "KeyBERT": keybert_model,
    # "OpenAI": openai_model,  # Uncomment if you will use OpenAI
    "MMR": mmr_model
    # "POS": pos_model
}

###### RE-RUN
# topic_model.update_topics(speeches, vectorizer_model=vectorizer_model, representation_model=representation_model)
topic_model.update_topics(speeches, vectorizer_model=vectorizer_model, representation_model=representation_model) #representation_model=representation_model)

```

```{python update}
# frequent topics
topic_info = topic_model.get_topic_info() #includes outliers (-1)
topic_docs = topic_model.get_document_info(speeches)

# hierarchical topics
hierarchical_topics = topic_model.hierarchical_topics(speeches)

```

```{r save files}

topic_info_r <- py_to_r(py$topic_info)

write_csv(py$topic_info,file="congress_bookdown/data/topic_info_50.csv")
# save(py$topic_docs,file="congress_bookdown/data/topic_docs_50_reduceOutliers.Rda")

```

```{python visualize topics}

##### visualize global model
plot_topics = topic_model.visualize_topics()
plot_topics.write_html("congress_bookdown/figures/plot_enviroLabor_topics_50.html")

##### visualize global model hierarchy
# plot_topics_hierarchy = topic_model.visualize_hierarchy()
plot_topics_hierarchy = topic_model.visualize_hierarchy(hierarchical_topics=hierarchical_topics)
plot_topics_hierarchy.write_html("congress_bookdown/figures/plot_enviroLabor_topics_hierarchy_50.html")


##### KeyBERTInspired labels
keybert_topic_labels = {topic: " | ".join(list(zip(*values))[0][:3]) for topic, values in topic_model.topic_aspects_["KeyBERT"].items()}
keybert_topic_labels[-1] = "Outlier Topic"
topic_model.set_topic_labels(keybert_topic_labels)

plot_topics_key = topic_model.visualize_topics(custom_labels=True)
plot_topics_key.write_html("congress_bookdown/figures/plot_enviroLabor_topics_50_key.html")

plot_topics_hierarchy_key = topic_model.visualize_hierarchy(hierarchical_topics=hierarchical_topics,custom_labels=True)
plot_topics_hierarchy_key.write_html("congress_bookdown/figures/plot_enviroLabor_topics_hierarchy_50_key.html")


##### MMR labels
mmr_topic_labels = {topic: " | ".join(list(zip(*values))[0][:3]) for topic, values in topic_model.topic_aspects_["MMR"].items()}
topic_model.set_topic_labels(mmr_topic_labels)

plot_topics_mmr = topic_model.visualize_topics(custom_labels=True)
plot_topics_mmr.write_html("congress_bookdown/figures/plot_enviroLabor_topics_50_mmr.html")

plot_topics_hierarchy_mmr = topic_model.visualize_hierarchy(hierarchical_topics=hierarchical_topics,custom_labels=True)
plot_topics_hierarchy_mmr.write_html("congress_bookdown/figures/plot_enviroLabor_topics_hierarchy_50_mmr.html")


##### ChatGBT labels
# chatgpt_topic_labels = {topic: " | ".join(list(zip(*values))[0]) for topic, values in topic_model.topic_aspects_["OpenAI"].items()}
# chatgpt_topic_labels[-1] = "Outlier Topic"
# topic_model.set_topic_labels(chatgpt_topic_labels)

# # visualize keywords per topic
# topic_model.visualize_barchart()
# 
# # term score decline
# topic_model.visualize_term_rank()
# topic_model.visualize_term_rank(log_scale=True)

```

```{python reduce outliers}

#Visualize
plot_topics_original = topic_model.visualize_documents(speeches, reduced_embeddings=reduced_embeddings, hide_annotations=True, hide_document_hover=True) 
plot_topics_original.write_html("congress_bookdown/figures/plot_enviroLabor_topics_50_original.html")  
                                
# Reduce outliers
# new_topics = topic_model.reduce_outliers(speeches, topics)
new_topics = topic_model.reduce_outliers(speeches, topics, strategy="c-tf-idf")
# new_topics = topic_model.reduce_outliers(speeches, new_topics, strategy="distributions")
new_topics = topic_model.reduce_outliers(speeches, new_topics, strategy="embeddings")

#Update topics
# topic_model.update_topics(docs, topics=new_topics)
documents = pd.DataFrame({"Document": speeches, "Topic": new_topics})
topic_model._update_topic_size(documents)

#Visualize
plot_topics_outlierReduction = topic_model.visualize_documents(speeches, reduced_embeddings=reduced_embeddings, hide_document_hover=True, hide_annotations=True)
plot_topics_outlierReduction.write_html("congress_bookdown/figures/plot_enviroLabor_topics_50_outlierReduction.html") 
```

```{python visualize topics over time}

# topic representations at each time stamp
topics_over_time_10 = topic_model.topics_over_time(speeches, timestamps10, global_tuning=False, evolution_tuning=True)  #nr_bins=20
topics_over_time_5 = topic_model.topics_over_time(speeches, timestamps5, global_tuning=False, evolution_tuning=True)  #nr_bins=20
topics_over_time_2 = topic_model.topics_over_time(speeches, timestamps2, global_tuning=False, evolution_tuning=True)  #nr_bins=20

# plotly topics over time
topic_model.set_topic_labels(keybert_topic_labels)
plot_topics_over_time_key = topic_model.visualize_topics_over_time(topics_over_time_10, top_n_topics=25, custom_labels=True)
plot_topics_over_time_key.write_html("congress_bookdown/figures/plot_enviroLabor_topics_over_time_50_10_key.html")
plot_topics_over_time_key = topic_model.visualize_topics_over_time(topics_over_time_5, top_n_topics=25, custom_labels=True)
plot_topics_over_time_key.write_html("congress_bookdown/figures/plot_enviroLabor_topics_over_time_50_5_key.html")
plot_topics_over_time_key = topic_model.visualize_topics_over_time(topics_over_time_2, top_n_topics=25, custom_labels=True)
plot_topics_over_time_key.write_html("congress_bookdown/figures/plot_enviroLabor_topics_over_time_50_2_key.html")

topic_model.set_topic_labels(mmr_topic_labels)
plot_topics_over_time_mmr = topic_model.visualize_topics_over_time(topics_over_time_10, top_n_topics=25, custom_labels=True)
plot_topics_over_time_mmr.write_html("congress_bookdown/figures/plot_enviroLabor_topics_over_time_50_10_mmr.html")
plot_topics_over_time_mmr = topic_model.visualize_topics_over_time(topics_over_time_5, top_n_topics=25, custom_labels=True)
plot_topics_over_time_mmr.write_html("congress_bookdown/figures/plot_enviroLabor_topics_over_time_50_5_mmr.html")
plot_topics_over_time_mmr = topic_model.visualize_topics_over_time(topics_over_time_2, top_n_topics=25, custom_labels=True)
plot_topics_over_time_mmr.write_html("congress_bookdown/figures/plot_enviroLabor_topics_over_time_50_2_mmr.html")

# # plotly specific topics over time
# topic_model.visualize_topics_over_time(topics_over_time, topics=[9, 10, 72, 83, 87, 91])

```












## SET-UP TOPIC MODELING

```{r set-up, include=FALSE}

# virtualenv_create("r-reticulate", 
#                   python="3.12",
#                   packages=c("openai","bertopic"))

# virtualenv_create("r-reticulate", 
#                   packages=NULL,
#                   python="3.12")

# py_install(c("openai","bertopic"), #"pandas"), #"sentence_transformers"), #"spacy", "nltk"
#            # envname="r-reticulate",
#            # method="virtualenv",
#            # pip_ignore_installed = TRUE,
#            # pip_ignore_installed = FALSE,
#            pip = TRUE)


```


```{r, include=FALSE}

virtualenv_create("r-reticulate", 
                  packages=NULL,
                  python="3.12")

use_virtualenv("r-reticulate")

```

```{python}

import os
os.environ["DYLD_FALLBACK_LIBRARY_PATH"]
# FALLBACK_PATH = {"DYLD_FALLBACK_LIBRARY_PATH" : "/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156"}
del os.environ["DYLD_FALLBACK_LIBRARY_PATH"]
os.environ.update({"DYLD_FALLBACK_LIBRARY_PATH" : "/usr/local/lib:/usr/lib:/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156"})
os.environ["DYLD_FALLBACK_LIBRARY_PATH"]

```


```{r set-up, include=FALSE}

# virtualenv_create("r-reticulate", 
#                   python="3.12",
#                   packages=c("openai","bertopic"))

py_install(c("openai","bertopic"), #"pandas"), #"sentence_transformers"), #"spacy", "nltk"
           envname="r-reticulate",
           method="virtualenv",
           pip_ignore_installed = TRUE,
           # pip_ignore_installed = FALSE,
           pip = TRUE)

# export LDFLAGS="-L/usr/local/opt/zlib/lib"
# export CPPFLAGS="-I/usr/local/opt/zlib/include"

# source .virtualenvs/r-reticulate/bin/activate

# pip3 install --force-reinstall numba
# pip3 install --force-reinstall bertopic
# pip3 install --force-reinstall -v "numpy==1.26.0"
# pip3 install --force-reinstall llvmlite

```
```{r}

# sessionInfo()
# R RHOME

# sudo rm -rf /Library/Frameworks/Python.framework/Versions/3.12
# sudo rm -rf "/Applications/Python $3.12/"
# ls -l /usr/local/bin | grep '../Library/Frameworks/Python.framework/Versions/3.12'
# cd /usr/local/bin
# ls -l /usr/local/bin | grep '../Library/Frameworks/Python.framework/Versions/3.12' | awk '{print $9}' | tr -d @ | xargs rm

# brew uninstall python@3.12
# brew reinstall --build-from-source python@3.12
# brew link --overwrite python@3.13 --dry-run
# brew link --overwrite python@3.12 --dry-run
# brew link --overwrite python@3.12


# brew install zlib bzip2

# export LDFLAGS+="-L/usr/local/opt/zlib/lib"
# export CPPFLAGS+="-I/usr/local/opt/zlib/include"
# export PKG_CONFIG_PATH+="/usr/local/opt/zlib/lib/pkgconfig"
# 
# export LDFLAGS+="-L/usr/local/opt/libpq/lib"
# export CPPFLAGS+="-I/usr/local/opt/libpq/include"
# export PKG_CONFIG_PATH+="/usr/local/opt/libpq/lib/pkgconfig"


# pip3 uninstall llvmlite
# pip3 install --force-reinstall llvmlite

# pip3 install --force-reinstall numba
# pip3 install --force-reinstall bertopic
# pip3 install --force-reinstall -v "numpy==1.26.0"

brew install bzip2

Sys.getenv("DYLD_FALLBACK_LIBRARY_PATH")
Sys.getenv("DYLD_LIBRARY_PATH")
Sys.getenv("RPATH")

# unset DYLD_LIBRARY_PATH
reset DYLD_LIBRARY_PATH

export DYLD_LIBRARY_PATH+="/usr/lib"
# DYLD_LIBRARY_PATH="/usr/lib"

#in python Makefile
DYLD_FRAMEWORK_PATH=/private/tmp/_py/_bld/python
















otool -L MyApp.app/Contents/MacOS/MyApp
otool -L R.app/Contents/MacOS/R

nano ~/.bash_profil

pip install bertopic[spacy]
pip install --force-reinstall -v "numpy==1.26.0"



```

```{r}

py_run_string("import os")

# py_run_string("del os.environ['DYLD_LIBRARY_PATH']")
py_run_string("os.environ.update({'DYLD_LIBRARY_PATH' : '/usr/lib'})")

py_run_string("del os.environ['DYLD_FALLBACK_LIBRARY_PATH']")
py_run_string("os.environ.update({'DYLD_FALLBACK_LIBRARY_PATH' : '/Users/chamilton/lib:/usr/local/lib:/lib:/usr/lib:/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156'})")
# py_run_string("os.environ.update({'DYLD_FALLBACK_LIBRARY_PATH' : '/usr/local/lib:/usr/lib:/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156'})")

# Sys.getenv("DYLD_FRAMEWORK_PATH")
# Sys.getenv("DYLD_FALLBACK_FRAMEWORK_PATH")

Sys.getenv("DYLD_LIBRARY_PATH")
Sys.getenv("DYLD_FALLBACK_LIBRARY_PATH")
Sys.getenv("PATH")
Sys.getenv("RPATH")
Sys.getenv("RHOME")

echo >> /Users/chamilton/.zprofile
echo 'eval "$(/opt/homebrew/bin/brew shellenv)"' >> /Users/chamilton/.zprofile
eval "$(/opt/homebrew/bin/brew shellenv)"





echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.zshrc
echo '[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.zshrc
echo 'eval "$(pyenv init -)"' >> ~/.zshrc

echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.zprofile
echo '[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.zprofile
echo 'eval "$(pyenv init -)"' >> ~/.zprofile

echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.zlogin
echo '[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.zlogin
echo 'eval "$(pyenv init -)"' >> ~/.zlogin


# Sys.getenv("RPATH")

# unset DYLD_LIBRARY_PATH
# export DYLD_LIBRARY_PATH="/usr/lib"
# export DYLD_LIBRARY_PATH="$DYLD_LIBRARY_PATH:/usr/lib"
# unset DYLD_FALLBACK_LIBRARY_PATH
# export DYLD_LIBRARY_FALLBACK_PATH="/Users/chamilton/lib:/usr/local/lib:/lib:/usr/lib:/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156"
# export DYLD_LIBRARY_FALLBACK_PATH="$DYLD_FALLBACK_LIBRARY_PATH:/Users/chamilton/lib:/usr/local/lib:/lib:/usr/lib:/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156"


```

```{python set-up, include=FALSE}

import os
import sys
import sysconfig

# FALLBACK_PATH = {"DYLD_FALLBACK_LIBRARY_PATH" : "/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156"}
# del os.environ['DYLD_FALLBACK_LIBRARY_PATH']
# os.environ.update({'DYLD_FALLBACK_LIBRARY_PATH' : '/usr/local/lib:/usr/lib:/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server:/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-788759156'})
# os.environ['DYLD_FALLBACK_LIBRARY_PATH']

# os.environ.get('DYLD_FRAMEWORK_PATH')
# os.environ.get('DYLD_FALLBACK_FRAMEWORK_PATH')
os.environ.get('DYLD_LIBRARY_PATH')
os.environ.get('DYLD_FALLBACK_LIBRARY_PATH')
# os.environ.get('RPATH')
# 
# DEFAULT_FRAMEWORK_FALLBACK = [
#     os.path.expanduser("~/Library/Frameworks"),
#     "/Library/Frameworks",
#     "/Network/Library/Frameworks",
#     "/System/Library/Frameworks",
# ]

# DEFAULT_LIBRARY_FALLBACK = [
#     os.path.expanduser("~/lib"),
#     "/usr/local/lib",
#     "/lib",
#     "/usr/lib",
# ]

# unset DYLD_LIBRARY_PATH
# export DYLD_LIBRARY_PATH+="/usr/lib:/usr/local/lib"
# DYLD_LIBRARY_PATH="/usr/lib"

#in python Makefile
# DYLD_FRAMEWORK_PATH=/private/tmp/_py/_bld/python

# os.environ['RPATH']
# os.environ['DYLD_FALLBACK_LIBRARY_PATH']
# os.environ['DYLD_LIBRARY_PATH']
# os.environ['PATH']
# 
# sys.platform
# sys.platform
# os.sys['RPATH']
# sys.sys_env['DYLD_FALLBACK_LIBRARY_PATH']
# sys.sys_env['DYLD_LIBRARY_PATH']
# sys.sys_env['PATH']

import re
import pandas as pd

from umap import UMAP

from bertopic import BERTopic
from bertopic.representation import KeyBERTInspired, MaximalMarginalRelevance, OpenAI, PartOfSpeech
from bertopic.vectorizers import ClassTfidfTransformer

```

```{bash}

pyenv local 3.12.7
pyenv shell 3.12.7

<!-- pip install --upgrade pip -->
<!-- python -m pip install openai bertopic -->

<!-- brew install zlib bzip2 -->

echo 'export PATH="/opt/homebrew/opt/zlib/bin:$PATH"' >> ~/.zshrc
echo 'export PATH="/opt/homebrew/opt/zlib/bin:$PATH"' >> ~/.zprofile
echo 'export PATH="/opt/homebrew/opt/zlib/bin:$PATH"' >> ~/.zlogin
export LDFLAGS="-L/opt/homebrew/opt/zlib/lib"
export CPPFLAGS="-I/opt/homebrew/opt/zlib/include"

<!-- echo 'export PATH="/opt/homebrew/opt/bzip2/bin:$PATH"' >> ~/.zshrc -->
<!-- export LDFLAGS="-L/opt/homebrew/opt/bzip2/lib" -->
<!-- export CPPFLAGS="-I/opt/homebrew/opt/bzip2/include" -->




pip install --force-reinstall numba
pip install --force-reinstall bertopic
pip install --force-reinstall -v "numpy==1.26.0"
pip install --force-reinstall llvmlite

```

```{python set-up, include=FALSE}


# import os
# os.environ.get('PATH')
# os.environ.get('DYLD_LIBRARY_PATH')
# os.environ.get('DYLD_FALLBACK_LIBRARY_PATH')

# /usr/lib/libz.1.2.12.dylib

# os.environ['PATH'].split(os.pathsep)

# '/Users/chamilton/.pyenv/versions/3.12.7/lib/libz.1.dylib'
# '/System/Volumes/Preboot/Cryptexes/OS/Users/chamilton/.pyenv/versions/3.12.7/lib/libz.1.dylib'
# '/opt/homebrew/lib/libz.1.dylib' 
# '/System/Volumes/Preboot/Cryptexes/OS/opt/homebrew/lib/libz.1.dylib' 
# '/Library/Frameworks/R.framework/Resources/lib/libz.1.dylib' 
# '/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server/libz.1.dylib' 
# '/var/folders/p3/0gbxjhms45g4xkb19v23lpqc0000gq/T/rstudio-fallback-library-path-515500505/libz.1.dylib' 

# pip3 install --force-reinstall numba

import re
import pandas as pd

from umap import UMAP
from hdbscan import HDBSCAN
from sentence_transformers import SentenceTransformer
from sklearn.feature_extraction.text import CountVectorizer
import openai

from bertopic import BERTopic
from bertopic.representation import KeyBERTInspired, MaximalMarginalRelevance, OpenAI, PartOfSpeech
from bertopic.vectorizers import ClassTfidfTransformer

```

