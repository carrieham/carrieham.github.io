---
title: "CLC text mining"
output:
  html_document:
    pandoc_args:
    - +RTS
    - "-M64G"
    - "-RTS"
    code_folding: hide
    self_contained: no
    df_print: paged
    highlighter: haddock
    toc: true
    toc_float: true
    css: styles.css
    includes:
      in_header: header.html
---
<p>

<center><font size="3">`r Sys.Date()`</font></center>

</p>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
#quanteda_options(tokens_block_size = 50000)

options(repos = list(CRAN="http://cran.rstudio.com/"))
install.packages("pacman")
library(pacman)

p_load(bookdown,
       data.table,
       DataTables,
       dplyr, 
       DT,
       forcats,
       ggrepel,
       htmlwidgets,
       lubridate,
       plotly,
       quanteda,
       stopwords,
       tictoc,
       tidyverse, 
       tidytext,
       tokenizers,
       vroom,
       widyr,
       ggraph,
       igraph,
       topicmodels)

# library(reticulate)
# require(devtools)
# install_github("stephbuon/posextractr")
# library(posextractr)
# # posextract_install() #only run first time ever installing package
# # virtualenv_create("r-posextract", python="3.12")
# py_install(c("pandas", "spacy", "posextract","lark"), pip = TRUE)
# # system(command = "python3 -m spacy download en_core_web_sm")
# posextract_initialize()

```

### DATA
```{r input data, include=FALSE, cache=TRUE, cache.lazy=FALSE}
# #### DATA
load(verbose=TRUE,"data/enviroLaborSpeeches.Rda")

# enviroLaborSpeeches <- enviroLaborSpeeches %>%
#   filter(year>=1900)


stopwords_iso <- stopwords("en", source = "stopwords-iso") 
stopwords_manual <- c("absent","adjourn", "ask", "can", "chairman",
                       "committee","con","democrat","etc","gentleladies",
                       "gentlelady", "gentleman", "gentlemen", "gentlewoman",
                       "gentlewomen","hereabout","hereafter","hereat", "hereby",
                       "herein", "hereinafter", "hereinbefore", "hereinto", "hereof",
                       "hereon", "hereto", "heretofore", "hereunder", "hereunto",
                       "hereupon", "herewith", "month", "mr", "mrs", "nai", "nay",
                       "none", "now", "part", "per", "pro", "republican",
                       "say", "senator", "shall", "sir", "speak", "speaker",
                       "tell", "thank", "thereabout", "thereafter", "thereagainst",
                       "thereat", "therebefore", "therebeforn", "thereby", "therefor",
                       "therefore", "therefrom", "therein", "thereinafter", "thereof",
                       "thereon", "thereto", "theretofore", "thereunder", "thereunto",
                       "thereupon", "therewith", "therewithal", "today", "whereabouts",
                       "whereafter", "whereas", "whereat", "whereby","wherefore",
                       "wherefrom", "wherein", "whereinto", "whereof", "whereon","whereto",
                       "whereunder", "whereupon", "wherever", "wherewith", 
                       "wherewithal", "will", "yea", "yes", "yield")

stopwords_manual2 <- c("white house","white houses",
                       "avenue","street","nw","northwest","suite",
                       "number","numeric","sequence","sequences",
                       "add","addition","additions","adding","added",
                       "amend","amended","amendment","amendments","amending","amends",
                       "america","american","americas",
                       "bill","bills",
                       "chapter","chapters",
                       "code","codes",
                       "country","countrys", 
                       "congress","congressional",
                       "district of columbia","district","districts",
                       "enact","enacted","enacting","enacts",
                       "federal", 
                       "senate","senates", 
                       "house of representatives","representative","representatives","the house",
                       "insert","inserting","inserted","inserts",
                       "law","laws",
                       "legislation","legislative","legislator",
                       "paragraph","paragraphs","sentence","sentences",
                       "percent","percentage","percentages",
                       "president","presidents","presidential", 
                       "print","printing","printed","prints",
                       "record","recording","recorded","records",
                       "section","sections",
                       "united states",
                       "state","states",
                       "subchapter","subchapters",
                       "subsection","subsections",
                       "supreme court","supreme courts","court","courts",
                       "title","titles",
                       "unanimous consent","consent","consenting",
                       "united","u.s.","us",
                       "urge","urging","urged","urges",
                       "colleague","colleagues",
                       "washington", "d.c.")

stopwords <- c(stopwords_manual2,stopwords_manual,stopwords_iso)

bad_syntax <- vroom("data/vocabulary/master_list.txt",delim="|") %>%
  rename("classify" = "_classify") %>%
  filter(classify != "vocab") %>%
  mutate(phrase=str_replace_all(phrase," ","_"))

bad_syntax_manual <- c("llc_york",
                       "york_trump",
                       "remain_expend",
                       "corp_york",
                       "dt_mark",
                       "llc_trump",
                       "subparagraph_strike",
                       "unoblig_balanc",
                       "include_transfer",
                       "fiscal_fiscal",
                       "pre_submiss",
                       "preced_divis",
                       "preced_proviso",
                       "corp_trump",
                       "york_dt",
                       "dt_mark",
                       "manag_corp",
                       "hous_dc",
                       "dc_hon")

```

```{r input tokens data, include=FALSE, cache=TRUE, cache.lazy=FALSE}
# #### INPUT TOKENS

load(verbose=TRUE,"data/R/enviroTokens.Rda")

load(verbose=TRUE,"data/R/enviroBigrams.Rda")

load(verbose=TRUE,"data/R/laborTokens.Rda")

load(verbose=TRUE,"data/R/laborBigrams.Rda")

load(verbose=TRUE,"data/R/enviroLaborTokens.Rda")

load(verbose=TRUE,"data/R/enviroLaborBigrams.Rda")
```

```{r enviro bigrams, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}
# ####
# ##### BIGRAMS #####
tic()
enviroBigrams <- enviroLaborSpeeches %>%
  filter(environment=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  # tokens_remove(stopwords, #REMOVE STOP WORDS BEFORE TRIPLES CREATED
  #               padding=FALSE,
  #               verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  filter(!(term %in% bad_syntax_manual)) %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor),by=join_by(speech_id==speech_id)) %>%
  as_tibble()

toc()
#
# ##### SAVE FILE
save(enviroBigrams,file="data/R/enviroBigrams.Rda")

```

```{r labor bigrams, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

##### BIGRAMS #####
tic()
laborBigrams <- enviroLaborSpeeches %>%
  filter(labor=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  # tokens_remove(stopwords, #REMOVE STOP WORDS BEFORE TRIPLES CREATED
  #               padding=FALSE,
  #               verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  filter(!(term %in% bad_syntax_manual)) %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor),by=join_by(speech_id==speech_id)) %>%
  as_tibble()
toc()

##### SAVE FILE
save(laborBigrams,file="data/R/laborBigrams.Rda")

```

```{r enviroLabor bigrams, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

##### BIGRAMS #####
tic()
enviroLaborBigrams <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  # tokens_remove(stopwords, #REMOVE STOP WORDS BEFORE TRIPLES CREATED
  #               padding=FALSE,
  #               verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  filter(!(term %in% bad_syntax_manual)) %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor),by=join_by(speech_id==speech_id)) %>%
  as_tibble()
toc()

##### SAVE FILE
save(enviroLaborBigrams,file="data/R/enviroLaborBigrams.Rda")

# enviroLaborBigrams_1965 <- enviroLaborBigrams %>%
#   filter(year>=1965)
```

```{r enviro tokens, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

##### TOKENS #####
tic()
enviroTokens <- enviroLaborSpeeches %>%
  filter(environment=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=TRUE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor),by=join_by(speech_id==speech_id)) %>%
  as_tibble()
toc()

##### SAVE FILE
save(enviroTokens,file="data/R/enviroTokens.Rda")

```

```{r labor tokens, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE, eval=FALSE}

##### TOKENS #####
tic()
laborTokens <- enviroLaborSpeeches %>%
  filter(labor=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=TRUE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor),by=join_by(speech_id==speech_id)) %>%
  as_tibble()
toc()

##### SAVE FILE
save(laborTokens,file="data/R/laborTokens.Rda")
```

```{r enviroLabor tokens, message=FALSE, results=FALSE, cache=TRUE, lazy.cache=FALSE}

##### TOKENS #####
tic()
enviroLaborTokens <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=TRUE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  dfm() %>% #CREATE DOC-TERM MATRIX
  tidy() %>%
  mutate(speech_id=as.double(document)) %>%
  left_join(enviroLaborSpeeches %>% select(year,date,speech_id,environment,labor),by=join_by(speech_id==speech_id)) %>%
  as_tibble()
toc()

##### SAVE FILE
save(enviroLaborTokens,file="data/R/enviroLaborTokens.Rda")

```

### SPEECHES
```{r enviroLabor speeches over time, echo=FALSE, cache=TRUE}

enviroSpeeches_byYear <- enviroLaborSpeeches %>%
  filter(environment=="Yes") %>%
  group_by(year) %>%
  summarize(n=n(),prop=n/unique(total_annual_speeches)) %>%
  arrange(desc(year))

laborSpeeches_byYear <- enviroLaborSpeeches %>%
  filter(labor=="Yes") %>%
  group_by(year) %>%
  summarize(n=n(),prop=n/unique(total_annual_speeches)) %>%
  arrange(desc(year))

enviroLaborSpeeches_byYear <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  group_by(year) %>%
  summarize(n=n(),prop=n/unique(total_annual_speeches)) %>%
  arrange(desc(year))

allSpeeches_byYear <- rbind(mutate(enviroSpeeches_byYear,type="environment"),
                            mutate(laborSpeeches_byYear,type="labor"),
                            mutate(enviroLaborSpeeches_byYear,type="enviro-labor"))

map_allSpeeches_byYear <- ggplot() +
geom_line(data=allSpeeches_byYear,
              aes(x=year,
                  y=n,
                  group=3,
                  color=type,
                  text=paste("<b>",year,":</b> ",n," speeches",sep=""))) +
  scale_color_manual(values=c("environment"="aquamarine4",
                              "labor"="blue",
                              "enviro-labor"="blueviolet")) +
  guides(color=guide_legend(title = "")) +
  scale_x_continuous(breaks = seq(1880, 2020, by = 10)) + 
  theme_minimal() +
  theme(axis.line=element_line(color="#32127a"),
        axis.ticks=element_line(color="#32127a"),
        axis.title.x=element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())

##### make interactive
ggplotly(map_allSpeeches_byYear, tooltip="text") %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         legend=list(xref="paper",
                     x=0.5,xanchor='center',
                     y=1,yanchor='top',
                     orientation='h',
                     traceorder="reversed",
                     title=list(font=list(color="#32127a",family="IBM Plex Mono")),
                     font=list(color="#32127a",family="IBM Plex Mono"))) %>%
  partial_bundle() %>%
  saveWidget("figures/speeches_by_year.html", selfcontained = F, libdir = "lib")

```

```{r enviroLabor prop speeches over time, echo=FALSE, cache=TRUE}

map_allSpeeches_prop_byYear <- ggplot() +
geom_line(data=allSpeeches_byYear,
              aes(x=year,
                  y=prop,
                  group=3,
                  color=type,
                  text=paste("<b>",year,":</b> ",round(prop*100,1),"% of speeches",sep=""))) +
  scale_color_manual(values=c("environment"="aquamarine4",
                              "labor"="blue",
                              "enviro-labor"="blueviolet")) +
  guides(color=guide_legend(title = "")) +
  scale_x_continuous(breaks = seq(1880, 2020, by = 10)) + 
  theme_minimal() +
  theme(axis.line=element_line(color="#32127a"),
        axis.ticks=element_line(color="#32127a"),
        axis.title.x=element_blank(),
        axis.title.y=element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())

##### make interactive
ggplotly(map_allSpeeches_prop_byYear, tooltip="text") %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         legend=list(xref="paper",
                     x=0.5,xanchor='center',
                     y=1,yanchor='top',
                     orientation='h',
                     traceorder="reversed",
                     title=list(font=list(color="#32127a",family="IBM Plex Mono")),
                     font=list(color="#32127a",family="IBM Plex Mono"))) %>%
  partial_bundle() %>%
  saveWidget("figures/speeches_prop_by_year.html", selfcontained = F, libdir = "lib")

```

### ANALYSIS: BIGRAM COUNTS

#### ENVIRO

##### top 35 enviro bigrams pre- vs. post-war
```{r top enviro bigrams pre- vs. post-war, message=FALSE, cache=TRUE}

enviro_bigrams_pre_vs_post_war <- enviroBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = case_when(year >= 1875 & year <= 1945 ~ "1875-1945",
                            year > 1945 ~ "1946-present")) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(35) %>%
  arrange(desc(n))
save(enviro_bigrams_pre_vs_post_war,file="data/R/tables/enviroBigrams_pre_vs_post_war.Rda")


#### pre-war
top_enviro_bigrams_pre_war <- ggplot() +
  geom_col(data=filter(enviro_bigrams_pre_vs_post_war,period=="1875-1945"),
           aes(x=reorder_within(term,n,period),y=n),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title="1875-1945",x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviro_bigrams_pre_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviro_bigrams_pre_war.html",selfcontained = F, libdir = "lib")


#### post-war
top_enviro_bigrams_post_war <- ggplot() +
  geom_col(data=filter(enviro_bigrams_pre_vs_post_war,period=="1946-present"),
           aes(x=reorder_within(term,n,period),y=n),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title="1946-present",x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviro_bigrams_post_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviro_bigrams_post_war.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviro bigrams per 25-year period 
```{r top enviro bigrams by year 25-yr period, message=FALSE, cache=TRUE}

enviro_bigrams_by_year_25yr <- enviroBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviro_bigrams_by_year_25yr,file="data/R/tables/enviroBigrams_by_25yrs.Rda")


#### 1875 & 1900
top_enviroBigrams_25yr_1875_1900 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_25yr,period==1875 | period==1900),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_25yr_1875_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_25yr_1875_1900.html",selfcontained = F, libdir = "lib")


#### 1925 & 1950
top_enviroBigrams_25yr_1925_1950 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_25yr,period==1925 | period==1950),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_25yr_1925_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_25yr_1925_1950.html",selfcontained = F, libdir = "lib")


#### 1975 & 2000
top_enviroBigrams_25yr_1975_2000 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_25yr,period==1975 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_25yr_1975_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_25yr_1975_2000.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviro bigrams per 20-year period 
```{r top enviro bigrams by year 20-yr period, message=FALSE, cache=TRUE}

enviro_bigrams_by_year_20yr <- enviroBigrams %>%
  filter(year>=1900 & year<=2019) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviro_bigrams_by_year_20yr,file="data/R/tables/enviroBigrams_by_20yrs.Rda")


#### 1900 & 1920
top_enviroBigrams_20yr_1900_1920 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_20yr,period==1900 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1900_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_20yr_1900_1920.html",selfcontained = F, libdir = "lib")


#### 1940 & 1960
top_enviroBigrams_20yr_1940_1960 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_20yr,period==1940 | period==1960),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1940_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_20yr_1940_1960.html",selfcontained = F, libdir = "lib")


#### 1980 & 2000
top_enviroBigrams_20yr_1980_2000 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_20yr,period==1980 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1980_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_20yr_1980_2000.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviro bigrams per 15-year period 
```{r top enviro bigrams by year 15-yr period, message=FALSE, cache=TRUE}

enviro_bigrams_by_year_15yr <- enviroBigrams %>%
  filter(year>=1905) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviro_bigrams_by_year_15yr,file="data/R/tables/enviroBigrams_by_15yrs.Rda")
  


#### 1905 & 1920
top_enviroBigrams_15yr_1905_1920 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_15yr,period==1905 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1905_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_15yr_1905_1920.html",selfcontained = F, libdir = "lib")



#### 1935 & 1950
top_enviroBigrams_15yr_1935_1950 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_15yr,period==1935 | period==1950),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1935_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_15yr_1935_1950.html",selfcontained = F, libdir = "lib")



#### 1965 & 1980
top_enviroBigrams_15yr_1965_1980 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_15yr,period==1965 | period==1980),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1965_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_15yr_1965_1980.html",selfcontained = F, libdir = "lib")


#### 1995 & 2010
top_enviroBigrams_15yr_1995_2010 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_15yr,period==1995 | period==2010),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1995_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_15yr_1995_2010.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviro bigrams per 10-year period 
```{r top enviro bigrams by year 10-yr period, message=FALSE, cache=TRUE}

enviro_bigrams_by_year_10yr <- enviroBigrams %>%
  filter(year>=1890) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviro_bigrams_by_year_10yr,file="data/R/tables/enviroBigrams_by_10yrs.Rda")
  


#### 1890 & 1900
top_enviroBigrams_10yr_1890_1900 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_10yr,period==1890 | period==1900),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1890_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_10yr_1890_1900.html",selfcontained = F, libdir = "lib")




#### 1910 & 1920
top_enviroBigrams_10yr_1910_1920 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_10yr,period==1910 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1910_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_10yr_1910_1920.html",selfcontained = F, libdir = "lib")



#### 1930 & 1940
top_enviroBigrams_10yr_1930_1940 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_10yr,period==1930 | period==1940),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1930_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_10yr_1930_1940.html",selfcontained = F, libdir = "lib")


#### 1950 & 1960
top_enviroBigrams_10yr_1950_1960 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_10yr,period==1950 | period==1960),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1950_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_10yr_1950_1960.html",selfcontained = F, libdir = "lib")


#### 1970 & 1980
top_enviroBigrams_10yr_1970_1980 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_10yr,period==1970 | period==1980),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1970_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_10yr_1970_1980.html",selfcontained = F, libdir = "lib")

#### 1990 & 2000
top_enviroBigrams_10yr_1990_2000 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_10yr,period==1990 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1990_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_10yr_1990_2000.html",selfcontained = F, libdir = "lib")


#### 2010 & 2020
top_enviroBigrams_10yr_2010_2020 <- ggplot() +
  geom_col(data=filter(enviro_bigrams_by_year_10yr,period==2010 | period==2020),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="aquamarine4") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_2010_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroBigrams_10yr_2010_2020.html",selfcontained = F, libdir = "lib")


```


#### LABOR

##### top 35 labor bigrams pre- vs. post-war
```{r top labor bigrams pre- vs. post-war, message=FALSE, cache=TRUE}

labor_bigrams_pre_vs_post_war <- laborBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = case_when(year >= 1875 & year <= 1945 ~ "1875-1945",
                            year > 1945 ~ "1946-present")) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(35) %>%
  arrange(desc(n))
save(labor_bigrams_pre_vs_post_war,file="data/R/tables/laborBigrams_pre_vs_post_war.Rda")


#### pre-war
top_labor_bigrams_pre_war <- ggplot() +
  geom_col(data=filter(labor_bigrams_pre_vs_post_war,period=="1875-1945"),
           aes(x=reorder_within(term,n,period),y=n),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title="1875-1945",x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_labor_bigrams_pre_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_labor_bigrams_pre_war.html",selfcontained = F, libdir = "lib")


#### post-war
top_labor_bigrams_post_war <- ggplot() +
  geom_col(data=filter(labor_bigrams_pre_vs_post_war,period=="1946-present"),
           aes(x=reorder_within(term,n,period),y=n),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title="1946-present",x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_labor_bigrams_post_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_labor_bigrams_post_war.html",selfcontained = F, libdir = "lib")

```

##### top 25 labor bigrams per 25-year period 
```{r top labor bigrams by year 25-yr period, message=FALSE, cache=TRUE}

labor_bigrams_by_year_25yr <- laborBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(labor_bigrams_by_year_25yr,file="data/R/tables/laborBigrams_by_25yrs.Rda")


#### 1875 & 1900
top_laborBigrams_25yr_1875_1900 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_25yr,period==1875 | period==1900),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_25yr_1875_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_25yr_1875_1900.html",selfcontained = F, libdir = "lib")


#### 1925 & 1950
top_laborBigrams_25yr_1925_1950 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_25yr,period==1925 | period==1950),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_25yr_1925_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_25yr_1925_1950.html",selfcontained = F, libdir = "lib")


#### 1975 & 2000
top_laborBigrams_25yr_1975_2000 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_25yr,period==1975 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_25yr_1975_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_25yr_1975_2000.html",selfcontained = F, libdir = "lib")

```

##### top 25 labor bigrams per 20-year period
```{r top labor bigrams by year 20-yr period, message=FALSE, cache=TRUE}

labor_bigrams_by_year_20yr <- laborBigrams %>%
  filter(year>=1900 & year<=2019) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(labor_bigrams_by_year_20yr,file="data/R/tables/laborBigrams_by_20yrs.Rda")


#### 1900 & 1920
top_laborBigrams_20yr_1900_1920 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_20yr,period==1900 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_20yr_1900_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_20yr_1900_1920.html",selfcontained = F, libdir = "lib")


#### 1940 & 1960
top_laborBigrams_20yr_1940_1960 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_20yr,period==1940 | period==1960),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_20yr_1940_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_20yr_1940_1960.html",selfcontained = F, libdir = "lib")


#### 1980 & 2000
top_laborBigrams_20yr_1980_2000 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_20yr,period==1980 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_20yr_1980_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_20yr_1980_2000.html",selfcontained = F, libdir = "lib")

```

##### top 25 labor bigrams per 15-year period 
```{r top labor bigrams by year 15-yr period, message=FALSE, cache=TRUE}

labor_bigrams_by_year_15yr <- laborBigrams %>%
  filter(year>=1905) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(labor_bigrams_by_year_15yr,file="data/R/tables/laborBigrams_by_15yrs.Rda")
  


#### 1905 & 1920
top_laborBigrams_15yr_1905_1920 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_15yr,period==1905 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_15yr_1905_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_15yr_1905_1920.html",selfcontained = F, libdir = "lib")



#### 1935 & 1950
top_laborBigrams_15yr_1935_1950 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_15yr,period==1935 | period==1950),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_15yr_1935_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_15yr_1935_1950.html",selfcontained = F, libdir = "lib")



#### 1965 & 1980
top_laborBigrams_15yr_1965_1980 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_15yr,period==1965 | period==1980),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_15yr_1965_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_15yr_1965_1980.html",selfcontained = F, libdir = "lib")


#### 1995 & 2010
top_laborBigrams_15yr_1995_2010 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_15yr,period==1995 | period==2010),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_15yr_1995_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_15yr_1995_2010.html",selfcontained = F, libdir = "lib")

```

##### top 25 labor bigrams per 10-year period 
```{r top labor bigrams by year 10-yr period, message=FALSE, cache=TRUE}

labor_bigrams_by_year_10yr <- laborBigrams %>%
  filter(year>=1890) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(labor_bigrams_by_year_10yr,file="data/R/tables/laborBigrams_by_10yrs.Rda")
  


#### 1890 & 1900
top_laborBigrams_10yr_1890_1900 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_10yr,period==1890 | period==1900),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_10yr_1890_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_10yr_1890_1900.html",selfcontained = F, libdir = "lib")




#### 1910 & 1920
top_laborBigrams_10yr_1910_1920 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_10yr,period==1910 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_10yr_1910_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_10yr_1910_1920.html",selfcontained = F, libdir = "lib")



#### 1930 & 1940
top_laborBigrams_10yr_1930_1940 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_10yr,period==1930 | period==1940),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_10yr_1930_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_10yr_1930_1940.html",selfcontained = F, libdir = "lib")


#### 1950 & 1960
top_laborBigrams_10yr_1950_1960 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_10yr,period==1950 | period==1960),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_10yr_1950_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_10yr_1950_1960.html",selfcontained = F, libdir = "lib")


#### 1970 & 1980
top_laborBigrams_10yr_1970_1980 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_10yr,period==1970 | period==1980),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_10yr_1970_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_10yr_1970_1980.html",selfcontained = F, libdir = "lib")

#### 1990 & 2000
top_laborBigrams_10yr_1990_2000 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_10yr,period==1990 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_10yr_1990_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_10yr_1990_2000.html",selfcontained = F, libdir = "lib")


#### 2010 & 2020
top_laborBigrams_10yr_2010_2020 <- ggplot() +
  geom_col(data=filter(labor_bigrams_by_year_10yr,period==2010 | period==2020),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blue") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_laborBigrams_10yr_2010_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_laborBigrams_10yr_2010_2020.html",selfcontained = F, libdir = "lib")


```


#### ENVIRO-LABOR
##### top 35 enviroLabor bigrams pre- vs. post-war
```{r top enviroLabor bigrams pre- vs. post-war, message=FALSE, cache=TRUE}

enviroLabor_bigrams_pre_vs_post_war <- enviroLaborBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = case_when(year >= 1875 & year <= 1945 ~ "1875-1945",
                            year > 1945 ~ "1946-present")) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(35) %>%
  arrange(desc(n))
save(enviroLabor_bigrams_pre_vs_post_war,file="data/R/tables/enviroLaborBigrams_pre_vs_post_war.Rda")


#### pre-war
top_enviroLabor_bigrams_pre_war <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_pre_vs_post_war,period=="1875-1945"),
           aes(x=reorder_within(term,n,period),y=n),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title="1875-1945",x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLabor_bigrams_pre_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLabor_bigrams_pre_war.html",selfcontained = F, libdir = "lib")


#### post-war
top_enviroLabor_bigrams_post_war <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_pre_vs_post_war,period=="1946-present"),
           aes(x=reorder_within(term,n,period),y=n),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title="1946-present",x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLabor_bigrams_post_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLabor_bigrams_post_war.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviroLabor bigrams per 25-year period 
```{r top enviroLabor bigrams by year 25-yr period, message=FALSE, cache=TRUE}

enviroLabor_bigrams_by_year_25yr <- enviroLaborBigrams %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviroLabor_bigrams_by_year_25yr,file="data/R/tables/enviroLaborBigrams_by_25yrs.Rda")


#### 1875 & 1900
top_enviroLaborBigrams_25yr_1875_1900 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_25yr,period==1875 | period==1900),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_25yr_1875_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_25yr_1875_1900.html",selfcontained = F, libdir = "lib")


#### 1925 & 1950
top_enviroLaborBigrams_25yr_1925_1950 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_25yr,period==1925 | period==1950),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_25yr_1925_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_25yr_1925_1950.html",selfcontained = F, libdir = "lib")


#### 1975 & 2000
top_enviroLaborBigrams_25yr_1975_2000 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_25yr,period==1975 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_25yr_1975_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_25yr_1975_2000.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviroLabor bigrams per 20-year period 
```{r top enviroLabor bigrams by year 20-yr period, message=FALSE, cache=TRUE}

enviroLabor_bigrams_by_year_20yr <- enviroLaborBigrams %>%
  filter(year>=1900 & year<=2019) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviroLabor_bigrams_by_year_20yr,file="data/R/tables/enviroLaborBigrams_by_20yrs.Rda")


#### 1900 & 1920
top_enviroLaborBigrams_20yr_1900_1920 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_20yr,period==1900 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1900_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_20yr_1900_1920.html",selfcontained = F, libdir = "lib")


#### 1940 & 1960
top_enviroLaborBigrams_20yr_1940_1960 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_20yr,period==1940 | period==1960),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1940_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_20yr_1940_1960.html",selfcontained = F, libdir = "lib")


#### 1980 & 2000
top_enviroLaborBigrams_20yr_1980_2000 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_20yr,period==1980 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_20yr_1980_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_20yr_1980_2000.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviroLabor bigrams per 15-year period 
```{r top enviroLabor bigrams by year 15-yr period, message=FALSE, cache=TRUE}

enviroLabor_bigrams_by_year_15yr <- enviroLaborBigrams %>%
  filter(year>=1905) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviroLabor_bigrams_by_year_15yr,file="data/R/tables/enviroLaborBigrams_by_15yrs.Rda")
  


#### 1905 & 1920
top_enviroLaborBigrams_15yr_1905_1920 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_15yr,period==1905 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_15yr_1905_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_15yr_1905_1920.html",selfcontained = F, libdir = "lib")



#### 1935 & 1950
top_enviroLaborBigrams_15yr_1935_1950 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_15yr,period==1935 | period==1950),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_15yr_1935_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_15yr_1935_1950.html",selfcontained = F, libdir = "lib")



#### 1965 & 1980
top_enviroLaborBigrams_15yr_1965_1980 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_15yr,period==1965 | period==1980),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_15yr_1965_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_15yr_1965_1980.html",selfcontained = F, libdir = "lib")


#### 1995 & 2010
top_enviroLaborBigrams_15yr_1995_2010 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_15yr,period==1995 | period==2010),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_15yr_1995_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_15yr_1995_2010.html",selfcontained = F, libdir = "lib")

```

##### top 25 enviroLabor bigrams per 10-year period 
```{r top enviroLabor bigrams by year 10-yr period, message=FALSE, cache=TRUE}

enviroLabor_bigrams_by_year_10yr <- enviroLaborBigrams %>%
  filter(year>=1890) %>%
  filter(!(term %in% bad_syntax$phrase)) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  group_by(period) %>%
  count(term,wt=count) %>%
  top_n(25) %>%
  arrange(desc(n))
save(enviroLabor_bigrams_by_year_10yr,file="data/R/tables/enviroLaborBigrams_by_10yrs.Rda")
  


#### 1890 & 1900
top_enviroLaborBigrams_10yr_1890_1900 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_10yr,period==1890 | period==1900),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1890_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_10yr_1890_1900.html",selfcontained = F, libdir = "lib")




#### 1910 & 1920
top_enviroLaborBigrams_10yr_1910_1920 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_10yr,period==1910 | period==1920),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1910_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_10yr_1910_1920.html",selfcontained = F, libdir = "lib")



#### 1930 & 1940
top_enviroLaborBigrams_10yr_1930_1940 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_10yr,period==1930 | period==1940),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1930_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_10yr_1930_1940.html",selfcontained = F, libdir = "lib")


#### 1950 & 1960
top_enviroLaborBigrams_10yr_1950_1960 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_10yr,period==1950 | period==1960),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1950_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_10yr_1950_1960.html",selfcontained = F, libdir = "lib")


#### 1970 & 1980
top_enviroLaborBigrams_10yr_1970_1980 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_10yr,period==1970 | period==1980),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1970_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_10yr_1970_1980.html",selfcontained = F, libdir = "lib")

#### 1990 & 2000
top_enviroLaborBigrams_10yr_1990_2000 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_10yr,period==1990 | period==2000),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_1990_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_10yr_1990_2000.html",selfcontained = F, libdir = "lib")


#### 2010 & 2020
top_enviroLaborBigrams_10yr_2010_2020 <- ggplot() +
  geom_col(data=filter(enviroLabor_bigrams_by_year_10yr,period==2010 | period==2020),
           aes(x=reorder_within(term,n,period),
               y=n,
               text=paste("<b>",term,":</b> ",n,sep="")),
               fill="blueviolet") +
  coord_flip() +
  scale_x_reordered() +
  facet_wrap(~period, scales = "free", ncol=3) +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(x="",y="count") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroLaborBigrams_10yr_2010_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/top_enviroLaborBigrams_10yr_2010_2020.html",selfcontained = F, libdir = "lib")


```



### ANALYSIS: tf-ipf

#### ENVIRO 
```{r enviro tf-ipf setup}

enviroBigrams_count <- enviroBigrams %>%
  group_by(year,term) %>%
  count(term,wt=count) %>%
  filter(n>25)

enviroTokens_count <- enviroTokens %>%
  group_by(year,term) %>%
  count(term,wt=count) %>%
  filter(n>25)

```


##### bigrams

##### most distinguishing bigrams pre vs. post-war period
```{r enviro bigrams tf-ipf pre- vs. post-war period}

##### ENVIRO #####

enviro_oneRowPerDocument_pre_vs_post_war <- enviroBigrams_count %>%
  mutate(period = case_when(year >= 1875 & year <= 1945 ~ "1875-1945",
                            year > 1945 ~ "1946-present")) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_pre_vs_post_war <- enviro_oneRowPerDocument_pre_vs_post_war %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 

#### pre- vs. post-war
top_enviroBigrams_pre_vs_post_war <- ggplot() +
  geom_col(data=enviro_tfidf_pre_vs_post_war,
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches pre- vs. post-war period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_pre_vs_post_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_pre_vs_post_war.html",selfcontained = F, libdir = "lib")

```

##### most distinguishing bigrams per 25-year period 
```{r enviro bigrams tf-ipf per 25-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_25yr <- enviroBigrams_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_25yr <- enviro_oneRowPerDocument_25yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1875 & 1900
top_enviroBigrams_25yr_1875_1900 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_25yr,period==1875 | period==1900),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 25-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_25yr_1875_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_25yr_1875_1900.html",selfcontained = F, libdir = "lib")


#### 1925 & 1950
top_enviroBigrams_25yr_1925_1950 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_25yr,period==1925 | period==1950),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 25-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_25yr_1925_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_25yr_1925_1950.html",selfcontained = F, libdir = "lib")


#### 1975 & 2000
top_enviroBigrams_25yr_1975_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_25yr,period==1975 | period==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 25-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_25yr_1975_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_25yr_1975_2000.html",selfcontained = F, libdir = "lib")

```

##### most distinguishing bigrams per 20-year period
```{r enviro bigrams tf-ipf per 20-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_20yr <- enviroBigrams_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_20yr <- enviro_oneRowPerDocument_20yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1900 & 1920
top_enviroBigrams_20yr_1900_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period==1900 | period==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 20-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1900_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_20yr_1900_1920.html",selfcontained = F, libdir = "lib")


#### 1940 & 1960
top_enviroBigrams_20yr_1940_1960 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period==1940 | period==1960),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 20-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1940_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_20yr_1940_1960.html",selfcontained = F, libdir = "lib")


#### 1980 & 2000
top_enviroBigrams_20yr_1980_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period==1980 | period==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 20-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_20yr_1980_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_20yr_1980_2000.html",selfcontained = F, libdir = "lib")

```

##### most distinguishing bigrams per 15-year period 
```{r enviro bigrams tf-ipf per 15-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_15yr <- enviroBigrams_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_15yr <- enviro_oneRowPerDocument_15yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1875 & 1890
top_enviroBigrams_15yr_1875_1890 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1875 | period==1890),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1875_1890, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_15yr_1875_1890.html",selfcontained = F, libdir = "lib")



#### 1905 & 1920
top_enviroBigrams_15yr_1905_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1905 | period==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1905_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_15yr_1905_1920.html",selfcontained = F, libdir = "lib")



#### 1935 & 1950
top_enviroBigrams_15yr_1935_1950 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1935 | period==1950),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1935_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_15yr_1935_1950.html",selfcontained = F, libdir = "lib")


#### 1965 & 1980
top_enviroBigrams_15yr_1965_1980 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1965 | period==1980),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1965_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_15yr_1965_1980.html",selfcontained = F, libdir = "lib")


#### 1995 & 2010
top_enviroBigrams_15yr_1995_2010 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1995 | period==2010),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_15yr_1995_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_15yr_1995_2010.html",selfcontained = F, libdir = "lib")


```

##### most distinguishing bigrams per 10-year period 
```{r enviro bigrams tf-ipf per 10-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_10yr <- enviroBigrams_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_10yr <- enviro_oneRowPerDocument_10yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1890 & 1900
top_enviroBigrams_10yr_1890_1900 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1890 | period==1900),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1890_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_10yr_1890_1900.html",selfcontained = F, libdir = "lib")



#### 1910 & 1920
top_enviroBigrams_10yr_1910_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1910 | period==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1910_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_10yr_1910_1920.html",selfcontained = F, libdir = "lib")



#### 1930 & 1940
top_enviroBigrams_10yr_1930_1940 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1930 | period==1940),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1930_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_10yr_1930_1940.html",selfcontained = F, libdir = "lib")



#### 1950 & 1960
top_enviroBigrams_10yr_1950_1960 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1950 | period==1960),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1950_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_10yr_1950_1960.html",selfcontained = F, libdir = "lib")



#### 1970 & 1980
top_enviroBigrams_10yr_1970_1980 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1970 | period==1980),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1970_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_10yr_1970_1980.html",selfcontained = F, libdir = "lib")



#### 1990 & 2000
top_enviroBigrams_10yr_1990_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1990 | period==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_1990_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_10yr_1990_2000.html",selfcontained = F, libdir = "lib")



#### 2010 & 2020
top_enviroBigrams_10yr_2010_2020 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==2010 | period==2020),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroBigrams_10yr_2010_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroBigrams_10yr_2010_2020.html",selfcontained = F, libdir = "lib")


```

##### tokens

##### most distinguishing tokens pre vs. post-war period
```{r enviro tokens tf-ipf pre- vs. post-war period}

##### ENVIRO #####

enviro_oneRowPerDocument_pre_vs_post_war <- enviroTokens_count %>%
  mutate(period = case_when(year >= 1875 & year <= 1945 ~ "1875-1945",
                            year > 1945 ~ "1946-present")) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_pre_vs_post_war <- enviro_oneRowPerDocument_pre_vs_post_war %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 

#### 1875 & 1900
top_enviroTokens_pre_vs_post_war <- ggplot() +
  geom_col(data=enviro_tfidf_pre_vs_post_war,
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches pre- vs. post-war period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_pre_vs_post_war, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_pre_vs_post_war.html",selfcontained = F, libdir = "lib")

```

##### most distinguishing tokens per 25-year period 
```{r enviro tokens tf-ipf per 25-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_25yr <- enviroTokens_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_25yr <- enviro_oneRowPerDocument_25yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1875 & 1900
top_enviroTokens_25yr_1875_1900 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_25yr,period==1875 | period==1900),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 25-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_25yr_1875_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_25yr_1875_1900.html",selfcontained = F, libdir = "lib")


#### 1925 & 1950
top_enviroTokens_25yr_1925_1950 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_25yr,period==1925 | period==1950),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 25-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_25yr_1925_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_25yr_1925_1950.html",selfcontained = F, libdir = "lib")


#### 1975 & 2000
top_enviroTokens_25yr_1975_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_25yr,period==1975 | period==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 25-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_25yr_1975_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_25yr_1975_2000.html",selfcontained = F, libdir = "lib")

```

##### most distinguishing tokens per 20-year period
```{r enviro tokens tf-ipf per 20-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_20yr <- enviroTokens_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_20yr <- enviro_oneRowPerDocument_20yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1900 & 1920
top_enviroTokens_20yr_1900_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period==1900 | period==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 20-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_20yr_1900_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_20yr_1900_1920.html",selfcontained = F, libdir = "lib")


#### 1940 & 1960
top_enviroTokens_20yr_1940_1960 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period==1940 | period==1960),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 20-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_20yr_1940_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_20yr_1940_1960.html",selfcontained = F, libdir = "lib")


#### 1980 & 2000
top_enviroTokens_20yr_1980_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_20yr,period==1980 | period==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 20-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_20yr_1980_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_20yr_1980_2000.html",selfcontained = F, libdir = "lib")

```

##### most distinguishing tokens per 15-year period 
```{r enviro tokens tf-ipf per 15-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_15yr <- enviroTokens_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_15yr <- enviro_oneRowPerDocument_15yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1875 & 1890
top_enviroTokens_15yr_1875_1890 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1875 | period==1890),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_15yr_1875_1890, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_15yr_1875_1890.html",selfcontained = F, libdir = "lib")



#### 1905 & 1920
top_enviroTokens_15yr_1905_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1905 | period==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_15yr_1905_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_15yr_1905_1920.html",selfcontained = F, libdir = "lib")



#### 1935 & 1950
top_enviroTokens_15yr_1935_1950 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1935 | period==1950),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_15yr_1935_1950, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_15yr_1935_1950.html",selfcontained = F, libdir = "lib")


#### 1965 & 1980
top_enviroTokens_15yr_1965_1980 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1965 | period==1980),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_15yr_1965_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_15yr_1965_1980.html",selfcontained = F, libdir = "lib")


#### 1995 & 2010
top_enviroTokens_15yr_1995_2010 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_15yr,period==1995 | period==2010),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 15-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_15yr_1995_2010, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_15yr_1995_2010.html",selfcontained = F, libdir = "lib")


```

##### most distinguishing tokens per 10-year period 
```{r enviro tokens tf-ipf per 10-yr period}

##### ENVIRO #####

enviro_oneRowPerDocument_10yr <- enviroTokens_count %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  group_by(period, term) %>%
  dplyr::summarize(count = sum(n)) %>%
  ungroup() %>%
  mutate(id_number = period) %>%
  filter(!is.na(period)) %>%
  filter(!is.na(term)) %>%
  filter(!is.na(id_number))

enviro_tfidf_10yr <- enviro_oneRowPerDocument_10yr %>%
  bind_tf_idf(term, id_number, count) %>%
  group_by(period) %>%
  arrange(desc(tf_idf)) %>%
  slice(seq_len(25)) %>%
  ungroup() 


#### 1890 & 1900
top_enviroTokens_10yr_1890_1900 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1890 | period==1900),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_10yr_1890_1900, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_10yr_1890_1900.html",selfcontained = F, libdir = "lib")



#### 1910 & 1920
top_enviroTokens_10yr_1910_1920 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1910 | period==1920),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_10yr_1910_1920, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_10yr_1910_1920.html",selfcontained = F, libdir = "lib")



#### 1930 & 1940
top_enviroTokens_10yr_1930_1940 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1930 | period==1940),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_10yr_1930_1940, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_10yr_1930_1940.html",selfcontained = F, libdir = "lib")



#### 1950 & 1960
top_enviroTokens_10yr_1950_1960 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1950 | period==1960),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_10yr_1950_1960, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_10yr_1950_1960.html",selfcontained = F, libdir = "lib")



#### 1970 & 1980
top_enviroTokens_10yr_1970_1980 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1970 | period==1980),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_10yr_1970_1980, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_10yr_1970_1980.html",selfcontained = F, libdir = "lib")



#### 1990 & 2000
top_enviroTokens_10yr_1990_2000 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==1990 | period==2000),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_10yr_1990_2000, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_10yr_1990_2000.html",selfcontained = F, libdir = "lib")



#### 2010 & 2020
top_enviroTokens_10yr_2010_2020 <- ggplot() +
  geom_col(data=filter(enviro_tfidf_10yr,period==2010 | period==2020),
           aes(y=count,
               x = reorder_within(term, 
                                  count, 
                                  period, 
                                  fun = sum),
               text = paste("<b>",term,"</b>",
                            "<br>count: ",
                            count,
                            "<br>tf_idf: ",
                            signif(tf_idf,2),
                            sep="")),
           fill="aquamarine4") +
  facet_wrap(~period, scales = "free", ncol=2) +
  scale_x_reordered() +
  coord_flip() +
  guides(fill=FALSE, color = FALSE, line = FALSE) +
  labs(title = "words that distinguished enviro speeches per 10-yr period",
       y = "count",
       x = "") +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())

ggplotly(top_enviroTokens_10yr_2010_2020, tooltip="text", dynamicTicks = FALSE) %>%
  style(hoverlabel=list(font=list(family="IBM Plex Mono",
                                  size=11))) %>%
  layout(font=list(color="#32127a",family="IBM Plex Mono"),
         xaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a")),
         yaxis=list(color="#32127a",
                    linecolor="#32127a",
                    tickfont=list(color="#32127a"))) %>%
  saveWidget("figures/tfipf_enviroTokens_10yr_2010_2020.html",selfcontained = F, libdir = "lib")


```


#### LABOR 

#### ENVIRO-LABOR





### ANALYSIS: topic models

#### ENVIRO

##### enviro speech topics per 25-yr period:
```{r enviro topics per 25-yr period r}

##### 1875 #####
enviroBigrams_1875_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1875) %>%
  cast_dtm(document,term,count)

enviroBigrams_1875_lda <- LDA(enviroBigrams_1875_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1875_topics <- tidy(enviroBigrams_1875_lda, matrix = "beta")

enviroBigrams_1875_top_terms <- enviroBigrams_1875_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1875_top_terms <- enviroBigrams_1875_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1875_top_terms

ggsave("congress_bookdown/figures/enviro_topics_25yr_1875.jpg",w =9, h=14, units = "in") #h=11,


##### 1900 #####
enviroBigrams_1900_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1900) %>%
  cast_dtm(document,term,count)

enviroBigrams_1900_lda <- LDA(enviroBigrams_1900_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1900_topics <- tidy(enviroBigrams_1900_lda, matrix = "beta")

enviroBigrams_1900_top_terms <- enviroBigrams_1900_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1900_top_terms <- enviroBigrams_1900_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1900_top_terms

ggsave("congress_bookdown/figures/enviro_topics_25yr_1900.jpg",w =9, h=14, units = "in") #h=11,


##### 1925 #####
enviroBigrams_1925_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1925) %>%
  cast_dtm(document,term,count)

enviroBigrams_1925_lda <- LDA(enviroBigrams_1925_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1925_topics <- tidy(enviroBigrams_1925_lda, matrix = "beta")

enviroBigrams_1925_top_terms <- enviroBigrams_1925_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1925_top_terms <- enviroBigrams_1925_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1925_top_terms

ggsave("congress_bookdown/figures/enviro_topics_25yr_1925.jpg",w =9, h=14, units = "in") #h=11,


##### 1950 #####
enviroBigrams_1950_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1950) %>%
  cast_dtm(document,term,count)

enviroBigrams_1950_lda <- LDA(enviroBigrams_1950_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1950_topics <- tidy(enviroBigrams_1950_lda, matrix = "beta")

enviroBigrams_1950_top_terms <- enviroBigrams_1950_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1950_top_terms <- enviroBigrams_1950_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1950_top_terms

ggsave("congress_bookdown/figures/enviro_topics_25yr_1950.jpg",w =9, h=14, units = "in") #h=11,


##### 1975 #####
enviroBigrams_1975_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1975) %>%
  cast_dtm(document,term,count)

enviroBigrams_1975_lda <- LDA(enviroBigrams_1975_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1975_topics <- tidy(enviroBigrams_1975_lda, matrix = "beta")

enviroBigrams_1975_top_terms <- enviroBigrams_1975_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1975_top_terms <- enviroBigrams_1975_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1975_top_terms

ggsave("congress_bookdown/figures/enviro_topics_25yr_1975.jpg",w =9, h=14, units = "in") #h=11,


##### 2000 #####
enviroBigrams_2000_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==2000) %>%
  cast_dtm(document,term,count)

enviroBigrams_2000_lda <- LDA(enviroBigrams_2000_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_2000_topics <- tidy(enviroBigrams_2000_lda, matrix = "beta")

enviroBigrams_2000_top_terms <- enviroBigrams_2000_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_2000_top_terms <- enviroBigrams_2000_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_2000_top_terms

ggsave("congress_bookdown/figures/enviro_topics_25yr_2000.jpg",w =9, h=14, units = "in") #h=11,

```

##### enviro speech topics per 20-yr period:
```{r enviro topics per 20-yr period r}

##### 1880 #####
enviroBigrams_1880_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  filter(period==1880) %>%
  cast_dtm(document,term,count)

enviroBigrams_1880_lda <- LDA(enviroBigrams_1880_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1880_topics <- tidy(enviroBigrams_1880_lda, matrix = "beta")

enviroBigrams_1880_top_terms <- enviroBigrams_1880_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1880_top_terms <- enviroBigrams_1880_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1880_top_terms

ggsave("congress_bookdown/figures/enviro_topics_20yr_1880.jpg",w =9, h=14, units = "in") #h=11,




##### 1900 #####
enviroBigrams_1900_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  filter(period==1900) %>%
  cast_dtm(document,term,count)

enviroBigrams_1900_lda <- LDA(enviroBigrams_1900_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1900_topics <- tidy(enviroBigrams_1900_lda, matrix = "beta")

enviroBigrams_1900_top_terms <- enviroBigrams_1900_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1900_top_terms <- enviroBigrams_1900_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1900_top_terms

ggsave("congress_bookdown/figures/enviro_topics_20yr_1900.jpg",w =9, h=14, units = "in") #h=11,




##### 1920 #####
enviroBigrams_1920_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  filter(period==1920) %>%
  cast_dtm(document,term,count)

enviroBigrams_1920_lda <- LDA(enviroBigrams_1920_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1920_topics <- tidy(enviroBigrams_1920_lda, matrix = "beta")

enviroBigrams_1920_top_terms <- enviroBigrams_1920_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1920_top_terms <- enviroBigrams_1920_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1920_top_terms

ggsave("congress_bookdown/figures/enviro_topics_20yr_1920.jpg",w =9, h=14, units = "in") #h=11,




##### 1940 #####
enviroBigrams_1940_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  filter(period==1940) %>%
  cast_dtm(document,term,count)

enviroBigrams_1940_lda <- LDA(enviroBigrams_1940_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1940_topics <- tidy(enviroBigrams_1940_lda, matrix = "beta")

enviroBigrams_1940_top_terms <- enviroBigrams_1940_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1940_top_terms <- enviroBigrams_1940_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1940_top_terms

ggsave("congress_bookdown/figures/enviro_topics_20yr_1940.jpg",w =9, h=14, units = "in") #h=11,



##### 1960 #####
enviroBigrams_1960_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  filter(period==1960) %>%
  cast_dtm(document,term,count)

enviroBigrams_1960_lda <- LDA(enviroBigrams_1960_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1960_topics <- tidy(enviroBigrams_1960_lda, matrix = "beta")

enviroBigrams_1960_top_terms <- enviroBigrams_1960_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1960_top_terms <- enviroBigrams_1960_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1960_top_terms

ggsave("congress_bookdown/figures/enviro_topics_20yr_1960.jpg",w =9, h=14, units = "in") #h=11,



##### 1980 #####
enviroBigrams_1980_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  filter(period==1980) %>%
  cast_dtm(document,term,count)

enviroBigrams_1980_lda <- LDA(enviroBigrams_1980_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1980_topics <- tidy(enviroBigrams_1980_lda, matrix = "beta")

enviroBigrams_1980_top_terms <- enviroBigrams_1980_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1980_top_terms <- enviroBigrams_1980_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1980_top_terms

ggsave("congress_bookdown/figures/enviro_topics_20yr_1980.jpg",w =9, h=14, units = "in") #h=11,



##### 2000 #####
enviroBigrams_2000_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 20) %>%
  filter(period==2000) %>%
  cast_dtm(document,term,count)

enviroBigrams_2000_lda <- LDA(enviroBigrams_2000_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_2000_topics <- tidy(enviroBigrams_2000_lda, matrix = "beta")

enviroBigrams_2000_top_terms <- enviroBigrams_2000_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_2000_top_terms <- enviroBigrams_2000_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_2000_top_terms

ggsave("congress_bookdown/figures/enviro_topics_20yr_2000.jpg",w =9, h=14, units = "in") #h=11,


```

##### enviro speech topics per 15-yr period:
```{r enviro topics per 15-yr period r}

##### 1875 #####
enviroBigrams_1875_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1875) %>%
  cast_dtm(document,term,count)

enviroBigrams_1875_lda <- LDA(enviroBigrams_1875_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1875_topics <- tidy(enviroBigrams_1875_lda, matrix = "beta")

enviroBigrams_1875_top_terms <- enviroBigrams_1875_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1875_top_terms <- enviroBigrams_1875_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1875_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1875.jpg",w =9, h=14, units = "in") #h=11,



##### 1890 #####
enviroBigrams_1890_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1890) %>%
  cast_dtm(document,term,count)

enviroBigrams_1890_lda <- LDA(enviroBigrams_1890_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1890_topics <- tidy(enviroBigrams_1890_lda, matrix = "beta")

enviroBigrams_1890_top_terms <- enviroBigrams_1890_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1890_top_terms <- enviroBigrams_1890_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1890_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1890.jpg",w =9, h=14, units = "in") #h=11,


##### 1905 #####
enviroBigrams_1905_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1905) %>%
  cast_dtm(document,term,count)

enviroBigrams_1905_lda <- LDA(enviroBigrams_1905_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1905_topics <- tidy(enviroBigrams_1905_lda, matrix = "beta")

enviroBigrams_1905_top_terms <- enviroBigrams_1905_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1905_top_terms <- enviroBigrams_1905_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1905_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1905.jpg",w =9, h=14, units = "in") #h=11,


##### 1920 #####
enviroBigrams_1920_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1920) %>%
  cast_dtm(document,term,count)

enviroBigrams_1920_lda <- LDA(enviroBigrams_1920_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1920_topics <- tidy(enviroBigrams_1920_lda, matrix = "beta")

enviroBigrams_1920_top_terms <- enviroBigrams_1920_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1920_top_terms <- enviroBigrams_1920_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1920_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1920.jpg",w =9, h=14, units = "in") #h=11,


##### 1935 #####
enviroBigrams_1935_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1935) %>%
  cast_dtm(document,term,count)

enviroBigrams_1935_lda <- LDA(enviroBigrams_1935_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1935_topics <- tidy(enviroBigrams_1935_lda, matrix = "beta")

enviroBigrams_1935_top_terms <- enviroBigrams_1935_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1935_top_terms <- enviroBigrams_1935_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1935_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1935.jpg",w =9, h=14, units = "in") #h=11,


##### 1950 #####
enviroBigrams_1950_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1950) %>%
  cast_dtm(document,term,count)

enviroBigrams_1950_lda <- LDA(enviroBigrams_1950_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1950_topics <- tidy(enviroBigrams_1950_lda, matrix = "beta")

enviroBigrams_1950_top_terms <- enviroBigrams_1950_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1950_top_terms <- enviroBigrams_1950_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1950_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1950.jpg",w =9, h=14, units = "in") #h=11,



##### 1965 #####
enviroBigrams_1965_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1965) %>%
  cast_dtm(document,term,count)

enviroBigrams_1965_lda <- LDA(enviroBigrams_1965_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1965_topics <- tidy(enviroBigrams_1965_lda, matrix = "beta")

enviroBigrams_1965_top_terms <- enviroBigrams_1965_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1965_top_terms <- enviroBigrams_1965_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1965_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1965.jpg",w =9, h=14, units = "in") #h=11,



##### 1980 #####
enviroBigrams_1980_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1980) %>%
  cast_dtm(document,term,count)

enviroBigrams_1980_lda <- LDA(enviroBigrams_1980_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1980_topics <- tidy(enviroBigrams_1980_lda, matrix = "beta")

enviroBigrams_1980_top_terms <- enviroBigrams_1980_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1980_top_terms <- enviroBigrams_1980_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1980_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1980.jpg",w =9, h=14, units = "in") #h=11,



##### 1995 #####
enviroBigrams_1995_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1995) %>%
  cast_dtm(document,term,count)

enviroBigrams_1995_lda <- LDA(enviroBigrams_1995_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1995_topics <- tidy(enviroBigrams_1995_lda, matrix = "beta")

enviroBigrams_1995_top_terms <- enviroBigrams_1995_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1995_top_terms <- enviroBigrams_1995_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1995_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_1995.jpg",w =9, h=14, units = "in") #h=11,



##### 2010 #####
enviroBigrams_2010_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==2010) %>%
  cast_dtm(document,term,count)

enviroBigrams_2010_lda <- LDA(enviroBigrams_2010_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_2010_topics <- tidy(enviroBigrams_2010_lda, matrix = "beta")

enviroBigrams_2010_top_terms <- enviroBigrams_2010_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_2010_top_terms <- enviroBigrams_2010_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_2010_top_terms

ggsave("congress_bookdown/figures/enviro_topics_15yr_2010.jpg",w =9, h=14, units = "in") #h=11,


```

##### enviro speech topics per 10-yr period:
```{r enviro topics per 10-yr period r}

##### 1880 #####
enviroBigrams_1880_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1880) %>%
  cast_dtm(document,term,count)

enviroBigrams_1880_lda <- LDA(enviroBigrams_1880_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1880_topics <- tidy(enviroBigrams_1880_lda, matrix = "beta")

enviroBigrams_1880_top_terms <- enviroBigrams_1880_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1880_top_terms <- enviroBigrams_1880_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1880_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1880.jpg",w =9, h=14, units = "in") #h=11,



##### 1890 #####
enviroBigrams_1890_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1890) %>%
  cast_dtm(document,term,count)

enviroBigrams_1890_lda <- LDA(enviroBigrams_1890_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1890_topics <- tidy(enviroBigrams_1890_lda, matrix = "beta")

enviroBigrams_1890_top_terms <- enviroBigrams_1890_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1890_top_terms <- enviroBigrams_1890_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1890_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1890.jpg",w =9, h=14, units = "in") #h=11,


##### 1900 #####
enviroBigrams_1900_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1900) %>%
  cast_dtm(document,term,count)

enviroBigrams_1900_lda <- LDA(enviroBigrams_1900_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1900_topics <- tidy(enviroBigrams_1900_lda, matrix = "beta")

enviroBigrams_1900_top_terms <- enviroBigrams_1900_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1900_top_terms <- enviroBigrams_1900_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1900_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1900.jpg",w =9, h=14, units = "in") #h=11,


##### 1910 #####
enviroBigrams_1910_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1910) %>%
  cast_dtm(document,term,count)

enviroBigrams_1910_lda <- LDA(enviroBigrams_1910_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1910_topics <- tidy(enviroBigrams_1910_lda, matrix = "beta")

enviroBigrams_1910_top_terms <- enviroBigrams_1910_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1910_top_terms <- enviroBigrams_1910_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1910_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1910.jpg",w =9, h=14, units = "in") #h=11,



##### 1920 #####
enviroBigrams_1920_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1920) %>%
  cast_dtm(document,term,count)

enviroBigrams_1920_lda <- LDA(enviroBigrams_1920_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1920_topics <- tidy(enviroBigrams_1920_lda, matrix = "beta")

enviroBigrams_1920_top_terms <- enviroBigrams_1920_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1920_top_terms <- enviroBigrams_1920_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1920_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1920.jpg",w =9, h=14, units = "in") #h=11,



##### 1930 #####
enviroBigrams_1930_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1930) %>%
  cast_dtm(document,term,count)

enviroBigrams_1930_lda <- LDA(enviroBigrams_1930_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1930_topics <- tidy(enviroBigrams_1930_lda, matrix = "beta")

enviroBigrams_1930_top_terms <- enviroBigrams_1930_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1930_top_terms <- enviroBigrams_1930_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1930_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1930.jpg",w =9, h=14, units = "in") #h=11,



##### 1940 #####
enviroBigrams_1940_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1940) %>%
  cast_dtm(document,term,count)

enviroBigrams_1940_lda <- LDA(enviroBigrams_1940_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1940_topics <- tidy(enviroBigrams_1940_lda, matrix = "beta")

enviroBigrams_1940_top_terms <- enviroBigrams_1940_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1940_top_terms <- enviroBigrams_1940_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1940_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1940.jpg",w =9, h=14, units = "in") #h=11,


##### 1950 #####
enviroBigrams_1950_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1950) %>%
  cast_dtm(document,term,count)

enviroBigrams_1950_lda <- LDA(enviroBigrams_1950_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1950_topics <- tidy(enviroBigrams_1950_lda, matrix = "beta")

enviroBigrams_1950_top_terms <- enviroBigrams_1950_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1950_top_terms <- enviroBigrams_1950_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1950_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1950.jpg",w =9, h=14, units = "in") #h=11,



##### 1960 #####
enviroBigrams_1960_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1960) %>%
  cast_dtm(document,term,count)

enviroBigrams_1960_lda <- LDA(enviroBigrams_1960_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1960_topics <- tidy(enviroBigrams_1960_lda, matrix = "beta")

enviroBigrams_1960_top_terms <- enviroBigrams_1960_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1960_top_terms <- enviroBigrams_1960_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1960_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1960.jpg",w =9, h=14, units = "in") #h=11,


##### 1970 #####
enviroBigrams_1970_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1970) %>%
  cast_dtm(document,term,count)

enviroBigrams_1970_lda <- LDA(enviroBigrams_1970_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1970_topics <- tidy(enviroBigrams_1970_lda, matrix = "beta")

enviroBigrams_1970_top_terms <- enviroBigrams_1970_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1970_top_terms <- enviroBigrams_1970_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1970_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1970.jpg",w =9, h=14, units = "in") #h=11,


##### 1980 #####
enviroBigrams_1980_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1980) %>%
  cast_dtm(document,term,count)

enviroBigrams_1980_lda <- LDA(enviroBigrams_1980_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1980_topics <- tidy(enviroBigrams_1980_lda, matrix = "beta")

enviroBigrams_1980_top_terms <- enviroBigrams_1980_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1980_top_terms <- enviroBigrams_1980_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1980_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1980.jpg",w =9, h=14, units = "in") #h=11,



##### 1990 #####
enviroBigrams_1990_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1990) %>%
  cast_dtm(document,term,count)

enviroBigrams_1990_lda <- LDA(enviroBigrams_1990_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_1990_topics <- tidy(enviroBigrams_1990_lda, matrix = "beta")

enviroBigrams_1990_top_terms <- enviroBigrams_1990_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_1990_top_terms <- enviroBigrams_1990_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_1990_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_1990.jpg",w =9, h=14, units = "in") #h=11,



##### 2000 #####
enviroBigrams_2000_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2000) %>%
  cast_dtm(document,term,count)

enviroBigrams_2000_lda <- LDA(enviroBigrams_2000_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_2000_topics <- tidy(enviroBigrams_2000_lda, matrix = "beta")

enviroBigrams_2000_top_terms <- enviroBigrams_2000_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_2000_top_terms <- enviroBigrams_2000_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_2000_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_2000.jpg",w =9, h=14, units = "in") #h=11,



##### 2010 #####
enviroBigrams_2010_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2010) %>%
  cast_dtm(document,term,count)

enviroBigrams_2010_lda <- LDA(enviroBigrams_2010_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_2010_topics <- tidy(enviroBigrams_2010_lda, matrix = "beta")

enviroBigrams_2010_top_terms <- enviroBigrams_2010_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_2010_top_terms <- enviroBigrams_2010_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_2010_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_2010.jpg",w =9, h=14, units = "in") #h=11,



##### 2020 #####
enviroBigrams_2020_dtm <- enviroBigrams %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2020) %>%
  cast_dtm(document,term,count)

enviroBigrams_2020_lda <- LDA(enviroBigrams_2020_dtm, k = 8, control = list(seed = 1234))

enviroBigrams_2020_topics <- tidy(enviroBigrams_2020_lda, matrix = "beta")

enviroBigrams_2020_top_terms <- enviroBigrams_2020_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroBigrams_2020_top_terms <- enviroBigrams_2020_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term)) +
  geom_col(fill="aquamarine4",
           show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free", ncol=2) +
  scale_y_reordered() +
  theme_minimal() +
  theme(#aspect.ratio=8/11,
    plot.title=element_text(family="IBM Plex Mono",color="#32127a",hjust=0.5,size=12,face="bold"),
    axis.title=element_text(family="IBM Plex Mono",color="#32127a"),
    axis.text=element_text(family="IBM Plex Mono",color="#32127a"),#,size=10),
    axis.line=element_line(color="#32127a"),
    axis.ticks=element_line(color="#32127a"),
    strip.text=element_text(family="IBM Plex Mono",color="#32127a",face="bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
graph_enviroBigrams_2020_top_terms

ggsave("congress_bookdown/figures/enviro_topics_10yr_2020.jpg",w =9, h=14, units = "in") #h=11,

```


#### LABOR 

#### ENVIRO-LABOR


### ANALYSIS: co-occurrence networks

#### ENVIRO

##### token co-occurrence with labor keywords

```{r SET-UP co-occurrence with labor keywords, include=FALSE}

laborVocab_simple <- c("^labor$",
                       "^worker$",
                       "^job$",
                       "^wage$")

laborVocabString_simple <- laborVocab_simple %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")

laborBigramVocab_simple <- c("^labor_","_labor$",
                       "^worker_","_worker$",
                       "^job_","_job$",
                       "^wage_","_wage$")

laborBigramVocabString_simple <- laborBigramVocab_simple %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")

```

##### top co-occurring tokens with labor keywords per 25-yr period:
```{r enviro token co-occurence with labor per 25-yr period}


#### 1875
enviroTokens_wordPairs_corr_25yr_1875 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1875) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_25yr_1875_labor <- enviroTokens_wordPairs_corr_25yr_1875 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_25yr_1875_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_25yr_1875_labor.jpg") #h=11,



#### 1900
enviroTokens_wordPairs_corr_25yr_1900 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1900) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_25yr_1900_labor <- enviroTokens_wordPairs_corr_25yr_1900 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_25yr_1900_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_25yr_1900_labor.jpg") #h=11,



#### 1925
enviroTokens_wordPairs_corr_25yr_1925 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1925) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_25yr_1925_labor <- enviroTokens_wordPairs_corr_25yr_1925 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_25yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_25yr_1925_labor.jpg") #h=11,



#### 1950
enviroTokens_wordPairs_corr_25yr_1950 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1950) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_25yr_1950_labor <- enviroTokens_wordPairs_corr_25yr_1950 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_25yr_1950_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_25yr_1950_labor.jpg") #h=11,



#### 1975
enviroTokens_wordPairs_corr_25yr_1975 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1975) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_25yr_1975_labor <- enviroTokens_wordPairs_corr_25yr_1975 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_25yr_1975_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_25yr_1975_labor.jpg") #h=11,




#### 2000
enviroTokens_wordPairs_corr_25yr_2000 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_25yr_2000_labor <- enviroTokens_wordPairs_corr_25yr_2000 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_25yr_2000_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_25yr_2000_labor.jpg") #h=11,



```

##### top co-occurring tokens with labor keywords per 10-yr period:
```{r enviro token co-occurence with labor per 10-yr period}


#### 1900
enviroTokens_wordPairs_corr_10yr_1900 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1900) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1900_labor <- enviroTokens_wordPairs_corr_10yr_1900 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1900_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1900_labor.jpg") #h=11,



#### 1910
enviroTokens_wordPairs_corr_10yr_1910 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1910) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1910_labor <- enviroTokens_wordPairs_corr_10yr_1910 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1910_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1910_labor.jpg") #h=11,



#### 1920
enviroTokens_wordPairs_corr_10yr_1920 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1920) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1920_labor <- enviroTokens_wordPairs_corr_10yr_1920 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1920_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1920_labor.jpg") #h=11,



#### 1930
enviroTokens_wordPairs_corr_10yr_1930 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1930) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1930_labor <- enviroTokens_wordPairs_corr_10yr_1930 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1930_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1930_labor.jpg") #h=11,



#### 1940
enviroTokens_wordPairs_corr_10yr_1940 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1940) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1940_labor <- enviroTokens_wordPairs_corr_10yr_1940 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1940_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1940_labor.jpg") #h=11,



#### 1950
enviroTokens_wordPairs_corr_10yr_1950 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1950) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1950_labor <- enviroTokens_wordPairs_corr_10yr_1950 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1950_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1950_labor.jpg") #h=11,




#### 1960
enviroTokens_wordPairs_corr_10yr_1960 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1960) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1960_labor <- enviroTokens_wordPairs_corr_10yr_1960 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1960_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1960_labor.jpg") #h=11,




#### 1970
enviroTokens_wordPairs_corr_10yr_1970 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1970) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1970_labor <- enviroTokens_wordPairs_corr_10yr_1970 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1970_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1970_labor.jpg") #h=11,



#### 1980
enviroTokens_wordPairs_corr_10yr_1980 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1980_labor <- enviroTokens_wordPairs_corr_10yr_1980 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1980_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1980_labor.jpg") #h=11,




#### 1990
enviroTokens_wordPairs_corr_10yr_1990 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1990) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_1990_labor <- enviroTokens_wordPairs_corr_10yr_1990 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_1990_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_1990_labor.jpg") #h=11,



#### 2000
enviroTokens_wordPairs_corr_10yr_2000 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_2000_labor <- enviroTokens_wordPairs_corr_10yr_2000 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2000_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_2000_labor.jpg") #h=11,



#### 2010
enviroTokens_wordPairs_corr_10yr_2010 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_2010_labor <- enviroTokens_wordPairs_corr_10yr_2010 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2010_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_2010_labor.jpg") #h=11,



#### 2020
enviroTokens_wordPairs_corr_10yr_2020 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2020) %>%
  group_by(term) %>%
  filter(n() >= 10) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_10yr_2020_labor <- enviroTokens_wordPairs_corr_10yr_2020 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_10yr_2020_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_10yr_2020_labor.jpg") #h=11,


```

##### bigram co-occurrence with labor keywords

##### top co-occurring bigrams with labor keywords per 25-yr period:
```{r enviro bigram co-occurence with labor per 25-yr period}


#### 1875
enviroBigrams_wordPairs_corr_25yr_1875 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1875) %>%
  group_by(term) %>%
  filter(n() >= 100) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_25yr_1875_labor <- enviroBigrams_wordPairs_corr_25yr_1875 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_25yr_1875_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_25yr_1875_labor.jpg") #h=11,



#### 1900
enviroBigrams_wordPairs_corr_25yr_1900 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1900) %>%
  group_by(term) %>%
  filter(n() >= 100) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_25yr_1900_labor <- enviroBigrams_wordPairs_corr_25yr_1900 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_25yr_1900_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_25yr_1900_labor.jpg") #h=11,



#### 1925
enviroBigrams_wordPairs_corr_25yr_1925 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1925) %>%
  group_by(term) %>%
  filter(n() >= 100) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_25yr_1925_labor <- enviroBigrams_wordPairs_corr_25yr_1925 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_25yr_1925_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_25yr_1925_labor.jpg") #h=11,



#### 1950
enviroBigrams_wordPairs_corr_25yr_1950 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1950) %>%
  group_by(term) %>%
  filter(n() >= 100) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_25yr_1950_labor <- enviroBigrams_wordPairs_corr_25yr_1950 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_25yr_1950_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_25yr_1950_labor.jpg") #h=11,



#### 1975
enviroBigrams_wordPairs_corr_25yr_1975 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==1975) %>%
  group_by(term) %>%
  filter(n() >= 100) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_25yr_1975_labor <- enviroBigrams_wordPairs_corr_25yr_1975 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_25yr_1975_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_25yr_1975_labor.jpg") #h=11,




#### 2000
enviroBigrams_wordPairs_corr_25yr_2000 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 25) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 100) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_25yr_2000_labor <- enviroBigrams_wordPairs_corr_25yr_2000 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_25yr_2000_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_25yr_2000_labor.jpg") #h=11,



```

##### top co-occurring bigrams with labor keywords per 10-yr period:
```{r enviro bigram co-occurence with labor per 10-yr period}


#### 1900
enviroBigrams_wordPairs_corr_10yr_1900 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1900) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1900_labor <- enviroBigrams_wordPairs_corr_10yr_1900 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1900_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1900_labor.jpg") #h=11,



#### 1910
enviroBigrams_wordPairs_corr_10yr_1910 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1910) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1910_labor <- enviroBigrams_wordPairs_corr_10yr_1910 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1910_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1910_labor.jpg") #h=11,



#### 1920
enviroBigrams_wordPairs_corr_10yr_1920 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1920) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1920_labor <- enviroBigrams_wordPairs_corr_10yr_1920 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1920_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1920_labor.jpg") #h=11,



#### 1930
enviroBigrams_wordPairs_corr_10yr_1930 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1930) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1930_labor <- enviroBigrams_wordPairs_corr_10yr_1930 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1930_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1930_labor.jpg") #h=11,



#### 1940
enviroBigrams_wordPairs_corr_10yr_1940 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1940) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1940_labor <- enviroBigrams_wordPairs_corr_10yr_1940 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1940_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1940_labor.jpg") #h=11,



#### 1950
enviroBigrams_wordPairs_corr_10yr_1950 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1950) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1950_labor <- enviroBigrams_wordPairs_corr_10yr_1950 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1950_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1950_labor.jpg") #h=11,




#### 1960
enviroBigrams_wordPairs_corr_10yr_1960 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1960) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1960_labor <- enviroBigrams_wordPairs_corr_10yr_1960 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1960_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1960_labor.jpg") #h=11,




#### 1970
enviroBigrams_wordPairs_corr_10yr_1970 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1970) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1970_labor <- enviroBigrams_wordPairs_corr_10yr_1970 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1970_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1970_labor.jpg") #h=11,



#### 1980
enviroBigrams_wordPairs_corr_10yr_1980 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1980_labor <- enviroBigrams_wordPairs_corr_10yr_1980 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1980_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1980_labor.jpg") #h=11,




#### 1990
enviroBigrams_wordPairs_corr_10yr_1990 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==1990) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_1990_labor <- enviroBigrams_wordPairs_corr_10yr_1990 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_1990_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_1990_labor.jpg") #h=11,



#### 2000
enviroBigrams_wordPairs_corr_10yr_2000 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_2000_labor <- enviroBigrams_wordPairs_corr_10yr_2000 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_2000_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_2000_labor.jpg") #h=11,



#### 2010
enviroBigrams_wordPairs_corr_10yr_2010 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 50) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_2010_labor <- enviroBigrams_wordPairs_corr_10yr_2010 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_2010_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_2010_labor.jpg") #h=11,



#### 2020
enviroBigrams_wordPairs_corr_10yr_2020 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 10) %>%
  filter(period==2020) %>%
  group_by(term) %>%
  filter(n() >= 25) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_10yr_2020_labor <- enviroBigrams_wordPairs_corr_10yr_2020 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=85) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_10yr_2020_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_10yr_2020_labor.jpg") #h=11,


```


#### LABOR

```{r SET-UP co-occurrence with enviro keywords, include=FALSE}
enviroVocab_simple <- c("^enviro",
                        "^ecolog",
                        "^ecosyst",
                        "^conserv",
                        "^reclam",
                        "^pollut",
                        "^wildlife",
                        "^wilderness")
                 
#### keyword string
enviroVocabString_simple <- enviroVocab_simple %>%
  paste(collapse = "|") %>%
  str_replace_all(" ","[:blank:]")
```













## ARCHIVE

ENVIRO

```{r enviro token co-occurence per 5-yr period}

# #### 1965
# enviroTokens_wordPairs_corr_5yr_1965 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1965) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1965 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1965.jpg") #h=11,
# 
# 
# 
# #### 1970
# enviroTokens_wordPairs_corr_5yr_1970 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1970) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1970 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1970.jpg") #h=11,
# 
# 
# 
# #### 1975
# enviroTokens_wordPairs_corr_5yr_1975 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1975) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1975 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1975.jpg") #h=11,
# 
# 
# #### 1980
# enviroTokens_wordPairs_corr_5yr_1980 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1980) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1980 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1980.jpg") #h=11,
# 
# 
# #### 1985
# enviroTokens_wordPairs_corr_5yr_1985 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1985) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1985 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1985.jpg") #h=11,
# 
# 
# #### 1990
# enviroTokens_wordPairs_corr_5yr_1990 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1990) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1990 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1990.jpg") #h=11,
# 
# 
# #### 1995
# enviroTokens_wordPairs_corr_5yr_1995 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1995) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1995 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1995.jpg") #h=11,
# 
# 
# #### 2000
# enviroTokens_wordPairs_corr_5yr_2000 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2000) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2000 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2000.jpg") #h=11,
# 
# 
# #### 2005
# enviroTokens_wordPairs_corr_5yr_2005 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2005) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2005 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2005.jpg") #h=11,
# 
# 
# #### 2010
# enviroTokens_wordPairs_corr_5yr_2010 <- enviroTokens %>%
#   select(document,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2010) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,document,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(20)
# enviroTokens_wordPairs_corr_5yr_2010 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2010.jpg") #h=11,
# 
# 
# #### 2015
# enviroTokens_wordPairs_corr_5yr_2015 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2015) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2015 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2015.jpg") #h=11,
# 
# 
# #### 2020
# enviroTokens_wordPairs_corr_5yr_2020 <- enviroTokens %>%
#   select(document,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2020) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,document,sort=TRUE) %>%
#   filter(correlation!=Inf)
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2020 %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=100) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2020.jpg") #h=11,
```

```{r enviro 5-yr co-occurence}
# 
# #### 1965
# enviroTokens_wordPairs_corr_5yr_1965 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1965) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_1965_labor <- enviroTokens_wordPairs_corr_5yr_1965 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1965_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1965_labor.jpg") #h=11,
# 
# 
# #### 1970
# enviroTokens_wordPairs_corr_5yr_1970 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1970) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_1970_labor <- enviroTokens_wordPairs_corr_5yr_1970 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1970_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1970_labor.jpg") #h=11,
# 
# 
# #### 1975
# enviroTokens_wordPairs_corr_5yr_1975 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1975) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_1975_labor <- enviroTokens_wordPairs_corr_5yr_1975 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1975_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1975_labor.jpg") #h=11,
# 
# 
# #### 1980
# enviroTokens_wordPairs_corr_5yr_1980 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1980) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_1980_labor <- enviroTokens_wordPairs_corr_5yr_1980 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1980_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1980_labor.jpg") #h=11,
# 
# 
# #### 1985
# enviroTokens_wordPairs_corr_5yr_1985 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1985) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_1985_labor <- enviroTokens_wordPairs_corr_5yr_1985 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1985_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1985_labor.jpg") #h=11,
# 
# #### 1990
# enviroTokens_wordPairs_corr_5yr_1990 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1990) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_1990_labor <- enviroTokens_wordPairs_corr_5yr_1990 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1990_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1990_labor.jpg") #h=11,
# 
# 
# #### 1995
# enviroTokens_wordPairs_corr_5yr_1995 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==1995) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_1995_labor <- enviroTokens_wordPairs_corr_5yr_1995 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_1995_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_1995_labor.jpg") #h=11,
# 
# 
# #### 2000
# enviroTokens_wordPairs_corr_5yr_2000 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2000) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_2000_labor <- enviroTokens_wordPairs_corr_5yr_2000 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2000_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2000_labor.jpg") #h=11,
# 
# 
# #### 2005
# enviroTokens_wordPairs_corr_5yr_2005 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2005) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_2005_labor <- enviroTokens_wordPairs_corr_5yr_2005 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2005_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2005_labor.jpg") #h=11,
# 
# 
# #### 2010
# enviroTokens_wordPairs_corr_5yr_2010 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2010) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_2010_labor <- enviroTokens_wordPairs_corr_5yr_2010 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2010_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2010_labor.jpg") #h=11,
# 
# 
# #### 2015
# enviroTokens_wordPairs_corr_5yr_2015 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2015) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_2015_labor <- enviroTokens_wordPairs_corr_5yr_2015 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2015_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2015_labor.jpg") #h=11,
# 
# 
# #### 2020
# enviroTokens_wordPairs_corr_5yr_2020 <- enviroTokens %>%
#   select(speech_id,term,count,year) %>%
#   mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
#   filter(period==2020) %>%
#   group_by(term) %>%
#   filter(n() >= 20) %>%
#   pairwise_cor(term,speech_id,sort=TRUE)
# 
# enviroTokens_wordPairs_corr_5yr_2020_labor <- enviroTokens_wordPairs_corr_5yr_2020 %>%
#   # filter(item1 %in% c("labor"))
#   filter(item1 %in% c("labor","worker","job"))
# 
# set.seed(2016)
# enviroTokens_wordPairs_corr_5yr_2020_labor %>%
#   filter(correlation < .95) %>%
#   slice_max(correlation,n=50) %>%
#   graph_from_data_frame() %>%
#   ggraph(layout = "fr") +
#   geom_edge_link(aes(edge_alpha=correlation), 
#                  edge_color="#32127a",
#                  show.legend=TRUE) +
#   geom_node_point(color="aquamarine4", size=3.5) +
#   geom_node_text(aes(label=name), 
#                  color="#32127a",
#                  family="IBM Plex Mono",
#                  size=3,
#                  repel = TRUE) +
#   theme_void() + 
#   theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
#         legend.title=element_text(family="IBM Plex Mono",color="#32127a"))
# 
# ggsave("congress_bookdown/figures/enviroTokens_wordPairs_corr_5yr_2020_labor.jpg") #h=11,
```

```{r enviro bigram co-occurence per 5-yr period}

#### 1965
enviroBigrams_wordPairs_corr_5yr_1965 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_1965 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_1965.jpg") #h=11,


#### 1970
enviroBigrams_wordPairs_corr_5yr_1970 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1970) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)


set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_1970 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_1970.jpg") #h=11,



#### 1975
enviroBigrams_wordPairs_corr_5yr_1975 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1975) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_1975 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_1975.jpg") #h=11,


#### 1980
enviroBigrams_wordPairs_corr_5yr_1980 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_1980 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_1980.jpg") #h=11,


#### 1985
enviroBigrams_wordPairs_corr_5yr_1985 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1985) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_1985 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_1985.jpg") #h=11,


#### 1990
enviroBigrams_wordPairs_corr_5yr_1990 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1990) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_1990 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_1990.jpg") #h=11,


#### 1995
enviroBigrams_wordPairs_corr_5yr_1995 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_1995 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_1995.jpg") #h=11,


#### 2000
enviroBigrams_wordPairs_corr_5yr_2000 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_2000 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_2000.jpg") #h=11,


#### 2005
enviroBigrams_wordPairs_corr_5yr_2005 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2005) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_2005 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_2005.jpg") #h=11,


#### 2010
enviroBigrams_wordPairs_corr_5yr_2010 <- enviroBigrams %>%
  select(document,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,document,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_2010 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_2010.jpg") #h=11,


#### 2015
enviroBigrams_wordPairs_corr_5yr_2015 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2015) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_2015 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_2015.jpg") #h=11,


#### 2020
enviroBigrams_wordPairs_corr_5yr_2020 <- enviroBigrams %>%
  select(document,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2020) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,document,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroBigrams_wordPairs_corr_5yr_2020 %>%
  filter(correlation < .95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("congress_bookdown/figures/enviroBigrams_wordPairs_corr_5yr_2020.jpg") #h=11,
```


ENVIRO-LABOR
```{r enviroLabor token co-occurence per 15-yr period}

enviroLaborTokens_wordPairs_corr_1965 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_1965 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_1965.jpg") #h=11,


enviroLaborTokens_wordPairs_corr_1980 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_1980 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_1980.jpg") #h=11,


enviroLaborTokens_wordPairs_corr_1995 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_1995 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_1995.jpg") #h=11,

enviroLaborTokens_wordPairs_corr_2010 <- enviroLaborTokens %>%
  select(document,term,count,year,date) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,date,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_2010 %>%
  # filter(correlation <=0.8 & correlation > .45) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_2010.jpg") #h=11,
```

```{r enviroLabor token co-occurence per 5-yr period}

#### 1965
enviroLaborTokens_wordPairs_corr_5yr_1965 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1965 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_1965.jpg") #h=11,


#### 1970
enviroLaborTokens_wordPairs_corr_5yr_1970 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1970) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1970 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_1970.jpg") #h=11,

#### 1975
enviroLaborTokens_wordPairs_corr_5yr_1975 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1975) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1975 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_1975.jpg") #h=11,


#### 1980
enviroLaborTokens_wordPairs_corr_5yr_1980 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1980 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_1980.jpg") #h=11,


#### 1985
enviroLaborTokens_wordPairs_corr_5yr_1985 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1985) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1985 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_1985.jpg") #h=11,


#### 1990
enviroLaborTokens_wordPairs_corr_5yr_1990 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1990) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1990 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_1990.jpg") #h=11,


#### 1995
enviroLaborTokens_wordPairs_corr_5yr_1995 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_1995 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_1995.jpg") #h=11,


#### 2000
enviroLaborTokens_wordPairs_corr_5yr_2000 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2000 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_2000.jpg") #h=11,

#### 2005
enviroLaborTokens_wordPairs_corr_5yr_2005 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2005) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2005 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_2005.jpg") #h=11,


#### 2010
enviroLaborTokens_wordPairs_corr_5yr_2010 <- enviroLaborTokens %>%
  select(document,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,document,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(20)
enviroLaborTokens_wordPairs_corr_5yr_2010 %>%
  # filter(correlation <=0.8 & correlation > .45) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_2010.jpg") #h=11,


#### 2015
enviroLaborTokens_wordPairs_corr_5yr_2015 <- enviroLaborTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2015) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2015 %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_2015.jpg") #h=11,


#### 2020
enviroLaborTokens_wordPairs_corr_5yr_2020 <- enviroLaborTokens %>%
  select(document,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2020) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,document,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborTokens_wordPairs_corr_5yr_2020 %>%
  # filter(correlation <=0.8 & correlation > .45) %>%
  slice_max(correlation,n=100) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborTokens_wordPairs_corr_5yr_2020.jpg") #h=11,
```

```{r enviroLabor bigram co-occurence per 15-yr period}

enviroLaborBigrams_wordPairs_corr_1965 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_1965 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_1965.jpg") #h=11,


enviroLaborBigrams_wordPairs_corr_1980 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_1980 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_1980.jpg") #h=11,


enviroLaborBigrams_wordPairs_corr_1995 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_1995 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_1995.jpg") #h=11,

enviroLaborBigrams_wordPairs_corr_2010 <- enviroLaborBigrams %>%
  select(document,term,count,year,date) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,date,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_2010 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_2010.jpg") #h=11,
```

```{r enviroLabor bigram co-occurence per 5-yr period}

#### 1965
enviroLaborBigrams_wordPairs_corr_5yr_1965 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_1965 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_1965.jpg") #h=11,


#### 1970
enviroLaborBigrams_wordPairs_corr_5yr_1970 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1970) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_1970 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_1970.jpg") #h=11,

#### 1975
enviroLaborBigrams_wordPairs_corr_5yr_1975 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1975) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_1975 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_1975.jpg") #h=11,


#### 1980
enviroLaborBigrams_wordPairs_corr_5yr_1980 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_1980 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_1980.jpg") #h=11,


#### 1985
enviroLaborBigrams_wordPairs_corr_5yr_1985 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1985) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_1985 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_1985.jpg") #h=11,


#### 1990
enviroLaborBigrams_wordPairs_corr_5yr_1990 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1990) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_1990 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_1990.jpg") #h=11,


#### 1995
enviroLaborBigrams_wordPairs_corr_5yr_1995 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_1995 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_1995.jpg") #h=11,


#### 2000
enviroLaborBigrams_wordPairs_corr_5yr_2000 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_2000 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_2000.jpg") #h=11,

#### 2005
enviroLaborBigrams_wordPairs_corr_5yr_2005 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2005) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_2005 %>%
filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_2005.jpg") #h=11,


#### 2010
enviroLaborBigrams_wordPairs_corr_5yr_2010 <- enviroLaborBigrams %>%
  select(document,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,document,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_2010 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_2010.jpg") #h=11,


#### 2015
enviroLaborBigrams_wordPairs_corr_5yr_2015 <- enviroLaborBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2015) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,speech_id,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_2015 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_2015.jpg") #h=11,


#### 2020
enviroLaborBigrams_wordPairs_corr_5yr_2020 <- enviroLaborBigrams %>%
  select(document,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2020) %>%
  group_by(term) %>%
  filter(n() >= 5) %>%
  pairwise_cor(term,document,sort=TRUE) %>%
  filter(correlation!=Inf)

set.seed(2016)
enviroLaborBigrams_wordPairs_corr_5yr_2020 %>%
  filter(correlation < 0.95) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "blueviolet", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroLaborBigrams_wordPairs_corr_5yr_2020.jpg") #h=11,
```

ENVIRO
```{r enviro 15-yr co-occurence}

#### 1965
enviroTokens_wordPairs_corr_1965 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_1965_labor <- enviroTokens_wordPairs_corr_1965 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_1965_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_1965_labor.jpg") #h=11,


#### 1980
enviroTokens_wordPairs_corr_1980 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_1980_labor <- enviroTokens_wordPairs_corr_1980 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_1980_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_1980_labor.jpg") #h=11,




#### 1995
enviroTokens_wordPairs_corr_1995 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_1995_labor <- enviroTokens_wordPairs_corr_1995 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_1995_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_1995_labor.jpg") #h=11,


#### 2010
enviroTokens_wordPairs_corr_2010 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_2010_labor <- enviroTokens_wordPairs_corr_2010 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_2010_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_2010_labor.jpg") #h=11,


```

```{r enviro 5-yr co-occurence}

#### 1965
enviroTokens_wordPairs_corr_5yr_1965 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_1965_labor <- enviroTokens_wordPairs_corr_5yr_1965 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1965_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_1965_labor.jpg") #h=11,


#### 1970
enviroTokens_wordPairs_corr_5yr_1970 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1970) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_1970_labor <- enviroTokens_wordPairs_corr_5yr_1970 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1970_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_1970_labor.jpg") #h=11,

#### 1975
enviroTokens_wordPairs_corr_5yr_1975 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1975) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_1975_labor <- enviroTokens_wordPairs_corr_5yr_1975 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1975_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_1975_labor.jpg") #h=11,


#### 1980
enviroTokens_wordPairs_corr_5yr_1980 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_1980_labor <- enviroTokens_wordPairs_corr_5yr_1980 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1980_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_1980_labor.jpg") #h=11,


#### 1985
enviroTokens_wordPairs_corr_5yr_1985 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1985) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_1985_labor <- enviroTokens_wordPairs_corr_5yr_1985 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1985_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_1985_labor.jpg") #h=11,

#### 1990
enviroTokens_wordPairs_corr_5yr_1990 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1990) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_1990_labor <- enviroTokens_wordPairs_corr_5yr_1990 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1990_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_1990_labor.jpg") #h=11,


#### 1995
enviroTokens_wordPairs_corr_5yr_1995 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_1995_labor <- enviroTokens_wordPairs_corr_5yr_1995 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_1995_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_1995_labor.jpg") #h=11,


#### 2000
enviroTokens_wordPairs_corr_5yr_2000 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2000) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_2000_labor <- enviroTokens_wordPairs_corr_5yr_2000 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2000_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_2000_labor.jpg") #h=11,


#### 2005
enviroTokens_wordPairs_corr_5yr_2005 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2005) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_2005_labor <- enviroTokens_wordPairs_corr_5yr_2005 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2005_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_2005_labor.jpg") #h=11,


#### 2010
enviroTokens_wordPairs_corr_5yr_2010 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_2010_labor <- enviroTokens_wordPairs_corr_5yr_2010 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2010_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_2010_labor.jpg") #h=11,

#### 2015
enviroTokens_wordPairs_corr_5yr_2015 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2015) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_2015_labor <- enviroTokens_wordPairs_corr_5yr_2015 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2015_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_2015_labor.jpg") #h=11,


#### 2020
enviroTokens_wordPairs_corr_5yr_2020 <- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 5) %>%
  filter(period==2020) %>%
  group_by(term) %>%
  filter(n() >= 20) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_5yr_2020_labor <- enviroTokens_wordPairs_corr_5yr_2020 %>%
  # filter(item1 %in% c("labor"))
  filter(item1 %in% c("labor","worker","job"))

set.seed(2016)
enviroTokens_wordPairs_corr_5yr_2020_labor %>%
  # filter(correlation > .15) %>%
  slice_max(correlation,n=50) %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha = correlation), show.legend = FALSE) +
  geom_node_point(color = "aquamarine4", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void()
ggsave("figures/enviroTokens_wordPairs_corr_5yr_2020_labor.jpg") #h=11,
```


ANALYSIS: topic modeling

```{r enviroLabor topics per 15-yr period r}

##### 1965 #####
enviroLaborBigrams_1965_dtm <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  # select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1965) %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm()

enviroLaborBigrams_1965_lda <- LDA(enviroLaborBigrams_1965_dtm, k = 9, control = list(seed = 1234))

enviroLaborBigrams_1965_topics <- tidy(enviroLaborBigrams_1965_lda, matrix = "beta")

enviroLaborBigrams_1965_top_terms <- enviroLaborBigrams_1965_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroLaborBigrams_1965_top_terms <- enviroLaborBigrams_1965_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term, fill = factor(topic))) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free") +
  scale_y_reordered() +
  theme_minimal()

ggsave("figures/enviroLabor_topics_15yr_1965.jpg")



##### 1980 #####
enviroLaborBigrams_1980_dtm <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  # select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1980) %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm()

enviroLaborBigrams_1980_lda <- LDA(enviroLaborBigrams_1980_dtm, k = 9, control = list(seed = 1234))

enviroLaborBigrams_1980_topics <- tidy(enviroLaborBigrams_1980_lda, matrix = "beta")

enviroLaborBigrams_1980_top_terms <- enviroLaborBigrams_1980_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroLaborBigrams_1980_top_terms <- enviroLaborBigrams_1980_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term, fill = factor(topic))) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free") +
  scale_y_reordered() +
  theme_minimal()

ggsave("figures/enviroLabor_topics_15yr_1980.jpg")


##### 1995 #####
enviroLaborBigrams_1995_dtm <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  # select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1995) %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm()

enviroLaborBigrams_1995_lda <- LDA(enviroLaborBigrams_1995_dtm, k = 9, control = list(seed = 1234))

enviroLaborBigrams_1995_topics <- tidy(enviroLaborBigrams_1995_lda, matrix = "beta")

enviroLaborBigrams_1995_top_terms <- enviroLaborBigrams_1995_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroLaborBigrams_1995_top_terms <- enviroLaborBigrams_1995_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term, fill = factor(topic))) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free") +
  scale_y_reordered() +
  theme_minimal()

ggsave("figures/enviroLabor_topics_15yr_1995.jpg")


##### 2010 #####
enviroLaborBigrams_2010_dtm <- enviroLaborSpeeches %>%
  filter(environment=="Yes" & labor=="Yes") %>%
  # select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==2010) %>%
  corpus(docid_field="speech_id",
         text_field="speech") %>%
  tokenize_word_stems(stopwords=stopwords) %>%
  tokens(remove_punct=FALSE, #CREATE TOKEN OBJECT
         split_tags=TRUE,
         split_elisions=TRUE,
         remove_symbols=TRUE,
         remove_numbers=TRUE,
         remove_separators=TRUE,
         padding=FALSE,
         xptr=TRUE,
         verbose=TRUE) %>%
  tokens_remove("\\p{P}", valuetype = "regex", #REMOVE PUNCT
                padding=TRUE, #REPLACE W/ EMPTY STRINGS
                verbose=TRUE) %>%
  tokens_ngrams(n=2) %>% #CREATE BIGRAMS
  dfm()

enviroLaborBigrams_2010_lda <- LDA(enviroLaborBigrams_2010_dtm, k = 9, control = list(seed = 1234))

enviroLaborBigrams_2010_topics <- tidy(enviroLaborBigrams_2010_lda, matrix = "beta")

enviroLaborBigrams_2010_top_terms <- enviroLaborBigrams_2010_topics %>%
  group_by(topic) %>%
  slice_max(beta, n = 10) %>% 
  ungroup() %>%
  arrange(topic, -beta)

graph_enviroLaborBigrams_2010_top_terms <- enviroLaborBigrams_2010_top_terms %>%
  mutate(term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(beta, term, fill = factor(topic))) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free") +
  scale_y_reordered() +
  theme_minimal()

ggsave("figures/enviroLabor_topics_15yr_2010.jpg")

```

ANALYSIS: co-occurrence

```{r enviro bigram co-occurrence with labor keywords per 15-yr period}


#### 1875
enviroBigrams_wordPairs_corr_1875 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1875) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1875_labor <- enviroBigrams_wordPairs_corr_1875 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1875_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1875_labor.jpg") #h=11,


#### 1890
enviroBigrams_wordPairs_corr_1890 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1890) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1890_labor <- enviroBigrams_wordPairs_corr_1890 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1890_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1890_labor.jpg") #h=11,



#### 1905
enviroBigrams_wordPairs_corr_1905 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1905) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1905_labor <- enviroBigrams_wordPairs_corr_1905 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1905_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1905_labor.jpg") #h=11,



#### 1920
enviroBigrams_wordPairs_corr_1920 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1920) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1920_labor <- enviroBigrams_wordPairs_corr_1920 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1920_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1920_labor.jpg") #h=11,



#### 1935
enviroBigrams_wordPairs_corr_1935 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1935) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1935_labor <- enviroBigrams_wordPairs_corr_1935 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1935_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1935_labor.jpg") #h=11,



#### 1950
enviroBigrams_wordPairs_corr_1950 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1950) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1950_labor <- enviroBigrams_wordPairs_corr_1950 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1950_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1950_labor.jpg") #h=11,



#### 1965
enviroBigrams_wordPairs_corr_1965 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1965) %>%
  group_by(term) %>%
  filter(n() >= 25) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1965_labor <- enviroBigrams_wordPairs_corr_1965 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1965_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1965_labor.jpg") #h=11,


#### 1980
enviroBigrams_wordPairs_corr_1980 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1980) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1980_labor <- enviroBigrams_wordPairs_corr_1980 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1980_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1980_labor.jpg") #h=11,



#### 1995
enviroBigrams_wordPairs_corr_1995 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==1995) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_1995_labor <- enviroBigrams_wordPairs_corr_1995 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_1995_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_1995_labor.jpg") #h=11,



#### 2010
enviroBigrams_wordPairs_corr_2010 <- enviroBigrams %>%
  select(speech_id,term,count,year) %>%
  mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period==2010) %>%
  group_by(term) %>%
  filter(n() >= 15) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroBigrams_wordPairs_corr_2010_labor <- enviroBigrams_wordPairs_corr_2010 %>%
  filter(item1 %ilike% laborBigramVocabString_simple) %>%
  slice_max(correlation,n=100) %>%
  arrange(-correlation)

set.seed(2016)
enviroBigrams_wordPairs_corr_2010_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroBigrams_wordPairs_corr_2010_labor.jpg") #h=11,


```

##### top co-occurring tokens with labor keywords pre- vs. post-war period:
```{r enviro token co-occurence with labor pre- vs. post-war period}

#### pre-war
enviroTokens_wordPairs_corr_pre_war<- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = case_when(year >= 1875 & year <= 1945 ~ "1875-1945",
                            year > 1945 ~ "1946-present")) %>%
  # mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period=="1875-1945") %>%
  group_by(term) %>%
  filter(n() >= 30) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_pre_war_labor <- enviroTokens_wordPairs_corr_pre_war %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  group_by(item1) %>%
  slice_max(correlation,n=20) %>% 
  ungroup() %>%
  arrange(item1,-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_pre_war_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_pre_war_labor.jpg") #h=11,



#### post-war
enviroTokens_wordPairs_corr_post_war<- enviroTokens %>%
  select(speech_id,term,count,year) %>%
  mutate(period = case_when(year <= 1945 ~ "1875-1945",
                            year > 1945 ~ "1946-present")) %>%
  # mutate(period = as.numeric(year) - as.numeric(year) %% 15) %>%
  filter(period=="1946-present") %>%
  group_by(term) %>%
  filter(n() >= 30) %>%
  pairwise_cor(term,speech_id,sort=TRUE)

enviroTokens_wordPairs_corr_post_war_labor <- enviroTokens_wordPairs_corr_post_war %>%
  filter(item1 %ilike% laborVocabString_simple) %>%
  group_by(item1) %>%
  slice_max(correlation,n=20) %>% 
  ungroup() %>%
  arrange(item1,-correlation)

set.seed(2016)
enviroTokens_wordPairs_corr_post_war_labor %>%
  graph_from_data_frame() %>%
  ggraph(layout = "fr") +
  geom_edge_link(aes(edge_alpha=correlation), 
                 edge_color="#32127a",
                 show.legend=TRUE) +
  geom_node_point(color="aquamarine4", size=3.5) +
  geom_node_text(aes(label=name), 
                 color="#32127a",
                 family="IBM Plex Mono",
                 size=3,
                 repel = TRUE) +
  theme_void() + 
  theme(legend.text=element_text(family="IBM Plex Mono",color="#32127a"),
        legend.title=element_text(family="IBM Plex Mono",color="#32127a"))

ggsave("figures/enviroTokens_wordPairs_corr_post_war_labor.jpg") #h=11,


```
